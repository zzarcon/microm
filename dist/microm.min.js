!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.Microm=t():e.Microm=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="http://localhost:8090/assets",t(0)}([function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(r(5),r(4)),s=r(1).Promise,o=r(7),l=r(8),c=r(6);c.setup();var f=function(){function e(){n(this,e),this.isRecording=!1,this.recordRTC=null,this.player=null,this.mp3=null,this.eventListeners={},this.converter=new o}return a(e,[{key:"record",value:function(){this.isRecording=!0;var e=navigator.mediaDevices.getUserMedia({audio:!0});return e.then(this.startUserMedia.bind(this))["catch"](this.onUserMediaError.bind(this)),e}},{key:"stopRecording",value:function(){var e=this;return this.isRecording=!1,new s(function(t,r){e.recordRTC.stopRecording(function(){e.getMp3().then(function(r){e.mp3=r,e.player=new l(r.url,e),t(r)})})})}},{key:"play",value:function(){this.player.play()}},{key:"pause",value:function(){this.player.pause()}},{key:"stop",value:function(){var e=this;return this.isRecording?this.stopRecording():new s(function(t,r){e.player.stop(),t(e.mp3)})}},{key:"getMp3",value:function(){var e=this.recordRTC.getBlob();return this.converter.toMp3(e)}},{key:"getWav",value:function(){}},{key:"getUrl",value:function(){return this.mp3.url}},{key:"getBlob",value:function(){return this.mp3.blob}},{key:"getBuffer",value:function(){return this.mp3.buffer}},{key:"getBase64",value:function(){return this.converter.toBase64(this.getBlob())}},{key:"download",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"micro_record":arguments[0],t=document.createElement("a"),r=document.createEvent("Event");t.href=this.getUrl(),t.download=e+".mp3",r.initEvent("click",!0,!0),t.dispatchEvent(r)}},{key:"startUserMedia",value:function(e){var t=i(e,{type:"audio"});return t.startRecording(),this.recordRTC=t,this.isRecording=!0,e}},{key:"onUserMediaError",value:function(){}},{key:"on",value:function(e,t){this.eventListeners[e]=t}},{key:"off",value:function(e){delete this.eventListeners[e]}}]),e}();e.exports=f},function(e,t,r){(function(e,n){/*!
	 * @overview RSVP - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2016 Yehuda Katz, Tom Dale, Stefan Penner and contributors
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/tildeio/rsvp.js/master/LICENSE
	 * @version   3.6.2
	 */
!function(e,r){r(t)}(this,function(t){"use strict";function a(e,t){for(var r=0,n=e.length;n>r;r++)if(e[r]===t)return r;return-1}function i(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t}function s(e,t){return 2!==arguments.length?Te[e]:void(Te[e]=t)}function o(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function l(e){return"function"==typeof e}function c(e){return null!==e&&"object"==typeof e}function f(e){return null!==e&&"object"==typeof e}function u(){setTimeout(function(){for(var e=0;e<ke.length;e++){var t=ke[e],r=t.payload;r.guid=r.key+r.id,r.childGuid=r.key+r.childId,r.error&&(r.stack=r.error.stack),Te.trigger(t.name,t.payload)}ke.length=0},50)}function _(e,t,r){1===ke.push({name:e,payload:{key:t._guidKey,id:t._id,eventName:e,detail:t._result,childId:r&&r._id,label:t._label,timeStamp:Be(),error:Te["instrument-with-stack"]?new Error(t._label):null}})&&u()}function h(e,t){var r=this;if(e&&"object"==typeof e&&e.constructor===r)return e;var n=new r(p,t);return y(n,e),n}function d(){return new TypeError("A promises callback cannot return that same promise.")}function p(){}function m(e){try{return e.then}catch(t){return Le.error=t,Le}}function v(e,t,r,n){try{e.call(t,r,n)}catch(a){return a}}function b(e,t,r){Te.async(function(e){var n=!1,a=v(r,t,function(r){n||(n=!0,t!==r?y(e,r,void 0):S(e,r))},function(t){n||(n=!0,A(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&a&&(n=!0,A(e,a))},e)}function g(e,t){t._state===Pe?S(e,t._result):t._state===Ie?(t._onError=null,A(e,t._result)):T(t,void 0,function(r){t!==r?y(e,r,void 0):S(e,r)},function(t){return A(e,t)})}function w(e,t,r){var n=t.constructor===e.constructor&&r===P&&e.constructor.resolve===h;n?g(e,t):r===Le?(A(e,Le.error),Le.error=null):l(r)?b(e,t,r):S(e,t)}function y(e,t){e===t?S(e,t):o(t)?w(e,t,m(t)):S(e,t)}function R(e){e._onError&&e._onError(e._result),E(e)}function S(e,t){e._state===xe&&(e._result=t,e._state=Pe,0===e._subscribers.length?Te.instrument&&_("fulfilled",e):Te.async(E,e))}function A(e,t){e._state===xe&&(e._state=Ie,e._result=t,Te.async(R,e))}function T(e,t,r,n){var a=e._subscribers,i=a.length;e._onError=null,a[i]=t,a[i+Pe]=r,a[i+Ie]=n,0===i&&e._state&&Te.async(E,e)}function E(e){var t=e._subscribers,r=e._state;if(Te.instrument&&_(r===Pe?"fulfilled":"rejected",e),0!==t.length){for(var n=void 0,a=void 0,i=e._result,s=0;s<t.length;s+=3)n=t[s],a=t[s+r],n?k(r,n,a,i):a(i);e._subscribers.length=0}}function M(){this.error=null}function B(e,t){try{return e(t)}catch(r){return Oe.error=r,Oe}}function k(e,t,r,n){var a=l(r),i=void 0,s=void 0;if(a){if(i=B(r,n),i===Oe)s=i.error,i.error=null;else if(i===t)return void A(t,d())}else i=n;t._state!==xe||(a&&void 0===s?y(t,i):void 0!==s?A(t,s):e===Pe?S(t,i):e===Ie&&A(t,i))}function x(e,t){var r=!1;try{t(function(t){r||(r=!0,y(e,t))},function(t){r||(r=!0,A(e,t))})}catch(n){A(e,n)}}function P(e,t,r){var n=this,a=n._state;if(a===Pe&&!e||a===Ie&&!t)return Te.instrument&&_("chained",n,n),n;n._onError=null;var i=new n.constructor(p,r),s=n._result;if(Te.instrument&&_("chained",n,i),a===xe)T(n,i,e,t);else{var o=a===Pe?e:t;Te.async(function(){return k(a,i,o,s)})}return i}function I(e,t,r){return e===Pe?{state:"fulfilled",value:r}:{state:"rejected",reason:r}}function L(e,t){return Me(e)?new Ce(this,e,!0,t).promise:this.reject(new TypeError("Promise.all must be called with an array"),t)}function O(e,t){var r=this,n=new r(p,t);if(!Me(e))return A(n,new TypeError("Promise.race must be called with an array")),n;for(var a=0;n._state===xe&&a<e.length;a++)T(r.resolve(e[a]),void 0,function(e){return y(n,e)},function(e){return A(n,e)});return n}function C(e,t){var r=this,n=new r(p,t);return A(n,e),n}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function V(){this.value=void 0}function H(e){try{return e.then}catch(t){return He.value=t,He}}function U(e,t,r){try{e.apply(t,r)}catch(n){return He.value=n,He}}function j(e,t){for(var r={},n=e.length,a=new Array(n),i=0;n>i;i++)a[i]=e[i];for(var s=0;s<t.length;s++){var o=t[s];r[o]=a[s+1]}return r}function Y(e){for(var t=e.length,r=new Array(t-1),n=1;t>n;n++)r[n-1]=e[n];return r}function F(e,t){return{then:function(r,n){return e.call(t,r,n)}}}function X(e,t){var r=function(){for(var r=this,n=arguments.length,a=new Array(n+1),i=!1,s=0;n>s;++s){var o=arguments[s];if(!i){if(i=G(o),i===Ue){var l=new Ve(p);return A(l,Ue.value),l}i&&i!==!0&&(o=F(i,o))}a[s]=o}var c=new Ve(p);return a[n]=function(e,r){e?A(c,e):void 0===t?y(c,r):t===!0?y(c,Y(arguments)):Me(t)?y(c,j(arguments,t)):y(c,r)},i?z(c,a,e,r):q(c,a,e,r)};return r.__proto__=e,r}function q(e,t,r,n){var a=U(r,n,t);return a===He&&A(e,a.value),e}function z(e,t,r,n){return Ve.all(t).then(function(t){var a=U(r,n,t);return a===He&&A(e,a.value),e})}function G(e){return e&&"object"==typeof e?e.constructor===Ve?!0:H(e):!1}function K(e,t){return Ve.all(e,t)}function Z(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function W(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Q(e,t){return Me(e)?new je(Ve,e,t).promise:Ve.reject(new TypeError("Promise.allSettled must be called with an array"),t)}function J(e,t){return Ve.race(e,t)}function $(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function ee(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function te(e,t){return c(e)?new Fe(Ve,e,t).promise:Ve.reject(new TypeError("Promise.hash must be called with an object"),t)}function re(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function ne(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function ae(e,t){return c(e)?new Xe(Ve,e,!1,t).promise:Ve.reject(new TypeError("RSVP.hashSettled must be called with an object"),t)}function ie(e){throw setTimeout(function(){throw e}),e}function se(e){var t={resolve:void 0,reject:void 0};return t.promise=new Ve(function(e,r){t.resolve=e,t.reject=r},e),t}function oe(e,t,r){return Me(e)?l(t)?Ve.all(e,r).then(function(e){for(var n=e.length,a=new Array(n),i=0;n>i;i++)a[i]=t(e[i]);return Ve.all(a,r)}):Ve.reject(new TypeError("RSVP.map expects a function as a second argument"),r):Ve.reject(new TypeError("RSVP.map must be called with an array"),r)}function le(e,t){return Ve.resolve(e,t)}function ce(e,t){return Ve.reject(e,t)}function fe(e,t){return Ve.all(e,t)}function ue(e,t){return Ve.resolve(e,t).then(function(e){return fe(e,t)})}function _e(e,t,r){if(!(Me(e)||c(e)&&void 0!==e.then))return Ve.reject(new TypeError("RSVP.filter must be called with an array or promise"),r);if(!l(t))return Ve.reject(new TypeError("RSVP.filter expects function as a second argument"),r);var n=Me(e)?fe(e,r):ue(e,r);return n.then(function(e){for(var n=e.length,a=new Array(n),i=0;n>i;i++)a[i]=t(e[i]);return fe(a,r).then(function(t){for(var r=new Array(n),a=0,i=0;n>i;i++)t[i]&&(r[a]=e[i],a++);return r.length=a,r})})}function he(e,t){Je[qe]=e,Je[qe+1]=t,qe+=2,2===qe&&$e()}function de(){var t=e.nextTick,r=e.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(r)&&"0"===r[1]&&"10"===r[2]&&(t=setImmediate),function(){return t(ge)}}function pe(){return"undefined"!=typeof ze?function(){ze(ge)}:be()}function me(){var e=0,t=new Ze(ge),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){return r.data=e=++e%2}}function ve(){var e=new MessageChannel;return e.port1.onmessage=ge,function(){return e.port2.postMessage(0)}}function be(){return function(){return setTimeout(ge,1)}}function ge(){for(var e=0;qe>e;e+=2){var t=Je[e],r=Je[e+1];t(r),Je[e]=void 0,Je[e+1]=void 0}qe=0}function we(){try{var e=r(15);return ze=e.runOnLoop||e.runOnContext,pe()}catch(t){return be()}}function ye(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Re(){Te.on.apply(Te,arguments)}function Se(){Te.off.apply(Te,arguments)}var Ae={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e._promiseCallbacks=void 0,e},on:function(e,t){if("function"!=typeof t)throw new TypeError("Callback must be a function");var r=i(this),n=void 0;n=r[e],n||(n=r[e]=[]),-1===a(n,t)&&n.push(t)},off:function(e,t){var r=i(this),n=void 0,s=void 0;return t?(n=r[e],s=a(n,t),void(-1!==s&&n.splice(s,1))):void(r[e]=[])},trigger:function(e,t,r){var n=i(this),a=void 0,s=void 0;if(a=n[e])for(var o=0;o<a.length;o++)(s=a[o])(t,r)}},Te={instrument:!1};Ae.mixin(Te);var Ee=void 0;Ee=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var Me=Ee,Be=Date.now||function(){return(new Date).getTime()},ke=[],xe=void 0,Pe=1,Ie=2,Le=new M,Oe=new M,Ce=function(){function e(e,t,r,n){this._instanceConstructor=e,this.promise=new e(p,n),this._abortOnReject=r,this._init.apply(this,arguments)}return e.prototype._init=function(e,t){var r=t.length||0;this.length=r,this._remaining=r,this._result=new Array(r),this._enumerate(t),0===this._remaining&&S(this.promise,this._result)},e.prototype._enumerate=function(e){for(var t=this.length,r=this.promise,n=0;r._state===xe&&t>n;n++)this._eachEntry(e[n],n)},e.prototype._settleMaybeThenable=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===h){var a=m(e);if(a===P&&e._state!==xe)e._onError=null,this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=this._makeResult(Pe,t,e);else if(r===Ve){var i=new r(p);w(i,e,a),this._willSettleAt(i,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},e.prototype._eachEntry=function(e,t){f(e)?this._settleMaybeThenable(e,t):(this._remaining--,this._result[t]=this._makeResult(Pe,t,e))},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===xe&&(this._abortOnReject&&e===Ie?A(n,r):(this._remaining--,this._result[t]=this._makeResult(e,t,r),0===this._remaining&&S(n,this._result)))},e.prototype._makeResult=function(e,t,r){return r},e.prototype._willSettleAt=function(e,t){var r=this;T(e,void 0,function(e){return r._settledAt(Pe,t,e)},function(e){return r._settledAt(Ie,t,e)})},e}(),De="rsvp_"+Be()+"-",Ne=0,Ve=function(){function e(t,r){this._id=Ne++,this._label=r,this._state=void 0,this._result=void 0,this._subscribers=[],Te.instrument&&_("created",this),p!==t&&("function"!=typeof t&&D(),this instanceof e?x(this,t):N())}return e.prototype._onError=function(e){var t=this;Te.after(function(){t._onError&&Te.trigger("error",e,t._label)})},e.prototype["catch"]=function(e,t){return this.then(void 0,e,t)},e.prototype["finally"]=function(e,t){var r=this,n=r.constructor;return r.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})},t)},e}();Ve.cast=h,Ve.all=L,Ve.race=O,Ve.resolve=h,Ve.reject=C,Ve.prototype._guidKey=De,Ve.prototype.then=P;var He=new V,Ue=new V,je=function(e){function t(t,r,n){return Z(this,e.call(this,t,r,!1,n))}return W(t,e),t}(Ce);je.prototype._makeResult=I;var Ye=Object.prototype.hasOwnProperty,Fe=function(e){function t(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0,a=arguments[3];return $(this,e.call(this,t,r,n,a))}return ee(t,e),t.prototype._init=function(e,t){this._result={},this._enumerate(t),0===this._remaining&&S(this.promise,this._result)},t.prototype._enumerate=function(e){var t=this.promise,r=[];for(var n in e)Ye.call(e,n)&&r.push({position:n,entry:e[n]});var a=r.length;this._remaining=a;for(var i=void 0,s=0;t._state===xe&&a>s;s++)i=r[s],this._eachEntry(i.entry,i.position)},t}(Ce),Xe=function(e){function t(t,r,n){return re(this,e.call(this,t,r,!1,n))}return ne(t,e),t}(Fe);Xe.prototype._makeResult=I;var qe=0,ze=void 0,Ge="undefined"!=typeof window?window:void 0,Ke=Ge||{},Ze=Ke.MutationObserver||Ke.WebKitMutationObserver,We="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),Qe="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Je=new Array(1e3),$e=void 0;$e=We?de():Ze?me():Qe?ve():void 0===Ge?we():be();var et=void 0;if("object"==typeof self)et=self;else{if("object"!=typeof n)throw new Error("no global: `self` or `global` found");et=n}var tt;Te.async=he,Te.after=function(e){return setTimeout(e,0)};var rt=le,nt=function(e,t){return Te.async(e,t)};if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var at=window.__PROMISE_INSTRUMENTATION__;s("instrument",!0);for(var it in at)at.hasOwnProperty(it)&&Re(it,at[it])}var st=(tt={asap:he,cast:rt,Promise:Ve,EventTarget:Ae,all:K,allSettled:Q,race:J,hash:te,hashSettled:ae,rethrow:ie,defer:se,denodeify:X,configure:s,on:Re,off:Se,resolve:le,reject:ce,map:oe},ye(tt,"async",nt),ye(tt,"filter",_e),tt);t["default"]=st,t.asap=he,t.cast=rt,t.Promise=Ve,t.EventTarget=Ae,t.all=K,t.allSettled=Q,t.race=J,t.hash=te,t.hashSettled=ae,t.rethrow=ie,t.defer=se,t.denodeify=X,t.configure=s,t.on=Re,t.off=Se,t.resolve=le,t.reject=ce,t.map=oe,t.async=nt,t.filter=_e,Object.defineProperty(t,"__esModule",{value:!0})})}).call(t,r(14),function(){return this}())},function(e,t,r){(function(e,n){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function a(){function e(){}try{var t=new Uint8Array(1);return t.foo=function(){return 42},t.constructor=e,42===t.foo()&&t.constructor===e&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(r){return!1}}function i(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function e(t){return this instanceof e?(e.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof t?s(this,t):"string"==typeof t?o(this,t,arguments.length>1?arguments[1]:"utf8"):l(this,t)):arguments.length>1?new e(t,arguments[1]):new e(t)}function s(t,r){if(t=p(t,0>r?0:0|m(r)),!e.TYPED_ARRAY_SUPPORT)for(var n=0;r>n;n++)t[n]=0;return t}function o(e,t,r){("string"!=typeof r||""===r)&&(r="utf8");var n=0|b(t,r);return e=p(e,n),e.write(t,r),e}function l(t,r){if(e.isBuffer(r))return c(t,r);if(W(r))return f(t,r);if(null==r)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(r.buffer instanceof ArrayBuffer)return u(t,r);if(r instanceof ArrayBuffer)return _(t,r)}return r.length?h(t,r):d(t,r)}function c(e,t){var r=0|m(t.length);return e=p(e,r),t.copy(e,0,0,r),e}function f(e,t){var r=0|m(t.length);e=p(e,r);for(var n=0;r>n;n+=1)e[n]=255&t[n];return e}function u(e,t){var r=0|m(t.length);e=p(e,r);for(var n=0;r>n;n+=1)e[n]=255&t[n];return e}function _(t,r){return e.TYPED_ARRAY_SUPPORT?(r.byteLength,t=e._augment(new Uint8Array(r))):t=u(t,new Uint8Array(r)),t}function h(e,t){var r=0|m(t.length);e=p(e,r);for(var n=0;r>n;n+=1)e[n]=255&t[n];return e}function d(e,t){var r,n=0;"Buffer"===t.type&&W(t.data)&&(r=t.data,n=0|m(r.length)),e=p(e,n);for(var a=0;n>a;a+=1)e[a]=255&r[a];return e}function p(t,r){e.TYPED_ARRAY_SUPPORT?(t=e._augment(new Uint8Array(r)),t.__proto__=e.prototype):(t.length=r,t._isBuffer=!0);var n=0!==r&&r<=e.poolSize>>>1;return n&&(t.parent=Q),t}function m(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function v(t,r){if(!(this instanceof v))return new v(t,r);var n=new e(t,r);return delete n.parent,n}function b(e,t){"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"binary":case"raw":case"raws":return r;case"utf8":case"utf-8":return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(e).length;default:if(n)return F(e).length;t=(""+t).toLowerCase(),n=!0}}function g(e,t,r){var n=!1;if(t=0|t,r=void 0===r||r===1/0?this.length:0|r,e||(e="utf8"),0>t&&(t=0),r>this.length&&(r=this.length),t>=r)return"";for(;;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return M(this,t,r);case"ascii":return k(this,t,r);case"binary":return x(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function w(e,t,r,n){r=Number(r)||0;var a=e.length-r;n?(n=Number(n),n>a&&(n=a)):n=a;var i=t.length;if(i%2!==0)throw new Error("Invalid hex string");n>i/2&&(n=i/2);for(var s=0;n>s;s++){var o=parseInt(t.substr(2*s,2),16);if(isNaN(o))throw new Error("Invalid hex string");e[r+s]=o}return s}function y(e,t,r,n){return G(F(t,e.length-r),e,r,n)}function R(e,t,r,n){return G(X(t),e,r,n)}function S(e,t,r,n){return R(e,t,r,n)}function A(e,t,r,n){return G(z(t),e,r,n)}function T(e,t,r,n){return G(q(t,e.length-r),e,r,n)}function E(e,t,r){return 0===t&&r===e.length?K.fromByteArray(e):K.fromByteArray(e.slice(t,r))}function M(e,t,r){r=Math.min(e.length,r);for(var n=[],a=t;r>a;){var i=e[a],s=null,o=i>239?4:i>223?3:i>191?2:1;if(r>=a+o){var l,c,f,u;switch(o){case 1:128>i&&(s=i);break;case 2:l=e[a+1],128===(192&l)&&(u=(31&i)<<6|63&l,u>127&&(s=u));break;case 3:l=e[a+1],c=e[a+2],128===(192&l)&&128===(192&c)&&(u=(15&i)<<12|(63&l)<<6|63&c,u>2047&&(55296>u||u>57343)&&(s=u));break;case 4:l=e[a+1],c=e[a+2],f=e[a+3],128===(192&l)&&128===(192&c)&&128===(192&f)&&(u=(15&i)<<18|(63&l)<<12|(63&c)<<6|63&f,u>65535&&1114112>u&&(s=u))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),a+=o}return B(n)}function B(e){var t=e.length;if(J>=t)return String.fromCharCode.apply(String,e);for(var r="",n=0;t>n;)r+=String.fromCharCode.apply(String,e.slice(n,n+=J));return r}function k(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;r>a;a++)n+=String.fromCharCode(127&e[a]);return n}function x(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;r>a;a++)n+=String.fromCharCode(e[a]);return n}function P(e,t,r){var n=e.length;(!t||0>t)&&(t=0),(!r||0>r||r>n)&&(r=n);for(var a="",i=t;r>i;i++)a+=Y(e[i]);return a}function I(e,t,r){for(var n=e.slice(t,r),a="",i=0;i<n.length;i+=2)a+=String.fromCharCode(n[i]+256*n[i+1]);return a}function L(e,t,r){if(e%1!==0||0>e)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(t,r,n,a,i,s){if(!e.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(r>i||s>r)throw new RangeError("value is out of bounds");if(n+a>t.length)throw new RangeError("index out of range")}function C(e,t,r,n){0>t&&(t=65535+t+1);for(var a=0,i=Math.min(e.length-r,2);i>a;a++)e[r+a]=(t&255<<8*(n?a:1-a))>>>8*(n?a:1-a)}function D(e,t,r,n){0>t&&(t=4294967295+t+1);for(var a=0,i=Math.min(e.length-r,4);i>a;a++)e[r+a]=t>>>8*(n?a:3-a)&255}function N(e,t,r,n,a,i){if(t>a||i>t)throw new RangeError("value is out of bounds");if(r+n>e.length)throw new RangeError("index out of range");if(0>r)throw new RangeError("index out of range")}function V(e,t,r,n,a){return a||N(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(e,t,r,n,23,4),r+4}function H(e,t,r,n,a){return a||N(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(e,t,r,n,52,8),r+8}function U(e){if(e=j(e).replace(ee,""),e.length<2)return"";for(;e.length%4!==0;)e+="=";return e}function j(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Y(e){return 16>e?"0"+e.toString(16):e.toString(16)}function F(e,t){t=t||1/0;for(var r,n=e.length,a=null,i=[],s=0;n>s;s++){if(r=e.charCodeAt(s),r>55295&&57344>r){if(!a){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}a=r;continue}if(56320>r){(t-=3)>-1&&i.push(239,191,189),a=r;continue}r=(a-55296<<10|r-56320)+65536}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,128>r){if((t-=1)<0)break;i.push(r)}else if(2048>r){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(65536>r){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(1114112>r))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function X(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t}function q(e,t){for(var r,n,a,i=[],s=0;s<e.length&&!((t-=2)<0);s++)r=e.charCodeAt(s),n=r>>8,a=r%256,i.push(a),i.push(n);return i}function z(e){return K.toByteArray(U(e))}function G(e,t,r,n){for(var a=0;n>a&&!(a+r>=t.length||a>=e.length);a++)t[a+r]=e[a];return a}var K=r(10),Z=r(13),W=r(11);t.Buffer=e,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50,e.poolSize=8192;var Q={};e.TYPED_ARRAY_SUPPORT=void 0!==n.TYPED_ARRAY_SUPPORT?n.TYPED_ARRAY_SUPPORT:a(),e.TYPED_ARRAY_SUPPORT?(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array):(e.prototype.length=void 0,e.prototype.parent=void 0),e.isBuffer=function(e){return!(null==e||!e._isBuffer)},e.compare=function(t,r){if(!e.isBuffer(t)||!e.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var n=t.length,a=r.length,i=0,s=Math.min(n,a);s>i&&t[i]===r[i];)++i;return i!==s&&(n=t[i],a=r[i]),a>n?-1:n>a?1:0},e.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(t,r){if(!W(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new e(0);var n;if(void 0===r)for(r=0,n=0;n<t.length;n++)r+=t[n].length;var a=new e(r),i=0;for(n=0;n<t.length;n++){var s=t[n];s.copy(a,i),i+=s.length}return a},e.byteLength=b,e.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):g.apply(this,arguments)},e.prototype.equals=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===e.compare(this,t)},e.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},e.prototype.compare=function(t){if(!e.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:e.compare(this,t)},e.prototype.indexOf=function(t,r){function n(e,t,r){for(var n=-1,a=0;r+a<e.length;a++)if(e[r+a]===t[-1===n?0:a-n]){if(-1===n&&(n=a),a-n+1===t.length)return r+n}else n=-1;return-1}if(r>2147483647?r=2147483647:-2147483648>r&&(r=-2147483648),r>>=0,0===this.length)return-1;if(r>=this.length)return-1;if(0>r&&(r=Math.max(this.length+r,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,r);if(e.isBuffer(t))return n(this,t,r);if("number"==typeof t)return e.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,r):n(this,[t],r);throw new TypeError("val must be string, number or Buffer")},e.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},e.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},e.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t=0|t,isFinite(r)?(r=0|r,void 0===n&&(n="utf8")):(n=r,r=void 0);else{var a=n;n=t,t=0|r,r=a}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(0>r||0>t)||t>this.length)throw new RangeError("attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return y(this,e,t,r);case"ascii":return R(this,e,t,r);case"binary":return S(this,e,t,r);case"base64":return A(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var J=4096;e.prototype.slice=function(t,r){var n=this.length;t=~~t,r=void 0===r?n:~~r,0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),0>r?(r+=n,0>r&&(r=0)):r>n&&(r=n),t>r&&(r=t);var a;if(e.TYPED_ARRAY_SUPPORT)a=e._augment(this.subarray(t,r));else{var i=r-t;a=new e(i,void 0);for(var s=0;i>s;s++)a[s]=this[s+t]}return a.length&&(a.parent=this.parent||this),a},e.prototype.readUIntLE=function(e,t,r){e=0|e,t=0|t,r||L(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n},e.prototype.readUIntBE=function(e,t,r){e=0|e,t=0|t,r||L(e,t,this.length);for(var n=this[e+--t],a=1;t>0&&(a*=256);)n+=this[e+--t]*a;return n},e.prototype.readUInt8=function(e,t){return t||L(e,1,this.length),this[e]},e.prototype.readUInt16LE=function(e,t){return t||L(e,2,this.length),this[e]|this[e+1]<<8},e.prototype.readUInt16BE=function(e,t){return t||L(e,2,this.length),this[e]<<8|this[e+1]},e.prototype.readUInt32LE=function(e,t){return t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},e.prototype.readUInt32BE=function(e,t){return t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},e.prototype.readIntLE=function(e,t,r){e=0|e,t=0|t,r||L(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return a*=128,n>=a&&(n-=Math.pow(2,8*t)),n},e.prototype.readIntBE=function(e,t,r){e=0|e,t=0|t,r||L(e,t,this.length);for(var n=t,a=1,i=this[e+--n];n>0&&(a*=256);)i+=this[e+--n]*a;return a*=128,i>=a&&(i-=Math.pow(2,8*t)),i},e.prototype.readInt8=function(e,t){return t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},e.prototype.readInt16LE=function(e,t){t||L(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt16BE=function(e,t){t||L(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},e.prototype.readInt32LE=function(e,t){return t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},e.prototype.readInt32BE=function(e,t){return t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},e.prototype.readFloatLE=function(e,t){return t||L(e,4,this.length),Z.read(this,e,!0,23,4)},e.prototype.readFloatBE=function(e,t){return t||L(e,4,this.length),Z.read(this,e,!1,23,4)},e.prototype.readDoubleLE=function(e,t){return t||L(e,8,this.length),Z.read(this,e,!0,52,8)},e.prototype.readDoubleBE=function(e,t){return t||L(e,8,this.length),Z.read(this,e,!1,52,8)},e.prototype.writeUIntLE=function(e,t,r,n){e=+e,t=0|t,r=0|r,n||O(this,e,t,r,Math.pow(2,8*r),0);var a=1,i=0;for(this[t]=255&e;++i<r&&(a*=256);)this[t+i]=e/a&255;return t+r},e.prototype.writeUIntBE=function(e,t,r,n){e=+e,t=0|t,r=0|r,n||O(this,e,t,r,Math.pow(2,8*r),0);var a=r-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+r},e.prototype.writeUInt8=function(t,r,n){return t=+t,r=0|r,n||O(this,t,r,1,255,0),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},e.prototype.writeUInt16LE=function(t,r,n){return t=+t,r=0|r,n||O(this,t,r,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):C(this,t,r,!0),r+2},e.prototype.writeUInt16BE=function(t,r,n){return t=+t,r=0|r,n||O(this,t,r,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):C(this,t,r,!1),r+2},e.prototype.writeUInt32LE=function(t,r,n){return t=+t,r=0|r,n||O(this,t,r,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):D(this,t,r,!0),r+4},e.prototype.writeUInt32BE=function(t,r,n){return t=+t,r=0|r,n||O(this,t,r,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):D(this,t,r,!1),r+4},e.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t=0|t,!n){var a=Math.pow(2,8*r-1);O(this,e,t,r,a-1,-a)}var i=0,s=1,o=0>e?1:0;for(this[t]=255&e;++i<r&&(s*=256);)this[t+i]=(e/s>>0)-o&255;return t+r},e.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t=0|t,!n){var a=Math.pow(2,8*r-1);O(this,e,t,r,a-1,-a)}var i=r-1,s=1,o=0>e?1:0;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=(e/s>>0)-o&255;return t+r},e.prototype.writeInt8=function(t,r,n){return t=+t,r=0|r,n||O(this,t,r,1,127,-128),e.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[r]=255&t,r+1},e.prototype.writeInt16LE=function(t,r,n){return t=+t,r=0|r,n||O(this,t,r,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):C(this,t,r,!0),r+2},e.prototype.writeInt16BE=function(t,r,n){return t=+t,r=0|r,n||O(this,t,r,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):C(this,t,r,!1),r+2},e.prototype.writeInt32LE=function(t,r,n){return t=+t,r=0|r,n||O(this,t,r,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):D(this,t,r,!0),r+4},e.prototype.writeInt32BE=function(t,r,n){return t=+t,r=0|r,n||O(this,t,r,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),e.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):D(this,t,r,!1),r+4},e.prototype.writeFloatLE=function(e,t,r){return V(this,e,t,!0,r)},e.prototype.writeFloatBE=function(e,t,r){return V(this,e,t,!1,r)},e.prototype.writeDoubleLE=function(e,t,r){return H(this,e,t,!0,r)},e.prototype.writeDoubleBE=function(e,t,r){return H(this,e,t,!1,r)},e.prototype.copy=function(t,r,n,a){if(n||(n=0),a||0===a||(a=this.length),r>=t.length&&(r=t.length),r||(r=0),a>0&&n>a&&(a=n),a===n)return 0;if(0===t.length||0===this.length)return 0;if(0>r)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>a)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),t.length-r<a-n&&(a=t.length-r+n);var i,s=a-n;if(this===t&&r>n&&a>r)for(i=s-1;i>=0;i--)t[i+r]=this[i+n];else if(1e3>s||!e.TYPED_ARRAY_SUPPORT)for(i=0;s>i;i++)t[i+r]=this[i+n];else t._set(this.subarray(n,n+s),r);return s},e.prototype.fill=function(e,t,r){if(e||(e=0),t||(t=0),r||(r=this.length),t>r)throw new RangeError("end < start");if(r!==t&&0!==this.length){if(0>t||t>=this.length)throw new RangeError("start out of bounds");if(0>r||r>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof e)for(n=t;r>n;n++)this[n]=e;else{var a=F(e.toString()),i=a.length;for(n=t;r>n;n++)this[n]=a[n%i]}return this}},e.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(e.TYPED_ARRAY_SUPPORT)return new e(this).buffer;for(var t=new Uint8Array(this.length),r=0,n=t.length;n>r;r+=1)t[r]=this[r];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var $=e.prototype;e._augment=function(t){return t.constructor=e,t._isBuffer=!0,t._set=t.set,t.get=$.get,t.set=$.set,t.write=$.write,t.toString=$.toString,t.toLocaleString=$.toString,t.toJSON=$.toJSON,t.equals=$.equals,t.compare=$.compare,t.indexOf=$.indexOf,t.copy=$.copy,t.slice=$.slice,t.readUIntLE=$.readUIntLE,t.readUIntBE=$.readUIntBE,t.readUInt8=$.readUInt8,t.readUInt16LE=$.readUInt16LE,t.readUInt16BE=$.readUInt16BE,t.readUInt32LE=$.readUInt32LE,t.readUInt32BE=$.readUInt32BE,t.readIntLE=$.readIntLE,t.readIntBE=$.readIntBE,t.readInt8=$.readInt8,t.readInt16LE=$.readInt16LE,t.readInt16BE=$.readInt16BE,t.readInt32LE=$.readInt32LE,t.readInt32BE=$.readInt32BE,t.readFloatLE=$.readFloatLE,t.readFloatBE=$.readFloatBE,t.readDoubleLE=$.readDoubleLE,t.readDoubleBE=$.readDoubleBE,t.writeUInt8=$.writeUInt8,t.writeUIntLE=$.writeUIntLE,t.writeUIntBE=$.writeUIntBE,t.writeUInt16LE=$.writeUInt16LE,t.writeUInt16BE=$.writeUInt16BE,t.writeUInt32LE=$.writeUInt32LE,t.writeUInt32BE=$.writeUInt32BE,t.writeIntLE=$.writeIntLE,t.writeIntBE=$.writeIntBE,t.writeInt8=$.writeInt8,t.writeInt16LE=$.writeInt16LE,t.writeInt16BE=$.writeInt16BE,t.writeInt32LE=$.writeInt32LE,t.writeInt32BE=$.writeInt32BE,t.writeFloatLE=$.writeFloatLE,t.writeFloatBE=$.writeFloatBE,t.writeDoubleLE=$.writeDoubleLE,t.writeDoubleBE=$.writeDoubleBE,t.fill=$.fill,t.inspect=$.inspect,t.toArrayBuffer=$.toArrayBuffer,t};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,r(2).Buffer,function(){return this}())},function(e,t,r){(function(t){function r(){function e(e){return new Int8Array(e)}function t(e){return new Int16Array(e)}function r(e){return new Int32Array(e)}function n(e){return new Float32Array(e)}function a(e){return new Float64Array(e)}function i(e){if(1==e.length)return n(e[0]);var t=e[0];e=e.slice(1);for(var r=[],a=0;t>a;a++)r.push(i(e));return r}function s(e){if(1==e.length)return r(e[0]);var t=e[0];e=e.slice(1);for(var n=[],a=0;t>a;a++)n.push(s(e));return n}function o(e){if(1==e.length)return t(e[0]);var r=e[0];e=e.slice(1);for(var n=[],a=0;r>a;a++)n.push(o(e));return n}function l(e){if(1==e.length)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var r=[],n=0;t>n;n++)r.push(l(e));return r}function c(e){this.ordinal=e}function f(e){this.ordinal=e}function u(e){var t=e;this.ordinal=function(){return t}}function _(){var e="http://www.mp3dev.org/",t=3,r=98,n=4,a=0,i=93;this.getLameVersion=function(){return t+"."+r+"."+n},this.getLameShortVersion=function(){return t+"."+r+"."+n},this.getLameVeryShortVersion=function(){return"LAME"+t+"."+r+"r"},this.getPsyVersion=function(){return a+"."+i},this.getLameUrl=function(){return e},this.getLameOsBitness=function(){return"32bits"}}function h(){function e(e,t,r,n,a,i,s,o,l,c,f,u,_,h,d){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=r,this.expY=n,this.st_lrm=a,this.st_s=i,this.masking_adj=s,this.masking_adj_short=o,this.ath_lower=l,this.ath_curve=c,this.ath_sensitivity=f,this.interch=u,this.safejoint=_,this.sfb21mod=h,this.msfix=d}function t(e,t,r,n,a,i,s,o,l,c,f,u,_,h){this.quant_comp=t,this.quant_comp_s=r,this.safejoint=n,this.nsmsfix=a,this.st_lrm=i,this.st_s=s,this.nsbass=o,this.scale=l,this.masking_adj=c,this.ath_lower=f,this.ath_curve=u,this.interch=_,this.sfscale=h}function r(e,t,r){var n=e.VBR==f.vbr_rh?s:o,i=e.VBR_q_frac,l=n[t],c=n[t+1],u=l;l.st_lrm=l.st_lrm+i*(c.st_lrm-l.st_lrm),l.st_s=l.st_s+i*(c.st_s-l.st_s),l.masking_adj=l.masking_adj+i*(c.masking_adj-l.masking_adj),l.masking_adj_short=l.masking_adj_short+i*(c.masking_adj_short-l.masking_adj_short),l.ath_lower=l.ath_lower+i*(c.ath_lower-l.ath_lower),l.ath_curve=l.ath_curve+i*(c.ath_curve-l.ath_curve),l.ath_sensitivity=l.ath_sensitivity+i*(c.ath_sensitivity-l.ath_sensitivity),l.interch=l.interch+i*(c.interch-l.interch),l.msfix=l.msfix+i*(c.msfix-l.msfix),a(e,u.vbr_q),0!=r?e.quant_comp=u.quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=u.quant_comp),0!=r?e.quant_comp_short=u.quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=u.quant_comp_s),0!=u.expY&&(e.experimentalY=0!=u.expY),0!=r?e.internal_flags.nsPsy.attackthre=u.st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=u.st_lrm),0!=r?e.internal_flags.nsPsy.attackthre_s=u.st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=u.st_s),0!=r?e.maskingadjust=u.masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=u.masking_adj),0!=r?e.maskingadjust_short=u.masking_adj_short:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=u.masking_adj_short),0!=r?e.ATHlower=-u.ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-u.ath_lower/10),0!=r?e.ATHcurve=u.ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=u.ath_curve),0!=r?e.athaa_sensitivity=u.ath_sensitivity:Math.abs(e.athaa_sensitivity- -1)>0||(e.athaa_sensitivity=u.ath_sensitivity),u.interch>0&&(0!=r?e.interChRatio=u.interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=u.interch)),u.safejoint>0&&(e.exp_nspsytune=e.exp_nspsytune|u.safejoint),u.sfb21mod>0&&(e.exp_nspsytune=e.exp_nspsytune|u.sfb21mod<<20),0!=r?e.msfix=u.msfix:Math.abs(e.msfix- -1)>0||(e.msfix=u.msfix),0==r&&(e.VBR_q=t,e.VBR_q_frac=i)}function n(e,t,r){var n=t,a=i.nearestBitrateFullIndex(t);if(e.VBR=f.vbr_abr,e.VBR_mean_bitrate_kbps=n,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,e.VBR_mean_bitrate_kbps>320&&(e.disable_reservoir=!0),l[a].safejoint>0&&(e.exp_nspsytune=2|e.exp_nspsytune),l[a].sfscale>0&&(e.internal_flags.noise_shaping=2),Math.abs(l[a].nsbass)>0){var s=int(4*l[a].nsbass);0>s&&(s+=64),e.exp_nspsytune=e.exp_nspsytune|s<<2}return 0!=r?e.quant_comp=l[a].quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=l[a].quant_comp),0!=r?e.quant_comp_short=l[a].quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=l[a].quant_comp_s),0!=r?e.msfix=l[a].nsmsfix:Math.abs(e.msfix- -1)>0||(e.msfix=l[a].nsmsfix),0!=r?e.internal_flags.nsPsy.attackthre=l[a].st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=l[a].st_lrm),0!=r?e.internal_flags.nsPsy.attackthre_s=l[a].st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=l[a].st_s),0!=r?e.scale=l[a].scale:Math.abs(e.scale- -1)>0||(e.scale=l[a].scale),0!=r?e.maskingadjust=l[a].masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=l[a].masking_adj),l[a].masking_adj>0?0!=r?e.maskingadjust_short=.9*l[a].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=.9*l[a].masking_adj):0!=r?e.maskingadjust_short=1.1*l[a].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=1.1*l[a].masking_adj),0!=r?e.ATHlower=-l[a].ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-l[a].ath_lower/10),0!=r?e.ATHcurve=l[a].ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=l[a].ath_curve),0!=r?e.interChRatio=l[a].interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=l[a].interch),t}function a(e,t){var r=0;return 0>t&&(r=-1,t=0),t>9&&(r=-1,t=9),e.VBR_q=t,e.VBR_q_frac=0,r}var i;this.setModules=function(e){i=e};var s=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],o=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)],l=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];this.apply_preset=function(e,t,a){switch(t){case Y.R3MIX:t=Y.V3,e.VBR=f.vbr_mtrh;break;case Y.MEDIUM:t=Y.V4,e.VBR=f.vbr_rh;break;case Y.MEDIUM_FAST:t=Y.V4,e.VBR=f.vbr_mtrh;break;case Y.STANDARD:t=Y.V2,e.VBR=f.vbr_rh;break;case Y.STANDARD_FAST:t=Y.V2,e.VBR=f.vbr_mtrh;break;case Y.EXTREME:t=Y.V0,e.VBR=f.vbr_rh;break;case Y.EXTREME_FAST:t=Y.V0,e.VBR=f.vbr_mtrh;break;case Y.INSANE:return t=320,e.preset=t,n(e,t,a),e.VBR=f.vbr_off,t}switch(e.preset=t,t){case Y.V9:return r(e,9,a),t;case Y.V8:return r(e,8,a),t;case Y.V7:return r(e,7,a),t;case Y.V6:return r(e,6,a),t;case Y.V5:return r(e,5,a),t;case Y.V4:return r(e,4,a),t;case Y.V3:return r(e,3,a),t;case Y.V2:return r(e,2,a),t;case Y.V1:return r(e,1,a),t;case Y.V0:return r(e,0,a),t}return t>=8&&320>=t?n(e,t,a):(e.preset=0,t)}}function d(){function e(e,t,r,n,a,i){for(;0!=a--;)r[n]=1e-10+e[t+0]*i[0]-r[n-1]*i[1]+e[t-1]*i[2]-r[n-2]*i[3]+e[t-2]*i[4]-r[n-3]*i[5]+e[t-3]*i[6]-r[n-4]*i[7]+e[t-4]*i[8]-r[n-5]*i[9]+e[t-5]*i[10]-r[n-6]*i[11]+e[t-6]*i[12]-r[n-7]*i[13]+e[t-7]*i[14]-r[n-8]*i[15]+e[t-8]*i[16]-r[n-9]*i[17]+e[t-9]*i[18]-r[n-10]*i[19]+e[t-10]*i[20],++n,++t}function t(e,t,r,n,a,i){for(;0!=a--;)r[n]=e[t+0]*i[0]-r[n-1]*i[1]+e[t-1]*i[2]-r[n-2]*i[3]+e[t-2]*i[4],++n,++t}function r(e,t){for(var r=0;r<MAX_ORDER;r++)e.linprebuf[r]=e.lstepbuf[r]=e.loutbuf[r]=e.rinprebuf[r]=e.rstepbuf[r]=e.routbuf[r]=0;switch(0|t){case 48e3:e.reqindex=0;break;case 44100:e.reqindex=1;break;case 32e3:e.reqindex=2;break;case 24e3:e.reqindex=3;break;case 22050:e.reqindex=4;break;case 16e3:e.reqindex=5;break;case 12e3:e.reqindex=6;break;case 11025:e.reqindex=7;break;case 8e3:e.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return e.sampleWindow=0|(t*o+l-1)/l,e.lsum=0,e.rsum=0,e.totsamp=0,W.ill(e.A,0),INIT_GAIN_ANALYSIS_OK}function n(e){return e*e}function a(e,t){var r,n=0;for(r=0;t>r;r++)n+=e[r];if(0==n)return GAIN_NOT_ENOUGH_SAMPLES;var a=0|Math.ceil(n*(1-s));for(r=t;r-->0&&!((a-=e[r])<=0););return i-r/d.STEPS_per_dB}var i=64.82,s=(d.YULE_ORDER,.95),o=(d.MAX_SAMP_FREQ,d.RMS_WINDOW_TIME_NUMERATOR),l=d.RMS_WINDOW_TIME_DENOMINATOR,c=(d.MAX_SAMPLES_PER_WINDOW,[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]]),f=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];
this.InitGainAnalysis=function(e,t){return r(e,t)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(e.linpre=MAX_ORDER,e.rinpre=MAX_ORDER,e.lstep=MAX_ORDER,e.rstep=MAX_ORDER,e.lout=MAX_ORDER,e.rout=MAX_ORDER,W.fill(e.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(r,a,i,s,o,l,u){var _,h,p,m,v,b,g;if(0==l)return GAIN_ANALYSIS_OK;switch(g=0,v=l,u){case 1:s=a,o=i;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(l<MAX_ORDER?(Q.arraycopy(a,i,r.linprebuf,MAX_ORDER,l),Q.arraycopy(s,o,r.rinprebuf,MAX_ORDER,l)):(Q.arraycopy(a,i,r.linprebuf,MAX_ORDER,MAX_ORDER),Q.arraycopy(s,o,r.rinprebuf,MAX_ORDER,MAX_ORDER));v>0;){b=v>r.sampleWindow-r.totsamp?r.sampleWindow-r.totsamp:v,g<MAX_ORDER?(_=r.linpre+g,h=r.linprebuf,p=r.rinpre+g,m=r.rinprebuf,b>MAX_ORDER-g&&(b=MAX_ORDER-g)):(_=i+g,h=a,p=o+g,m=s),e(h,_,r.lstepbuf,r.lstep+r.totsamp,b,c[r.reqindex]),e(m,p,r.rstepbuf,r.rstep+r.totsamp,b,c[r.reqindex]),t(r.lstepbuf,r.lstep+r.totsamp,r.loutbuf,r.lout+r.totsamp,b,f[r.reqindex]),t(r.rstepbuf,r.rstep+r.totsamp,r.routbuf,r.rout+r.totsamp,b,f[r.reqindex]),_=r.lout+r.totsamp,h=r.loutbuf,p=r.rout+r.totsamp,m=r.routbuf;for(var w=b%8;0!=w--;)r.lsum+=n(h[_++]),r.rsum+=n(m[p++]);for(w=b/8;0!=w--;)r.lsum+=n(h[_+0])+n(h[_+1])+n(h[_+2])+n(h[_+3])+n(h[_+4])+n(h[_+5])+n(h[_+6])+n(h[_+7]),_+=8,r.rsum+=n(m[p+0])+n(m[p+1])+n(m[p+2])+n(m[p+3])+n(m[p+4])+n(m[p+5])+n(m[p+6])+n(m[p+7]),p+=8;if(v-=b,g+=b,r.totsamp+=b,r.totsamp==r.sampleWindow){var y=10*d.STEPS_per_dB*Math.log10((r.lsum+r.rsum)/r.totsamp*.5+1e-37),R=0>=y?0:0|y;R>=r.A.length&&(R=r.A.length-1),r.A[R]++,r.lsum=r.rsum=0,Q.arraycopy(r.loutbuf,r.totsamp,r.loutbuf,0,MAX_ORDER),Q.arraycopy(r.routbuf,r.totsamp,r.routbuf,0,MAX_ORDER),Q.arraycopy(r.lstepbuf,r.totsamp,r.lstepbuf,0,MAX_ORDER),Q.arraycopy(r.rstepbuf,r.totsamp,r.rstepbuf,0,MAX_ORDER),r.totsamp=0}if(r.totsamp>r.sampleWindow)return GAIN_ANALYSIS_ERROR}return l<MAX_ORDER?(Q.arraycopy(r.linprebuf,l,r.linprebuf,0,MAX_ORDER-l),Q.arraycopy(r.rinprebuf,l,r.rinprebuf,0,MAX_ORDER-l),Q.arraycopy(a,i,r.linprebuf,MAX_ORDER-l,l),Q.arraycopy(s,o,r.rinprebuf,MAX_ORDER-l,l)):(Q.arraycopy(a,i+l-MAX_ORDER,r.linprebuf,0,MAX_ORDER),Q.arraycopy(s,o+l-MAX_ORDER,r.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(e){for(var t=a(e.A,e.A.length),r=0;r<e.A.length;r++)e.B[r]+=e.A[r],e.A[r]=0;for(var r=0;r<MAX_ORDER;r++)e.linprebuf[r]=e.lstepbuf[r]=e.loutbuf[r]=e.rinprebuf[r]=e.rstepbuf[r]=e.routbuf[r]=0;return e.totsamp=0,e.lsum=e.rsum=0,t}}function p(){function e(e){this.bits=0|e}function t(e,t,r,n,a,i){var s=.5946/t;for(e>>=1;0!=e--;)a[i++]=s>r[n++]?0:1,a[i++]=s>r[n++]?0:1}function n(e,t,r,n,a,i){e>>=1;var s=e%2;for(e>>=1;0!=e--;){var o,l,c,f,u,_,h,p;o=r[n++]*t,l=r[n++]*t,u=0|o,c=r[n++]*t,_=0|l,f=r[n++]*t,h=0|c,o+=d.adj43[u],p=0|f,l+=d.adj43[_],a[i++]=0|o,c+=d.adj43[h],a[i++]=0|l,f+=d.adj43[p],a[i++]=0|c,a[i++]=0|f}if(0!=s){var o,l,u,_;o=r[n++]*t,l=r[n++]*t,u=0|o,_=0|l,o+=d.adj43[u],l+=d.adj43[_],a[i++]=0|o,a[i++]=0|l}}function a(e,r,a,i,s){var o,l,c,f=0,u=0,_=0,h=0,p=r,m=0,v=p,b=0,g=e,w=0;for(c=null!=s&&i.global_gain==s.global_gain,l=i.block_type==O.SHORT_TYPE?38:21,o=0;l>=o;o++){var y=-1;if((c||i.block_type==O.NORM_TYPE)&&(y=i.global_gain-(i.scalefac[o]+(0!=i.preflag?d.pretab[o]:0)<<i.scalefac_scale+1)-8*i.subblock_gain[i.window[o]]),c&&s.step[o]==y)0!=u&&(n(u,a,g,w,v,b),u=0),0!=_&&(t(_,a,g,w,v,b),_=0);else{var R=i.width[o];if(f+i.width[o]>i.max_nonzero_coeff){var S;S=i.max_nonzero_coeff-f+1,W.fill(r,i.max_nonzero_coeff,576,0),R=S,0>R&&(R=0),o=l+1}if(0==u&&0==_&&(v=p,b=m,g=e,w=h),null!=s&&s.sfb_count1>0&&o>=s.sfb_count1&&s.step[o]>0&&y>=s.step[o]?(0!=u&&(n(u,a,g,w,v,b),u=0,v=p,b=m,g=e,w=h),_+=R):(0!=_&&(t(_,a,g,w,v,b),_=0,v=p,b=m,g=e,w=h),u+=R),0>=R){0!=_&&(t(_,a,g,w,v,b),_=0),0!=u&&(n(u,a,g,w,v,b),u=0);break}}l>=o&&(m+=i.width[o],h+=i.width[o],f+=i.width[o])}0!=u&&(n(u,a,g,w,v,b),u=0),0!=_&&(t(_,a,g,w,v,b),_=0)}function i(e,t,r){var n=0,a=0;do{var i=e[t++],s=e[t++];i>n&&(n=i),s>a&&(a=s)}while(r>t);return a>n&&(n=a),n}function s(e,t,r,n,a,i){var s,o=65536*ee.ht[n].xlen+ee.ht[a].xlen,l=0;do{var c=e[t++],f=e[t++];0!=c&&(c>14&&(c=15,l+=o),c*=16),0!=f&&(f>14&&(f=15,l+=o),c+=f),l+=ee.largetbl[c]}while(r>t);return s=65535&l,l>>=16,l>s&&(l=s,n=a),i.bits+=l,n}function o(e,t,r,n){var a=0,i=ee.ht[1].hlen;do{var s=2*e[t+0]+e[t+1];t+=2,a+=i[s]}while(r>t);return n.bits+=a,1}function l(e,t,r,n,a){var i,s,o=0,l=ee.ht[n].xlen;s=2==n?ee.table23:ee.table56;do{var c=e[t+0]*l+e[t+1];t+=2,o+=s[c]}while(r>t);return i=65535&o,o>>=16,o>i&&(o=i,n++),a.bits+=o,n}function c(e,t,r,n,a){var i=0,s=0,o=0,l=ee.ht[n].xlen,c=ee.ht[n].hlen,f=ee.ht[n+1].hlen,u=ee.ht[n+2].hlen;do{var _=e[t+0]*l+e[t+1];t+=2,i+=c[_],s+=f[_],o+=u[_]}while(r>t);var h=n;return i>s&&(i=s,h++),i>o&&(i=o,h=n+2),a.bits+=i,h}function f(e,t,r,n){var a=i(e,t,r);switch(a){case 0:return a;case 1:return o(e,t,r,n);case 2:case 3:return l(e,t,r,v[a-1],n);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return c(e,t,r,v[a-1],n);default:if(a>B.IXMAX_VAL)return n.bits=B.LARGE_BITS,-1;a-=15;var f;for(f=24;32>f&&!(ee.ht[f].linmax>=a);f++);var u;for(u=f-8;24>u&&!(ee.ht[u].linmax>=a);u++);return s(e,t,r,u,f,n)}}function u(t,r,n,a,i,s,o){for(var l=r.big_values,c=0;22>=c;c++)a[c]=B.LARGE_BITS;for(var c=0;16>c;c++){var u=t.scalefac_band.l[c+1];if(u>=l)break;var _=0,h=new e(_),d=f(n,0,u,h);_=h.bits;for(var p=0;8>p;p++){var m=t.scalefac_band.l[c+p+2];if(m>=l)break;var v=_;h=new e(v);var b=f(n,u,m,h);v=h.bits,a[c+p]>v&&(a[c+p]=v,i[c+p]=c,s[c+p]=d,o[c+p]=b)}}}function _(t,r,n,a,i,s,o,l){for(var c=r.big_values,u=2;u<O.SBMAX_l+1;u++){var _=t.scalefac_band.l[u];if(_>=c)break;var h=i[u-2]+r.count1bits;if(n.part2_3_length<=h)break;var d=new e(h),p=f(a,_,c,d);h=d.bits,n.part2_3_length<=h||(n.assign(r),n.part2_3_length=h,n.region0_count=s[u-2],n.region1_count=u-2-s[u-2],n.table_select[0]=o[u-2],n.table_select[1]=l[u-2],n.table_select[2]=p)}}function h(e,t){for(var r,n=t.tt[1][e],a=t.tt[0][e],i=0;i<ee.scfsi_band.length-1;i++){for(r=ee.scfsi_band[i];r<ee.scfsi_band[i+1]&&!(a.scalefac[r]!=n.scalefac[r]&&n.scalefac[r]>=0);r++);if(r==ee.scfsi_band[i+1]){for(r=ee.scfsi_band[i];r<ee.scfsi_band[i+1];r++)n.scalefac[r]=-1;t.scfsi[e][i]=1}}var s=0,o=0;for(r=0;11>r;r++)-1!=n.scalefac[r]&&(o++,s<n.scalefac[r]&&(s=n.scalefac[r]));for(var l=0,c=0;r<O.SBPSY_l;r++)-1!=n.scalefac[r]&&(c++,l<n.scalefac[r]&&(l=n.scalefac[r]));for(var i=0;16>i;i++)if(s<b[i]&&l<g[i]){var f=w[i]*o+y[i]*c;n.part2_length>f&&(n.part2_length=f,n.scalefac_compress=i)}}var d=null;this.qupvt=null,this.setModules=function(e){this.qupvt=e,d=e};var m=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]],v=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];this.noquant_count_bits=function(t,r,n){var a=r.l3_enc,i=Math.min(576,r.max_nonzero_coeff+2>>1<<1);for(null!=n&&(n.sfb_count1=0);i>1&&0==(a[i-1]|a[i-2]);i-=2);r.count1=i;for(var s=0,o=0;i>3;i-=4){var l;if((2147483647&(a[i-1]|a[i-2]|a[i-3]|a[i-4]))>1)break;l=2*(2*(2*a[i-4]+a[i-3])+a[i-2])+a[i-1],s+=ee.t32l[l],o+=ee.t33l[l]}var c=s;if(r.count1table_select=0,s>o&&(c=o,r.count1table_select=1),r.count1bits=c,r.big_values=i,0==i)return c;if(r.block_type==O.SHORT_TYPE)s=3*t.scalefac_band.s[3],s>r.big_values&&(s=r.big_values),o=r.big_values;else if(r.block_type==O.NORM_TYPE){if(s=r.region0_count=t.bv_scf[i-2],o=r.region1_count=t.bv_scf[i-1],o=t.scalefac_band.l[s+o+2],s=t.scalefac_band.l[s+1],i>o){var u=new e(c);r.table_select[2]=f(a,o,i,u),c=u.bits}}else r.region0_count=7,r.region1_count=O.SBMAX_l-1-7-1,s=t.scalefac_band.l[8],o=i,s>o&&(s=o);if(s=Math.min(s,i),o=Math.min(o,i),s>0){var u=new e(c);r.table_select[0]=f(a,0,s,u),c=u.bits}if(o>s){var u=new e(c);r.table_select[1]=f(a,s,o,u),c=u.bits}if(2==t.use_best_huffman&&(r.part2_3_length=c,best_huffman_divide(t,r),c=r.part2_3_length),null!=n&&r.block_type==O.NORM_TYPE){for(var _=0;t.scalefac_band.l[_]<r.big_values;)_++;n.sfb_count1=_}return c},this.count_bits=function(e,t,r,n){var i=r.l3_enc,s=B.IXMAX_VAL/d.IPOW20(r.global_gain);if(r.xrpow_max>s)return B.LARGE_BITS;if(a(t,i,d.IPOW20(r.global_gain),r,n),0!=(2&e.substep_shaping))for(var o=0,l=r.global_gain+r.scalefac_scale,c=.634521682242439/d.IPOW20(l),f=0;f<r.sfbmax;f++){var u=r.width[f];if(0==e.pseudohalf[f])o+=u;else{var _;for(_=o,o+=u;o>_;++_)i[_]=t[_]>=c?i[_]:0}}return this.noquant_count_bits(e,r,n)},this.best_huffman_divide=function(t,n){var a=new x,i=n.l3_enc,s=r(23),o=r(23),l=r(23),c=r(23);if(n.block_type!=O.SHORT_TYPE||1!=t.mode_gr){a.assign(n),n.block_type==O.NORM_TYPE&&(u(t,n,i,s,o,l,c),_(t,a,n,i,s,o,l,c));var h=a.big_values;if(!(0==h||(i[h-2]|i[h-1])>1||(h=n.count1+2,h>576))){a.assign(n),a.count1=h;for(var d=0,p=0;h>a.big_values;h-=4){var m=2*(2*(2*i[h-4]+i[h-3])+i[h-2])+i[h-1];d+=ee.t32l[m],p+=ee.t33l[m]}if(a.big_values=h,a.count1table_select=0,d>p&&(d=p,a.count1table_select=1),a.count1bits=d,a.block_type==O.NORM_TYPE)_(t,a,n,i,s,o,l,c);else{if(a.part2_3_length=d,d=t.scalefac_band.l[8],d>h&&(d=h),d>0){var v=new e(a.part2_3_length);a.table_select[0]=f(i,0,d,v),a.part2_3_length=v.bits}if(h>d){var v=new e(a.part2_3_length);a.table_select[1]=f(i,d,h,v),a.part2_3_length=v.bits}n.part2_3_length>a.part2_3_length&&n.assign(a)}}}};var b=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],g=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],w=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],y=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];p.slen1_tab=w,p.slen2_tab=y,this.best_scalefac_store=function(e,t,r,n){var a,i,s,o,l=n.tt[t][r],c=0;for(s=0,a=0;a<l.sfbmax;a++){var f=l.width[a];for(s+=f,o=-f;0>o&&0==l.l3_enc[o+s];o++);0==o&&(l.scalefac[a]=c=-2)}if(0==l.scalefac_scale&&0==l.preflag){var u=0;for(a=0;a<l.sfbmax;a++)l.scalefac[a]>0&&(u|=l.scalefac[a]);if(0==(1&u)&&0!=u){for(a=0;a<l.sfbmax;a++)l.scalefac[a]>0&&(l.scalefac[a]>>=1);l.scalefac_scale=c=1}}if(0==l.preflag&&l.block_type!=O.SHORT_TYPE&&2==e.mode_gr){for(a=11;a<O.SBPSY_l&&!(l.scalefac[a]<d.pretab[a]&&-2!=l.scalefac[a]);a++);if(a==O.SBPSY_l){for(a=11;a<O.SBPSY_l;a++)l.scalefac[a]>0&&(l.scalefac[a]-=d.pretab[a]);l.preflag=c=1}}for(i=0;4>i;i++)n.scfsi[r][i]=0;for(2==e.mode_gr&&1==t&&n.tt[0][r].block_type!=O.SHORT_TYPE&&n.tt[1][r].block_type!=O.SHORT_TYPE&&(h(r,n),c=0),a=0;a<l.sfbmax;a++)-2==l.scalefac[a]&&(l.scalefac[a]=0);0!=c&&(2==e.mode_gr?this.scale_bitcount(l):this.scale_bitcount_lsf(e,l))};var R=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],S=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],A=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(e){var t,r,n,a=0,i=0,s=e.scalefac;if(e.block_type==O.SHORT_TYPE)n=R,0!=e.mixed_block_flag&&(n=S);else if(n=A,0==e.preflag){for(r=11;r<O.SBPSY_l&&!(s[r]<d.pretab[r]);r++);if(r==O.SBPSY_l)for(e.preflag=1,r=11;r<O.SBPSY_l;r++)s[r]-=d.pretab[r]}for(r=0;r<e.sfbdivide;r++)a<s[r]&&(a=s[r]);for(;r<e.sfbmax;r++)i<s[r]&&(i=s[r]);for(e.part2_length=B.LARGE_BITS,t=0;16>t;t++)a<b[t]&&i<g[t]&&e.part2_length>n[t]&&(e.part2_length=n[t],e.scalefac_compress=t);return e.part2_length==B.LARGE_BITS};var T=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(e,t){var n,a,i,s,o,l,c,f,u=r(4),_=t.scalefac;for(n=0!=t.preflag?2:0,c=0;4>c;c++)u[c]=0;if(t.block_type==O.SHORT_TYPE){a=1;var h=d.nr_of_sfb_block[n][a];for(f=0,i=0;4>i;i++)for(s=h[i]/3,c=0;s>c;c++,f++)for(o=0;3>o;o++)_[3*f+o]>u[i]&&(u[i]=_[3*f+o])}else{a=0;var h=d.nr_of_sfb_block[n][a];for(f=0,i=0;4>i;i++)for(s=h[i],c=0;s>c;c++,f++)_[f]>u[i]&&(u[i]=_[f])}for(l=!1,i=0;4>i;i++)u[i]>T[n][i]&&(l=!0);if(!l){var p,m,v,b;for(t.sfb_partition_table=d.nr_of_sfb_block[n][a],i=0;4>i;i++)t.slen[i]=E[u[i]];switch(p=t.slen[0],m=t.slen[1],v=t.slen[2],b=t.slen[3],n){case 0:t.scalefac_compress=(5*p+m<<4)+(v<<2)+b;break;case 1:t.scalefac_compress=400+(5*p+m<<2)+v;break;case 2:t.scalefac_compress=500+3*p+m;break;default:Q.err.printf("intensity stereo not implemented yet\n")}}if(!l)for(t.part2_length=0,i=0;4>i;i++)t.part2_length+=t.slen[i]*t.sfb_partition_table[i];return l};var E=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var t=2;576>=t;t+=2){for(var r,n=0;e.scalefac_band.l[++n]<t;);for(r=m[n][0];e.scalefac_band.l[r+1]>t;)r--;for(0>r&&(r=m[n][0]),e.bv_scf[t-2]=r,r=m[n][1];e.scalefac_band.l[r+e.bv_scf[t-2]+2]>t;)r--;0>r&&(r=m[n][1]),e.bv_scf[t-1]=r}}}function m(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,r){var n,a=t.internal_flags,i=a.l3_side,s=e.getframebits(t);r.bits=(s-8*a.sideinfo_len)/a.mode_gr;var o=2048*a.mode_gr-8;t.brate>320?n=8*int(1e3*t.brate/(t.out_samplerate/1152)/8+.5):(n=11520,t.strict_ISO&&(n=8*int(32e4/(t.out_samplerate/1152)/8+.5))),a.ResvMax=n-s,a.ResvMax>o&&(a.ResvMax=o),(a.ResvMax<0||t.disable_reservoir)&&(a.ResvMax=0);var l=r.bits*a.mode_gr+Math.min(a.ResvSize,a.ResvMax);return l>n&&(l=n),i.resvDrain_pre=0,null!=a.pinfo&&(a.pinfo.mean_bits=r.bits/2,a.pinfo.resvsize=a.ResvSize),l},this.ResvMaxBits=function(e,t,r,n){var a,i=e.internal_flags,s=i.ResvSize,o=i.ResvMax;0!=n&&(s+=t),0!=(1&i.substep_shaping)&&(o*=.9),r.bits=t,10*s>9*o?(a=s-9*o/10,r.bits+=a,i.substep_shaping|=128):(a=0,i.substep_shaping&=127,e.disable_reservoir||0!=(1&i.substep_shaping)||(r.bits-=.1*t));var l=s<6*i.ResvMax/10?s:6*i.ResvMax/10;return l-=a,0>l&&(l=0),l},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var r,n=e.l3_side;e.ResvSize+=t*e.mode_gr;var a=0;n.resvDrain_post=0,n.resvDrain_pre=0,0!=(r=e.ResvSize%8)&&(a+=r),r=e.ResvSize-a-e.ResvMax,r>0&&(a+=r);var i=Math.min(8*n.main_data_begin,a)/8;n.resvDrain_pre+=8*i,a-=8*i,e.ResvSize-=8*i,n.main_data_begin-=i,n.resvDrain_post+=a,e.ResvSize-=a}}function v(){function t(e){Q.arraycopy(e.header[e.w_ptr].buf,0,T,M,e.sideinfo_len),M+=e.sideinfo_len,E+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&H.MAX_HEADER_BUF-1}function n(e,r,n){for(;n>0;){var a;0==B&&(B=8,M++,e.header[e.w_ptr].write_timing==E&&t(e),T[M]=0),a=Math.min(n,B),n-=a,B-=a,T[M]|=r>>n<<B,E+=a}}function a(e,t,r){for(;r>0;){var n;0==B&&(B=8,M++,T[M]=0),n=Math.min(r,B),r-=n,B-=n,T[M]|=t>>r<<B,E+=n}}function s(e,t){var r,a=e.internal_flags;if(t>=8&&(n(a,76,8),t-=8),t>=8&&(n(a,65,8),t-=8),t>=8&&(n(a,77,8),t-=8),t>=8&&(n(a,69,8),t-=8),t>=32){var i=S.getLameShortVersion();if(t>=32)for(r=0;r<i.length&&t>=8;++r)t-=8,n(a,i.charAt(r),8)}for(;t>=1;t-=1)n(a,a.ancillary_flag,1),a.ancillary_flag^=e.disable_reservoir?0:1}function o(e,t,r){for(var n=e.header[e.h_ptr].ptr;r>0;){var a=Math.min(r,8-(7&n));r-=a,e.header[e.h_ptr].buf[n>>3]|=t>>r<<8-(7&n)-a,n+=a}e.header[e.h_ptr].ptr=n}function l(e,t){e<<=8;for(var r=0;8>r;r++)e<<=1,t<<=1,0!=(65536&(t^e))&&(t^=w);return t}function c(e,t){var r,n,a,i=e.internal_flags;if(r=i.l3_side,i.header[i.h_ptr].ptr=0,W.fill(i.header[i.h_ptr].buf,0,i.sideinfo_len,0),e.out_samplerate<16e3?o(i,4094,12):o(i,4095,12),o(i,e.version,1),o(i,1,2),o(i,e.error_protection?0:1,1),o(i,i.bitrate_index,4),o(i,i.samplerate_index,2),o(i,i.padding,1),o(i,e.extension,1),o(i,e.mode.ordinal(),2),o(i,i.mode_ext,2),o(i,e.copyright,1),o(i,e.original,1),o(i,e.emphasis,2),e.error_protection&&o(i,0,16),1==e.version){for(o(i,r.main_data_begin,9),2==i.channels_out?o(i,r.private_bits,3):o(i,r.private_bits,5),a=0;a<i.channels_out;a++){var s;for(s=0;4>s;s++)o(i,r.scfsi[a][s],1)}for(n=0;2>n;n++)for(a=0;a<i.channels_out;a++){var l=r.tt[n][a];o(i,l.part2_3_length+l.part2_length,12),o(i,l.big_values/2,9),o(i,l.global_gain,8),o(i,l.scalefac_compress,4),l.block_type!=O.NORM_TYPE?(o(i,1,1),o(i,l.block_type,2),o(i,l.mixed_block_flag,1),14==l.table_select[0]&&(l.table_select[0]=16),o(i,l.table_select[0],5),14==l.table_select[1]&&(l.table_select[1]=16),o(i,l.table_select[1],5),o(i,l.subblock_gain[0],3),o(i,l.subblock_gain[1],3),o(i,l.subblock_gain[2],3)):(o(i,0,1),14==l.table_select[0]&&(l.table_select[0]=16),o(i,l.table_select[0],5),14==l.table_select[1]&&(l.table_select[1]=16),o(i,l.table_select[1],5),14==l.table_select[2]&&(l.table_select[2]=16),o(i,l.table_select[2],5),o(i,l.region0_count,4),o(i,l.region1_count,3)),o(i,l.preflag,1),o(i,l.scalefac_scale,1),o(i,l.count1table_select,1)}}else for(o(i,r.main_data_begin,8),o(i,r.private_bits,i.channels_out),n=0,a=0;a<i.channels_out;a++){var l=r.tt[n][a];o(i,l.part2_3_length+l.part2_length,12),o(i,l.big_values/2,9),o(i,l.global_gain,8),o(i,l.scalefac_compress,9),l.block_type!=O.NORM_TYPE?(o(i,1,1),o(i,l.block_type,2),o(i,l.mixed_block_flag,1),14==l.table_select[0]&&(l.table_select[0]=16),o(i,l.table_select[0],5),14==l.table_select[1]&&(l.table_select[1]=16),o(i,l.table_select[1],5),o(i,l.subblock_gain[0],3),o(i,l.subblock_gain[1],3),o(i,l.subblock_gain[2],3)):(o(i,0,1),14==l.table_select[0]&&(l.table_select[0]=16),o(i,l.table_select[0],5),14==l.table_select[1]&&(l.table_select[1]=16),o(i,l.table_select[1],5),14==l.table_select[2]&&(l.table_select[2]=16),o(i,l.table_select[2],5),o(i,l.region0_count,4),o(i,l.region1_count,3)),o(i,l.scalefac_scale,1),o(i,l.count1table_select,1)}e.error_protection&&CRC_writeheader(i,i.header[i.h_ptr].buf);var c=i.h_ptr;i.h_ptr=c+1&H.MAX_HEADER_BUF-1,i.header[i.h_ptr].write_timing=i.header[c].write_timing+t,i.h_ptr==i.w_ptr&&Q.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}function f(e,t){var r,a=ee.ht[t.count1table_select+32],i=0,s=t.big_values,o=t.big_values;for(r=(t.count1-t.big_values)/4;r>0;--r){var l,c=0,f=0;l=t.l3_enc[s+0],0!=l&&(f+=8,t.xr[o+0]<0&&c++),l=t.l3_enc[s+1],0!=l&&(f+=4,c*=2,t.xr[o+1]<0&&c++),l=t.l3_enc[s+2],0!=l&&(f+=2,c*=2,t.xr[o+2]<0&&c++),l=t.l3_enc[s+3],0!=l&&(f++,c*=2,t.xr[o+3]<0&&c++),s+=4,o+=4,n(e,c+a.table[f],a.hlen[f]),i+=a.hlen[f]}return i}function u(e,t,r,a,i){var s=ee.ht[t],o=0;if(0==t)return o;for(var l=r;a>l;l+=2){var c=0,f=0,u=s.xlen,_=s.xlen,h=0,d=i.l3_enc[l],p=i.l3_enc[l+1];if(0!=d&&(i.xr[l]<0&&h++,c--),t>15){if(d>14){var m=d-15;h|=m<<1,f=u,d=15}if(p>14){var v=p-15;h<<=u,h|=v,f+=u,p=15}_=16}0!=p&&(h<<=1,i.xr[l+1]<0&&h++,c--),d=d*_+p,f-=c,c+=s.hlen[d],n(e,s.table[d],c),n(e,h,f),o+=c+f}return o}function _(e,t){var r=3*e.scalefac_band.s[3];r>t.big_values&&(r=t.big_values);var n=u(e,t.table_select[0],0,r,t);return n+=u(e,t.table_select[1],r,t.big_values,t)}function h(e,t){var r,n,a,i;r=t.big_values;var s=t.region0_count+1;return a=e.scalefac_band.l[s],s+=t.region1_count+1,i=e.scalefac_band.l[s],a>r&&(a=r),i>r&&(i=r),n=u(e,t.table_select[0],0,a,t),n+=u(e,t.table_select[1],a,i,t),n+=u(e,t.table_select[2],i,r,t)}function m(e){var t,r,a,i,s=0,o=e.internal_flags,l=o.l3_side;if(1==e.version)for(t=0;2>t;t++)for(r=0;r<o.channels_out;r++){var c=l.tt[t][r],u=p.slen1_tab[c.scalefac_compress],d=p.slen2_tab[c.scalefac_compress];for(i=0,a=0;a<c.sfbdivide;a++)-1!=c.scalefac[a]&&(n(o,c.scalefac[a],u),i+=u);for(;a<c.sfbmax;a++)-1!=c.scalefac[a]&&(n(o,c.scalefac[a],d),i+=d);i+=c.block_type==O.SHORT_TYPE?_(o,c):h(o,c),i+=f(o,c),s+=i}else for(t=0,r=0;r<o.channels_out;r++){var m,v,c=l.tt[t][r],b=0;if(i=0,a=0,v=0,c.block_type==O.SHORT_TYPE){for(;4>v;v++){var g=c.sfb_partition_table[v]/3,w=c.slen[v];for(m=0;g>m;m++,a++)n(o,Math.max(c.scalefac[3*a+0],0),w),n(o,Math.max(c.scalefac[3*a+1],0),w),n(o,Math.max(c.scalefac[3*a+2],0),w),b+=3*w}i+=_(o,c)}else{for(;4>v;v++){var g=c.sfb_partition_table[v],w=c.slen[v];for(m=0;g>m;m++,a++)n(o,Math.max(c.scalefac[a],0),w),b+=w}i+=h(o,c)}i+=f(o,c),s+=b+i}return s}function v(){this.total=0}function b(e,t){var r,n,a,i,s,o=e.internal_flags;return s=o.w_ptr,i=o.h_ptr-1,-1==i&&(i=H.MAX_HEADER_BUF-1),r=o.header[i].write_timing-E,t.total=r,r>=0&&(n=1+i-s,s>i&&(n=1+i-s+H.MAX_HEADER_BUF),r-=8*n*o.sideinfo_len),a=g.getframebits(e),r+=a,t.total+=a,t.total%8!=0?t.total=1+t.total/8:t.total=t.total/8,t.total+=M+1,0>r&&Q.err.println("strange error flushing buffer ... \n"),r}var g=this,w=32773,y=null,R=null,S=null,A=null;this.setModules=function(e,t,r,n){y=e,R=t,S=r,A=n};var T=null,E=0,M=0,B=0;this.getframebits=function(e){var t,r=e.internal_flags;t=0!=r.bitrate_index?ee.bitrate_table[e.version][r.bitrate_index]:e.brate;var n=0|72e3*(e.version+1)*t/e.out_samplerate+r.padding;return 8*n},this.CRC_writeheader=function(e,t){var r=65535;r=l(255&t[2],r),r=l(255&t[3],r);for(var n=6;n<e.sideinfo_len;n++)r=l(255&t[n],r);t[4]=byte(r>>8),t[5]=byte(255&r)},this.flush_bitstream=function(e){var t,r,n=e.internal_flags,a=n.h_ptr-1;if(-1==a&&(a=H.MAX_HEADER_BUF-1),t=n.l3_side,!((r=b(e,new v))<0)){if(s(e,r),n.ResvSize=0,t.main_data_begin=0,n.findReplayGain){var i=y.GetTitleGain(n.rgdata);n.RadioGain=0|Math.floor(10*i+.5)}n.findPeakSample&&(n.noclipGainChange=0|Math.ceil(20*Math.log10(n.PeakSample/32767)*10),n.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?n.noclipScale=Math.floor(32767/n.PeakSample*100)/100:n.noclipScale=-1)}},this.add_dummy_byte=function(e,t,r){for(var n,i=e.internal_flags;r-->0;)for(a(i,t,8),n=0;n<H.MAX_HEADER_BUF;++n)i.header[n].write_timing+=8},this.format_bitstream=function(e){var t,r=e.internal_flags;t=r.l3_side;var n=this.getframebits(e);s(e,t.resvDrain_pre),c(e,n);var a=8*r.sideinfo_len;if(a+=m(e),s(e,t.resvDrain_post),a+=t.resvDrain_post,t.main_data_begin+=(n-a)/8,b(e,new v)!=r.ResvSize&&Q.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*t.main_data_begin!=r.ResvSize&&(Q.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*t.main_data_begin,r.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*r.sideinfo_len,a-t.resvDrain_post-8*r.sideinfo_len,a,a%8,n),Q.err.println("This is a fatal error.  It has several possible causes:"),Q.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),Q.err.println(" 9%%  Your system is overclocked"),Q.err.println(" 1%%  bug in LAME encoding library"),r.ResvSize=8*t.main_data_begin),E>1e9){var i;for(i=0;i<H.MAX_HEADER_BUF;++i)r.header[i].write_timing-=E;E=0}return 0},this.copy_buffer=function(e,t,n,a,s){var o=M+1;if(0>=o)return 0;if(0!=a&&o>a)return-1;if(Q.arraycopy(T,0,t,n,o),M=-1,B=0,0!=s){var l=r(1);if(l[0]=e.nMusicCRC,A.updateMusicCRC(l,t,n,o),e.nMusicCRC=l[0],o>0&&(e.VBR_seek_table.nBytesWritten+=o),e.decode_on_the_fly)for(var c,f=i([2,1152]),u=o,_=-1;0!=_;)if(_=R.hip_decode1_unclipped(e.hip,t,n,u,f[0],f[1]),u=0,-1==_&&(_=0),_>0){if(e.findPeakSample){for(c=0;_>c;c++)f[0][c]>e.PeakSample?e.PeakSample=f[0][c]:-f[0][c]>e.PeakSample&&(e.PeakSample=-f[0][c]);if(e.channels_out>1)for(c=0;_>c;c++)f[1][c]>e.PeakSample?e.PeakSample=f[1][c]:-f[1][c]>e.PeakSample&&(e.PeakSample=-f[1][c])}if(e.findReplayGain&&y.AnalyzeSamples(e.rgdata,f[0],0,f[1],0,_,e.channels_out)==d.GAIN_ANALYSIS_ERROR)return-6}}return o},this.init_bit_stream_w=function(t){T=e(Y.LAME_MAXMP3BUFFER),t.h_ptr=t.w_ptr=0,t.header[t.h_ptr].write_timing=0,M=-1,B=0,E=0}}function b(){function t(e,t){if(e.nVbrNumFrames++,e.sum+=t,e.seen++,!(e.seen<e.want)&&(e.pos<e.size&&(e.bag[e.pos]=e.sum,e.pos++,e.seen=0),e.pos==e.size)){for(var r=1;r<e.size;r+=2)e.bag[r/2]=e.bag[r];e.want*=2,e.pos/=2}}function r(e,t){if(!(e.pos<=0))for(var r=1;R>r;++r){var n,a,i=r/R,s=0|Math.floor(i*e.pos);s>e.pos-1&&(s=e.pos-1),n=e.bag[s],a=e.sum;var o=0|256*n/a;o>255&&(o=255),t[r]=255&o}}function n(e,t){var r=255&e[t+0];return r<<=8,r|=255&e[t+1],r<<=8,r|=255&e[t+2],r<<=8,r|=255&e[t+3]}function a(e,t,r){e[t+0]=255&(r>>24&255),e[t+1]=255&(r>>16&255),e[t+2]=255&(r>>8&255),e[t+3]=255&(255&r)}function i(e,t,r){e[t+0]=255&(r>>8&255),e[t+1]=255&(255&r)}function s(e,t){return new String(e,t,x.length(),k).equals(x)||new String(e,t,P.length(),k).equals(P)}function o(e,t,r){return 255&(e<<t|r&~(-1<<t))}function l(e,t){var r=e.internal_flags;t[0]=o(t[0],8,255),t[1]=o(t[1],3,7),t[1]=o(t[1],1,e.out_samplerate<16e3?0:1),t[1]=o(t[1],1,e.version),t[1]=o(t[1],2,1),t[1]=o(t[1],1,e.error_protection?0:1),t[2]=o(t[2],4,r.bitrate_index),t[2]=o(t[2],2,r.samplerate_index),t[2]=o(t[2],1,0),t[2]=o(t[2],1,e.extension),t[3]=o(t[3],2,e.mode.ordinal()),t[3]=o(t[3],2,r.mode_ext),t[3]=o(t[3],1,e.copyright),t[3]=o(t[3],1,e.original),t[3]=o(t[3],2,e.emphasis),t[0]=255;var n,a=255&(241&t[1]);n=1==e.version?E:e.out_samplerate<16e3?B:M,e.VBR==f.vbr_off&&(n=e.brate);var i;i=e.free_format?0:255&16*d.BitrateIndex(n,e.version,e.out_samplerate),1==e.version?(t[1]=255&(10|a),a=255&(13&t[2]),t[2]=255&(i|a)):(t[1]=255&(2|a),a=255&(13&t[2]),t[2]=255&(i|a))}function u(e,t){var r=t^e;return t=t>>8^I[255&r]}function _(e,t,r,n,s){var o,l,f,_=e.internal_flags,h=0,d=e.encoder_delay,p=e.encoder_padding,v=100-10*e.VBR_q-e.quality,b=m.getLameVeryShortVersion(),g=0,w=[1,5,3,2,4,0,3],y=0|(e.lowpassfreq/100+.5>255?255:e.lowpassfreq/100+.5),R=0,S=0,A=0,T=e.internal_flags.noise_shaping,E=0,M=0,B=0,k=0,x=0,P=0!=(1&e.exp_nspsytune),I=0!=(2&e.exp_nspsytune),L=!1,O=!1,C=e.internal_flags.nogap_total,D=e.internal_flags.nogap_current,N=e.ATHtype,V=0;switch(e.VBR){case vbr_abr:f=e.VBR_mean_bitrate_kbps;break;case vbr_off:f=e.brate;break;default:f=e.VBR_min_bitrate_kbps}switch(o=e.VBR.ordinal()<w.length?w[e.VBR.ordinal()]:0,l=16*g+o,_.findReplayGain&&(_.RadioGain>510&&(_.RadioGain=510),_.RadioGain<-510&&(_.RadioGain=-510),S=8192,S|=3072,_.RadioGain>=0?S|=_.RadioGain:(S|=512,S|=-_.RadioGain)),_.findPeakSample&&(R=Math.abs(0|_.PeakSample/32767*Math.pow(2,23)+.5)),-1!=C&&(D>0&&(O=!0),C-1>D&&(L=!0)),V=N+((P?1:0)<<4)+((I?1:0)<<5)+((L?1:0)<<6)+((O?1:0)<<7),0>v&&(v=0),e.mode){case MONO:E=0;break;case STEREO:E=1;break;case DUAL_CHANNEL:E=2;break;case JOINT_STEREO:E=e.force_ms?4:3;break;case NOT_SET:default:E=7}B=e.in_samplerate<=32e3?0:48e3==e.in_samplerate?2:e.in_samplerate>48e3?3:1,(e.short_blocks==c.short_block_forced||e.short_blocks==c.short_block_dispensed||-1==e.lowpassfreq&&-1==e.highpassfreq||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||0==N||e.in_samplerate<=32e3)&&(M=1),k=T+(E<<2)+(M<<5)+(B<<6),x=_.nMusicCRC,a(r,n+h,v),h+=4;for(var H=0;9>H;H++)r[n+h+H]=255&b.charAt(H);h+=9,r[n+h]=255&l,h++,r[n+h]=255&y,h++,a(r,n+h,R),h+=4,i(r,n+h,S),h+=2,i(r,n+h,A),h+=2,r[n+h]=255&V,h++,f>=255?r[n+h]=255:r[n+h]=255&f,h++,r[n+h]=255&d>>4,r[n+h+1]=255&(d<<4)+(p>>8),r[n+h+2]=255&p,h+=3,r[n+h]=255&k,h++,r[n+h++]=0,i(r,n+h,e.preset),h+=2,a(r,n+h,t),h+=4,i(r,n+h,x),h+=2;for(var U=0;h>U;U++)s=u(r[n+U],s);return i(r,n+h,s),h+=2}function h(t){t.seek(0);var r=e(10);t.readFully(r);var n;return n=new String(r,"ISO-8859-1").startsWith("ID3")?0:((127&r[6])<<21|(127&r[7])<<14|(127&r[8])<<7|127&r[9])+r.length}var d,p,m;this.setModules=function(e,t,r){d=e,p=t,m=r};var v=1,g=2,w=4,y=8,R=b.NUMTOCENTRIES,S=b.MAXFRAMESIZE,A=R+4+4+4+4+4,T=A+9+1+1+8+1+1+3+1+1+2+4+2+2,E=128,M=64,B=32,k=null,x="Xing",P="Info",I=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];this.addVbrFrame=function(e){var r=e.internal_flags,n=ee.bitrate_table[e.version][r.bitrate_index];t(r.VBR_seek_table,n)},this.getVbrTag=function(e){var t=new VBRTagData,r=0;t.flags=0;var a=e[r+1]>>3&1,i=e[r+2]>>2&3,o=e[r+3]>>6&3,l=e[r+2]>>4&15;if(l=ee.bitrate_table[a][l],e[r+1]>>4==14?t.samprate=ee.samplerate_table[2][i]:t.samprate=ee.samplerate_table[a][i],r+=0!=a?3!=o?36:21:3!=o?21:13,!s(e,r))return null;r+=4,t.hId=a;var c=t.flags=n(e,r);if(r+=4,0!=(c&v)&&(t.frames=n(e,r),r+=4),0!=(c&g)&&(t.bytes=n(e,r),r+=4),0!=(c&w)){if(null!=t.toc)for(var f=0;R>f;f++)t.toc[f]=e[r+f];r+=R}t.vbrScale=-1,0!=(c&y)&&(t.vbrScale=n(e,r),r+=4),t.headersize=72e3*(a+1)*l/t.samprate,r+=21;var u=e[r+0]<<4;u+=e[r+1]>>4;var _=(15&e[r+1])<<8;return _+=255&e[r+2],(0>u||u>3e3)&&(u=-1),(0>_||_>3e3)&&(_=-1),t.encDelay=u,t.encPadding=_,t},this.InitVbrTag=function(t){var r,n=t.internal_flags;r=1==t.version?E:t.out_samplerate<16e3?B:M,t.VBR==f.vbr_off&&(r=t.brate);var a=72e3*(t.version+1)*r/t.out_samplerate,i=n.sideinfo_len+T;if(n.VBR_seek_table.TotalFrameSize=a,i>a||a>S)return void(t.bWriteVbrTag=!1);n.VBR_seek_table.nVbrNumFrames=0,n.VBR_seek_table.nBytesWritten=0,n.VBR_seek_table.sum=0,n.VBR_seek_table.seen=0,n.VBR_seek_table.want=1,n.VBR_seek_table.pos=0,null==n.VBR_seek_table.bag&&(n.VBR_seek_table.bag=new int[400],n.VBR_seek_table.size=400);var s=e(S);l(t,s);for(var o=n.VBR_seek_table.TotalFrameSize,c=0;o>c;++c)p.add_dummy_byte(t,255&s[c],1)},this.updateMusicCRC=function(e,t,r,n){for(var a=0;n>a;++a)e[0]=u(t[r+a],e[0])},this.getLameTagFrame=function(t,n){var i=t.internal_flags;if(!t.bWriteVbrTag)return 0;if(i.Class_ID!=Y.LAME_ID)return 0;if(i.VBR_seek_table.pos<=0)return 0;if(n.length<i.VBR_seek_table.TotalFrameSize)return i.VBR_seek_table.TotalFrameSize;W.fill(n,0,i.VBR_seek_table.TotalFrameSize,0),l(t,n);var s=e(R);if(t.free_format)for(var o=1;R>o;++o)s[o]=255&255*o/100;else r(i.VBR_seek_table,s);var c=i.sideinfo_len;t.error_protection&&(c-=2),t.VBR==f.vbr_off?(n[c++]=255&P.charAt(0),n[c++]=255&P.charAt(1),n[c++]=255&P.charAt(2),n[c++]=255&P.charAt(3)):(n[c++]=255&x.charAt(0),n[c++]=255&x.charAt(1),n[c++]=255&x.charAt(2),n[c++]=255&x.charAt(3)),a(n,c,v+g+w+y),c+=4,a(n,c,i.VBR_seek_table.nVbrNumFrames),c+=4;var h=i.VBR_seek_table.nBytesWritten+i.VBR_seek_table.TotalFrameSize;a(n,c,0|h),c+=4,Q.arraycopy(s,0,n,c,s.length),c+=s.length,t.error_protection&&p.CRC_writeheader(i,n);for(var d=0,o=0;c>o;o++)d=u(n[o],d);return c+=_(t,h,n,c,d),i.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(t,r){var n=t.internal_flags;if(n.VBR_seek_table.pos<=0)return-1;if(r.seek(r.length()),0==r.length())return-1;var a=h(r);r.seek(a);var i=e(S),s=getLameTagFrame(t,i);return s>i.length?-1:1>s?0:(r.write(i,0,s),0)}}function g(e,t,r,n){this.xlen=e,this.linmax=t,this.table=r,this.hlen=n}function w(e){this.bits=e}function y(){var e,t;this.setModules=function(r,n){e=r,t=n}}function R(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function S(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=u.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,
this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function A(){this.linprebuf=n(2*d.MAX_ORDER),this.linpre=0,this.lstepbuf=n(d.MAX_SAMPLES_PER_WINDOW+d.MAX_ORDER),this.lstep=0,this.loutbuf=n(d.MAX_SAMPLES_PER_WINDOW+d.MAX_ORDER),this.lout=0,this.rinprebuf=n(2*d.MAX_ORDER),this.rinpre=0,this.rstepbuf=n(d.MAX_SAMPLES_PER_WINDOW+d.MAX_ORDER),this.rstep=0,this.routbuf=n(d.MAX_SAMPLES_PER_WINDOW+d.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=r(0|d.STEPS_per_dB*d.MAX_dB),this.B=r(0|d.STEPS_per_dB*d.MAX_dB)}function T(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=n(O.SBMAX_l),this.s=n(O.SBMAX_s),this.psfb21=n(O.PSFB21),this.psfb12=n(O.PSFB12),this.cb_l=n(O.CBANDS),this.cb_s=n(O.CBANDS),this.eql_w=n(O.BLKSIZE/2)}function E(e){var t=e;this.quantize=t,this.iteration_loop=function(e,t,a,i){var s,o=e.internal_flags,l=n(te.SFBMAX),c=n(576),f=r(2),u=0,_=o.l3_side,h=new w(u);this.quantize.rv.ResvFrameBegin(e,h),u=h.bits;for(var d=0;d<o.mode_gr;d++){s=this.quantize.qupvt.on_pe(e,t,f,u,d,d),o.mode_ext==O.MPG_MD_MS_LR&&(this.quantize.ms_convert(o.l3_side,d),this.quantize.qupvt.reduce_side(f,a[d],u,s));for(var p=0;p<o.channels_out;p++){var m,v,b=_.tt[d][p];b.block_type!=O.SHORT_TYPE?(m=0,v=o.PSY.mask_adjust-m):(m=0,v=o.PSY.mask_adjust_short-m),o.masking_lower=Math.pow(10,.1*v),this.quantize.init_outer_loop(o,b),this.quantize.init_xrpow(o,b,c)&&(this.quantize.qupvt.calc_xmin(e,i[d][p],b,l),this.quantize.outer_loop(e,b,l,c,p,f[p])),this.quantize.iteration_finish_one(o,d,p)}}this.quantize.rv.ResvFrameEnd(o,u)}}function M(e,t,n,a){this.l=r(1+O.SBMAX_l),this.s=r(1+O.SBMAX_s),this.psfb21=r(1+O.PSFB21),this.psfb12=r(1+O.PSFB12);var i=this.l,s=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Q.arraycopy(this.arrL,0,i,0,Math.min(this.arrL.length,this.l.length)),Q.arraycopy(this.arrS,0,s,0,Math.min(this.arrS.length,this.s.length)),Q.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Q.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function B(){function e(e){return b[e+B.Q_MAX2]}function t(e,t){var r=l.ATHformula(t,e);return r-=p,r=Math.pow(10,r/10+e.ATHlower)}function a(e){for(var r=e.internal_flags.ATH.l,n=e.internal_flags.ATH.psfb21,a=e.internal_flags.ATH.s,i=e.internal_flags.ATH.psfb12,s=e.internal_flags,o=e.out_samplerate,l=0;l<O.SBMAX_l;l++){var c=s.scalefac_band.l[l],f=s.scalefac_band.l[l+1];r[l]=$.MAX_VALUE;for(var u=c;f>u;u++){var _=u*o/1152,h=t(e,_);r[l]=Math.min(r[l],h)}}for(var l=0;l<O.PSFB21;l++){var c=s.scalefac_band.psfb21[l],f=s.scalefac_band.psfb21[l+1];n[l]=$.MAX_VALUE;for(var u=c;f>u;u++){var _=u*o/1152,h=t(e,_);n[l]=Math.min(n[l],h)}}for(var l=0;l<O.SBMAX_s;l++){var c=s.scalefac_band.s[l],f=s.scalefac_band.s[l+1];a[l]=$.MAX_VALUE;for(var u=c;f>u;u++){var _=u*o/384,h=t(e,_);a[l]=Math.min(a[l],h)}a[l]*=s.scalefac_band.s[l+1]-s.scalefac_band.s[l]}for(var l=0;l<O.PSFB12;l++){var c=s.scalefac_band.psfb12[l],f=s.scalefac_band.psfb12[l+1];i[l]=$.MAX_VALUE;for(var u=c;f>u;u++){var _=u*o/384,h=t(e,_);i[l]=Math.min(i[l],h)}i[l]*=s.scalefac_band.s[13]-s.scalefac_band.s[12]}if(e.noATH){for(var l=0;l<O.SBMAX_l;l++)r[l]=1e-20;for(var l=0;l<O.PSFB21;l++)n[l]=1e-20;for(var l=0;l<O.SBMAX_s;l++)a[l]=1e-20;for(var l=0;l<O.PSFB12;l++)i[l]=1e-20}s.ATH.floor=10*Math.log10(t(e,-1))}function i(e){this.s=e}var s=null,o=null,l=null;this.setModules=function(e,t,r){s=e,o=t,l=r},this.IPOW20=function(e){return g[e]};var c=2.220446049250313e-16,u=B.IXMAX_VAL,_=u+2,h=B.Q_MAX,d=B.Q_MAX2,p=(B.LARGE_BITS,100);this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var m=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=m,this.sfBandIndex=[new M([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new M([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new M([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new M([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new M([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new M([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new M([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new M([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new M([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var b=n(h+d+1),g=n(h),y=n(_),S=n(_);this.adj43=S,this.iteration_init=function(e){var t,r=e.internal_flags,n=r.l3_side;if(0==r.iteration_init_init){for(r.iteration_init_init=1,n.main_data_begin=0,a(e),y[0]=0,t=1;_>t;t++)y[t]=Math.pow(t,4/3);for(t=0;_-1>t;t++)S[t]=t+1-Math.pow(.5*(y[t]+y[t+1]),.75);for(S[t]=.5,t=0;h>t;t++)g[t]=Math.pow(2,(t-210)*-.1875);for(t=0;h+d>=t;t++)b[t]=Math.pow(2,.25*(t-210-d));s.huffman_init(r);var i,o,l,c;for(t=e.exp_nspsytune>>2&63,t>=32&&(t-=64),i=Math.pow(10,t/4/10),t=e.exp_nspsytune>>8&63,t>=32&&(t-=64),o=Math.pow(10,t/4/10),t=e.exp_nspsytune>>14&63,t>=32&&(t-=64),l=Math.pow(10,t/4/10),t=e.exp_nspsytune>>20&63,t>=32&&(t-=64),c=l*Math.pow(10,t/4/10),t=0;t<O.SBMAX_l;t++){var f;f=6>=t?i:13>=t?o:20>=t?l:c,r.nsPsy.longfact[t]=f}for(t=0;t<O.SBMAX_s;t++){var f;f=5>=t?i:10>=t?o:11>=t?l:c,r.nsPsy.shortfact[t]=f}}},this.on_pe=function(e,t,n,a,i,s){var l,c,f=e.internal_flags,u=0,_=r(2),h=new w(u),d=o.ResvMaxBits(e,a,h,s);u=h.bits;var p=u+d;for(p>H.MAX_BITS_PER_GRANULE&&(p=H.MAX_BITS_PER_GRANULE),l=0,c=0;c<f.channels_out;++c)n[c]=Math.min(H.MAX_BITS_PER_CHANNEL,u/f.channels_out),_[c]=0|n[c]*t[i][c]/700-n[c],_[c]>3*a/4&&(_[c]=3*a/4),_[c]<0&&(_[c]=0),_[c]+n[c]>H.MAX_BITS_PER_CHANNEL&&(_[c]=Math.max(0,H.MAX_BITS_PER_CHANNEL-n[c])),l+=_[c];if(l>d)for(c=0;c<f.channels_out;++c)_[c]=d*_[c]/l;for(c=0;c<f.channels_out;++c)n[c]+=_[c],d-=_[c];for(l=0,c=0;c<f.channels_out;++c)l+=n[c];if(l>H.MAX_BITS_PER_GRANULE){var m=0;for(c=0;c<f.channels_out;++c)n[c]*=H.MAX_BITS_PER_GRANULE,n[c]/=l,m+=n[c]}return p},this.reduce_side=function(e,t,r,n){var a=.33*(.5-t)/.5;0>a&&(a=0),a>.5&&(a=.5);var i=0|.5*a*(e[0]+e[1]);i>H.MAX_BITS_PER_CHANNEL-e[0]&&(i=H.MAX_BITS_PER_CHANNEL-e[0]),0>i&&(i=0),e[1]>=125&&(e[1]-i>125?(e[0]<r&&(e[0]+=i),e[1]-=i):(e[0]+=e[1]-125,e[1]=125)),i=e[0]+e[1],i>n&&(e[0]=n*e[0]/i,e[1]=n*e[1]/i)},this.athAdjust=function(e,t,r){var n=90.30873362,a=94.82444863,i=J.FAST_LOG10_X(t,10),s=e*e,o=0;return i-=r,s>1e-20&&(o=1+J.FAST_LOG10_X(s,10/n)),0>o&&(o=0),i*=o,i+=r+n-a,Math.pow(10,.1*i)},this.calc_xmin=function(e,t,r,n){var a,i=0,s=e.internal_flags,o=0,l=0,u=s.ATH,_=r.xr,h=e.VBR==f.vbr_mtrh?1:0,d=s.masking_lower;for((e.VBR==f.vbr_mtrh||e.VBR==f.vbr_mt)&&(d=1),a=0;a<r.psy_lmax;a++){var p,m,b,g,w,y;m=e.VBR==f.vbr_rh||e.VBR==f.vbr_mtrh?athAdjust(u.adjust,u.l[a],u.floor):u.adjust*u.l[a],w=r.width[a],b=m/w,g=c,y=w>>1,p=0;do{var R,S;R=_[o]*_[o],p+=R,g+=b>R?R:b,o++,S=_[o]*_[o],p+=S,g+=b>S?S:b,o++}while(--y>0);if(p>m&&l++,a==O.SBPSY_l){var A=m*s.nsPsy.longfact[a];A>g&&(g=A)}if(0!=h&&(m=g),!e.ATHonly){var T=t.en.l[a];if(T>0){var A;A=p*t.thm.l[a]*d/T,0!=h&&(A*=s.nsPsy.longfact[a]),A>m&&(m=A)}}0!=h?n[i++]=m:n[i++]=m*s.nsPsy.longfact[a]}var E=575;if(r.block_type!=O.SHORT_TYPE)for(var M=576;0!=M--&&v.EQ(_[M],0);)E=M;r.max_nonzero_coeff=E;for(var B=r.sfb_smin;a<r.psymax;B++,a+=3){var w,k,x;for(x=e.VBR==f.vbr_rh||e.VBR==f.vbr_mtrh?athAdjust(u.adjust,u.s[B],u.floor):u.adjust*u.s[B],w=r.width[a],k=0;3>k;k++){var m,b,g,p=0,y=w>>1;b=x/w,g=c;do{var R,S;R=_[o]*_[o],p+=R,g+=b>R?R:b,o++,S=_[o]*_[o],p+=S,g+=b>S?S:b,o++}while(--y>0);if(p>x&&l++,B==O.SBPSY_s){var A=x*s.nsPsy.shortfact[B];A>g&&(g=A)}if(m=0!=h?g:x,!e.ATHonly&&!e.ATHshort){var T=t.en.s[B][k];if(T>0){var A;A=p*t.thm.s[B][k]*d/T,0!=h&&(A*=s.nsPsy.shortfact[B]),A>m&&(m=A)}}0!=h?n[i++]=m:n[i++]=m*s.nsPsy.shortfact[B]}e.useTemporal&&(n[i-3]>n[i-3+1]&&(n[i-3+1]+=(n[i-3]-n[i-3+1])*s.decay),n[i-3+1]>n[i-3+2]&&(n[i-3+2]+=(n[i-3+1]-n[i-3+2])*s.decay))}return l},this.calc_noise_core=function(e,t,r,a){var i=0,s=t.s,o=e.l3_enc;if(s>e.count1)for(;0!=r--;){var l;l=e.xr[s],s++,i+=l*l,l=e.xr[s],s++,i+=l*l}else if(s>e.big_values){var c=n(2);for(c[0]=0,c[1]=a;0!=r--;){var l;l=Math.abs(e.xr[s])-c[o[s]],s++,i+=l*l,l=Math.abs(e.xr[s])-c[o[s]],s++,i+=l*l}}else for(;0!=r--;){var l;l=Math.abs(e.xr[s])-y[o[s]]*a,s++,i+=l*l,l=Math.abs(e.xr[s])-y[o[s]]*a,s++,i+=l*l}return t.s=s,i},this.calc_noise=function(t,r,n,a,s){var o,l,c=0,f=0,u=0,_=0,h=0,d=-20,p=0,v=t.scalefac,b=0;for(a.over_SSD=0,o=0;o<t.psymax;o++){var g=t.global_gain-(v[b++]+(0!=t.preflag?m[o]:0)<<t.scalefac_scale+1)-8*t.subblock_gain[t.window[o]],w=0;if(null!=s&&s.step[o]==g)w=s.noise[o],p+=t.width[o],n[c++]=w/r[f++],w=s.noise_log[o];else{var y=e(g);if(l=t.width[o]>>1,p+t.width[o]>t.max_nonzero_coeff){var R;R=t.max_nonzero_coeff-p+1,l=R>0?R>>1:0}var S=new i(p);w=this.calc_noise_core(t,S,l,y),p=S.s,null!=s&&(s.step[o]=g,s.noise[o]=w),w=n[c++]=w/r[f++],w=J.FAST_LOG10(Math.max(w,1e-20)),null!=s&&(s.noise_log[o]=w)}if(null!=s&&(s.global_gain=t.global_gain),h+=w,w>0){var A;A=Math.max(0|10*w+.5,1),a.over_SSD+=A*A,u++,_+=w}d=Math.max(d,w)}return a.over_count=u,a.tot_noise=h,a.over_noise=_,a.max_noise=d,u},this.set_pinfo=function(e,t,r,a,i){var s,o,l,c,f,u=e.internal_flags,_=0==t.scalefac_scale?.5:1,h=t.scalefac,d=n(te.SFBMAX),p=n(te.SFBMAX),v=new R;calc_xmin(e,r,t,d),calc_noise(t,d,p,v,null);var b=0;for(o=t.sfb_lmax,t.block_type!=O.SHORT_TYPE&&0==t.mixed_block_flag&&(o=22),s=0;o>s;s++){var g=u.scalefac_band.l[s],w=u.scalefac_band.l[s+1],y=w-g;for(c=0;w>b;b++)c+=t.xr[b]*t.xr[b];c/=y,f=1e15,u.pinfo.en[a][i][s]=f*c,u.pinfo.xfsf[a][i][s]=f*d[s]*p[s]/y,r.en.l[s]>0&&!e.ATHonly?c/=r.en.l[s]:c=0,u.pinfo.thr[a][i][s]=f*Math.max(c*r.thm.l[s],u.ATH.l[s]),u.pinfo.LAMEsfb[a][i][s]=0,0!=t.preflag&&s>=11&&(u.pinfo.LAMEsfb[a][i][s]=-_*m[s]),s<O.SBPSY_l&&(u.pinfo.LAMEsfb[a][i][s]-=_*h[s])}if(t.block_type==O.SHORT_TYPE)for(o=s,s=t.sfb_smin;s<O.SBMAX_s;s++)for(var g=u.scalefac_band.s[s],w=u.scalefac_band.s[s+1],y=w-g,S=0;3>S;S++){for(c=0,l=g;w>l;l++)c+=t.xr[b]*t.xr[b],b++;c=Math.max(c/y,1e-20),f=1e15,u.pinfo.en_s[a][i][3*s+S]=f*c,u.pinfo.xfsf_s[a][i][3*s+S]=f*d[o]*p[o]/y,r.en.s[s][S]>0?c/=r.en.s[s][S]:c=0,(e.ATHonly||e.ATHshort)&&(c=0),u.pinfo.thr_s[a][i][3*s+S]=f*Math.max(c*r.thm.s[s][S],u.ATH.s[s]),u.pinfo.LAMEsfb_s[a][i][3*s+S]=-2*t.subblock_gain[S],s<O.SBPSY_s&&(u.pinfo.LAMEsfb_s[a][i][3*s+S]-=_*h[o]),o++}u.pinfo.LAMEqss[a][i]=t.global_gain,u.pinfo.LAMEmainbits[a][i]=t.part2_3_length+t.part2_length,u.pinfo.LAMEsfbits[a][i]=t.part2_length,u.pinfo.over[a][i]=v.over_count,u.pinfo.max_noise[a][i]=10*v.max_noise,u.pinfo.over_noise[a][i]=10*v.over_noise,u.pinfo.tot_noise[a][i]=10*v.tot_noise,u.pinfo.over_SSD[a][i]=v.over_SSD}}function k(){this.global_gain=0,this.sfb_count1=0,this.step=r(39),this.noise=n(39),this.noise_log=n(39)}function x(){function e(e){return new Int32Array(e)}function t(e){return new Float32Array(e)}this.xr=n(576),this.l3_enc=r(576),this.scalefac=r(te.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=r(3),this.subblock_gain=r(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=r(te.SFBMAX),this.window=r(te.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=r(4),this.max_nonzero_coeff=0;var a=this;this.assign=function(r){a.xr=t(r.xr),a.l3_enc=e(r.l3_enc),a.scalefac=e(r.scalefac),a.xrpow_max=r.xrpow_max,a.part2_3_length=r.part2_3_length,a.big_values=r.big_values,a.count1=r.count1,a.global_gain=r.global_gain,a.scalefac_compress=r.scalefac_compress,a.block_type=r.block_type,a.mixed_block_flag=r.mixed_block_flag,a.table_select=e(r.table_select),a.subblock_gain=e(r.subblock_gain),a.region0_count=r.region0_count,a.region1_count=r.region1_count,a.preflag=r.preflag,a.scalefac_scale=r.scalefac_scale,a.count1table_select=r.count1table_select,a.part2_length=r.part2_length,a.sfb_lmax=r.sfb_lmax,a.sfb_smin=r.sfb_smin,a.psy_lmax=r.psy_lmax,a.sfbmax=r.sfbmax,a.psymax=r.psymax,a.sfbdivide=r.sfbdivide,a.width=e(r.width),a.window=e(r.window),a.count1bits=r.count1bits,a.sfb_partition_table=r.sfb_partition_table.slice(0),a.slen=e(r.slen),a.max_nonzero_coeff=r.max_nonzero_coeff}}function P(){function e(e,t,r,n){n=0;for(var a=0;r>=a;++a){var i=Math.abs(e.xr[a]);n+=i,t[a]=Math.sqrt(i*Math.sqrt(i)),t[a]>e.xrpow_max&&(e.xrpow_max=t[a])}return n}function t(e,t){var r=e.ATH,n=t.xr;if(t.block_type!=O.SHORT_TYPE)for(var a=!1,i=O.PSFB21-1;i>=0&&!a;i--){var s=e.scalefac_band.psfb21[i],o=e.scalefac_band.psfb21[i+1],l=m.athAdjust(r.adjust,r.psfb21[i],r.floor);e.nsPsy.longfact[21]>1e-12&&(l*=e.nsPsy.longfact[21]);for(var c=o-1;c>=s;c--){if(!(Math.abs(n[c])<l)){a=!0;break}n[c]=0}}else for(var f=0;3>f;f++)for(var a=!1,i=O.PSFB12-1;i>=0&&!a;i--){var s=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*f+(e.scalefac_band.psfb12[i]-e.scalefac_band.psfb12[0]),o=s+(e.scalefac_band.psfb12[i+1]-e.scalefac_band.psfb12[i]),u=m.athAdjust(r.adjust,r.psfb12[i],r.floor);e.nsPsy.shortfact[12]>1e-12&&(u*=e.nsPsy.shortfact[12]);for(var c=o-1;c>=s;c--){if(!(Math.abs(n[c])<u)){a=!0;break}n[c]=0}}}function r(e){this.ordinal=e}function a(e,t,n,a,i){var s,o=e.CurrentStep[a],l=!1,c=e.OldValue[a],f=r.BINSEARCH_NONE;for(t.global_gain=c,n-=t.part2_length;;){var u;if(s=b.count_bits(e,i,t,null),1==o||s==n)break;s>n?(f==r.BINSEARCH_DOWN&&(l=!0),l&&(o/=2),f=r.BINSEARCH_UP,u=o):(f==r.BINSEARCH_UP&&(l=!0),l&&(o/=2),f=r.BINSEARCH_DOWN,u=-o),t.global_gain+=u,t.global_gain<0&&(t.global_gain=0,l=!0),t.global_gain>255&&(t.global_gain=255,l=!0)}for(;s>n&&t.global_gain<255;)t.global_gain++,s=b.count_bits(e,i,t,null);return e.CurrentStep[a]=c-t.global_gain>=4?4:2,e.OldValue[a]=t.global_gain,t.part2_3_length=s,s}function i(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function s(e){return J.FAST_LOG10(.368+.632*e*e*e)}function o(e,t){for(var r=1e-37,n=0;n<t.psymax;n++)r+=s(e[n]);return Math.max(1e-20,r)}function l(e,t,r,n,a){var i;switch(e){default:case 9:t.over_count>0?(i=r.over_SSD<=t.over_SSD,r.over_SSD==t.over_SSD&&(i=r.bits<t.bits)):i=r.max_noise<0&&10*r.max_noise+r.bits<=10*t.max_noise+t.bits;break;case 0:i=r.over_count<t.over_count||r.over_count==t.over_count&&r.over_noise<t.over_noise||r.over_count==t.over_count&&v.EQ(r.over_noise,t.over_noise)&&r.tot_noise<t.tot_noise;break;case 8:r.max_noise=o(a,n);case 1:i=r.max_noise<t.max_noise;break;case 2:i=r.tot_noise<t.tot_noise;break;case 3:i=r.tot_noise<t.tot_noise&&r.max_noise<t.max_noise;break;case 4:i=r.max_noise<=0&&t.max_noise>.2||r.max_noise<=0&&t.max_noise<0&&t.max_noise>r.max_noise-.2&&r.tot_noise<t.tot_noise||r.max_noise<=0&&t.max_noise>0&&t.max_noise>r.max_noise-.2&&r.tot_noise<t.tot_noise+t.over_noise||r.max_noise>0&&t.max_noise>-.05&&t.max_noise>r.max_noise-.1&&r.tot_noise+r.over_noise<t.tot_noise+t.over_noise||r.max_noise>0&&t.max_noise>-.1&&t.max_noise>r.max_noise-.15&&r.tot_noise+r.over_noise+r.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:i=r.over_noise<t.over_noise||v.EQ(r.over_noise,t.over_noise)&&r.tot_noise<t.tot_noise;break;case 6:i=r.over_noise<t.over_noise||v.EQ(r.over_noise,t.over_noise)&&(r.max_noise<t.max_noise||v.EQ(r.max_noise,t.max_noise)&&r.tot_noise<=t.tot_noise);break;case 7:i=r.over_count<t.over_count||r.over_noise<t.over_noise}return 0==t.over_count&&(i=i&&r.bits<t.bits),i}function c(e,t,r,n,a){var i,s=e.internal_flags;i=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var o=0,l=0;l<t.sfbmax;l++)o<r[l]&&(o=r[l]);var c=s.noise_shaping_amp;switch(3==c&&(c=a?2:1),c){case 2:break;case 1:o>1?o=Math.pow(o,.5):o*=.95;break;case 0:default:o>1?o=1:o*=.95}for(var f=0,l=0;l<t.sfbmax;l++){var u,_=t.width[l];if(f+=_,!(r[l]<o)){if(0!=(2&s.substep_shaping)&&(s.pseudohalf[l]=0==s.pseudohalf[l]?1:0,0==s.pseudohalf[l]&&2==s.noise_shaping_amp))return;for(t.scalefac[l]++,u=-_;0>u;u++)n[f+u]*=i,n[f+u]>t.xrpow_max&&(t.xrpow_max=n[f+u]);if(2==s.noise_shaping_amp)return}}}function u(e,t){for(var r=1.2968395546510096,n=0,a=0;a<e.sfbmax;a++){var i=e.width[a],s=e.scalefac[a];if(0!=e.preflag&&(s+=m.pretab[a]),n+=i,0!=(1&s)){s++;for(var o=-i;0>o;o++)t[n+o]*=r,t[n+o]>e.xrpow_max&&(e.xrpow_max=t[n+o])}e.scalefac[a]=s>>1}e.preflag=0,e.scalefac_scale=1}function _(e,t,r){var n,a=t.scalefac;for(n=0;n<t.sfb_lmax;n++)if(a[n]>=16)return!0;for(var i=0;3>i;i++){var s=0,o=0;for(n=t.sfb_lmax+i;n<t.sfbdivide;n+=3)s<a[n]&&(s=a[n]);for(;n<t.sfbmax;n+=3)o<a[n]&&(o=a[n]);if(!(16>s&&8>o)){if(t.subblock_gain[i]>=7)return!0;t.subblock_gain[i]++;var l=e.scalefac_band.l[t.sfb_lmax];for(n=t.sfb_lmax+i;n<t.sfbmax;n+=3){var c,f=t.width[n],u=a[n];if(u-=4>>t.scalefac_scale,u>=0)a[n]=u,l+=3*f;else{a[n]=0;var _=210+(u<<t.scalefac_scale+1);c=m.IPOW20(_),l+=f*(i+1);for(var h=-f;0>h;h++)r[l+h]*=c,r[l+h]>t.xrpow_max&&(t.xrpow_max=r[l+h]);l+=f*(3-i-1)}}var c=m.IPOW20(202);l+=t.width[n]*(i+1);for(var h=-t.width[n];0>h;h++)r[l+h]*=c,r[l+h]>t.xrpow_max&&(t.xrpow_max=r[l+h])}}return!1}function h(e,t,r,n,a){var s=e.internal_flags;c(e,t,r,n,a);var o=i(t);return o?!1:(o=2==s.mode_gr?b.scale_bitcount(t):b.scale_bitcount_lsf(s,t))?(s.noise_shaping>1&&(W.fill(s.pseudohalf,0),0==t.scalefac_scale?(u(t,n),o=!1):t.block_type==O.SHORT_TYPE&&s.subblock_gain>0&&(o=_(s,t,n)||i(t))),o||(o=2==s.mode_gr?b.scale_bitcount(t):b.scale_bitcount_lsf(s,t)),!o):!0}var d;this.rv=null;var p;this.qupvt=null;var m,b,g=new y;this.setModules=function(e,t,r,n){d=e,p=t,this.rv=t,m=r,this.qupvt=r,b=n,g.setModules(m,b)},this.ms_convert=function(e,t){for(var r=0;576>r;++r){var n=e.tt[t][0].xr[r],a=e.tt[t][1].xr[r];e.tt[t][0].xr[r]=(n+a)*(.5*J.SQRT2),e.tt[t][1].xr[r]=(n-a)*(.5*J.SQRT2)}},this.init_xrpow=function(t,r,n){var a=0,i=0|r.max_nonzero_coeff;if(r.xrpow_max=0,W.fill(n,i,576,0),a=e(r,n,i,a),a>1e-20){var s=0;0!=(2&t.substep_shaping)&&(s=1);for(var o=0;o<r.psymax;o++)t.pseudohalf[o]=s;return!0}return W.fill(r.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,r){r.part2_3_length=0,r.big_values=0,r.count1=0,r.global_gain=210,r.scalefac_compress=0,r.table_select[0]=0,r.table_select[1]=0,r.table_select[2]=0,r.subblock_gain[0]=0,r.subblock_gain[1]=0,r.subblock_gain[2]=0,r.subblock_gain[3]=0,r.region0_count=0,r.region1_count=0,r.preflag=0,r.scalefac_scale=0,r.count1table_select=0,r.part2_length=0,r.sfb_lmax=O.SBPSY_l,r.sfb_smin=O.SBPSY_s,r.psy_lmax=e.sfb21_extra?O.SBMAX_l:O.SBPSY_l,r.psymax=r.psy_lmax,r.sfbmax=r.sfb_lmax,r.sfbdivide=11;for(var a=0;a<O.SBMAX_l;a++)r.width[a]=e.scalefac_band.l[a+1]-e.scalefac_band.l[a],r.window[a]=3;if(r.block_type==O.SHORT_TYPE){var i=n(576);r.sfb_smin=0,r.sfb_lmax=0,0!=r.mixed_block_flag&&(r.sfb_smin=3,r.sfb_lmax=2*e.mode_gr+4),r.psymax=r.sfb_lmax+3*((e.sfb21_extra?O.SBMAX_s:O.SBPSY_s)-r.sfb_smin),r.sfbmax=r.sfb_lmax+3*(O.SBPSY_s-r.sfb_smin),r.sfbdivide=r.sfbmax-18,r.psy_lmax=r.sfb_lmax;var s=e.scalefac_band.l[r.sfb_lmax];Q.arraycopy(r.xr,0,i,0,576);for(var a=r.sfb_smin;a<O.SBMAX_s;a++)for(var o=e.scalefac_band.s[a],l=e.scalefac_band.s[a+1],c=0;3>c;c++)for(var f=o;l>f;f++)r.xr[s++]=i[3*f+c];for(var u=r.sfb_lmax,a=r.sfb_smin;a<O.SBMAX_s;a++)r.width[u]=r.width[u+1]=r.width[u+2]=e.scalefac_band.s[a+1]-e.scalefac_band.s[a],r.window[u]=0,r.window[u+1]=1,r.window[u+2]=2,u+=3}r.count1bits=0,r.sfb_partition_table=m.nr_of_sfb_block[0][0],r.slen[0]=0,r.slen[1]=0,r.slen[2]=0,r.slen[3]=0,r.max_nonzero_coeff=575,W.fill(r.scalefac,0),t(e,r)},r.BINSEARCH_NONE=new r(0),r.BINSEARCH_UP=new r(1),r.BINSEARCH_DOWN=new r(2),this.trancate_smallspectrums=function(e,t,r,a){var i=n(te.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=O.SHORT_TYPE)&&0==(128&e.substep_shaping)){m.calc_noise(t,r,i,new R,null);for(var s=0;576>s;s++){var o=0;0!=t.l3_enc[s]&&(o=Math.abs(t.xr[s])),a[s]=o}var s=0,l=8;t.block_type==O.SHORT_TYPE&&(l=6);do{var c,f,u,_,h=t.width[l];if(s+=h,!(i[l]>=1||(W.sort(a,s-h,h),v.EQ(a[s-1],0)))){c=(1-i[l])*r[l],f=0,_=0;do{var d;for(u=1;h>_+u&&!v.NEQ(a[_+s-h],a[_+s+u-h]);u++);if(d=a[_+s-h]*a[_+s-h]*u,d>c){0!=_&&(f=a[_+s-h-1]);break}c-=d,_+=u}while(h>_);if(!v.EQ(f,0))do Math.abs(t.xr[s-h])<=f&&(t.l3_enc[s-h]=0);while(--h>0)}}while(++l<t.psymax);t.part2_3_length=b.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,r,i,s,o){var c,u=e.internal_flags,_=new x,d=n(576),p=n(te.SFBMAX),v=new R,g=new k,w=9999999,y=!1,S=!1,A=0;if(a(u,t,o,s,i),0==u.noise_shaping)return 100;m.calc_noise(t,r,p,v,g),v.bits=t.part2_3_length,_.assign(t);var T=0;for(Q.arraycopy(i,0,d,0,576);!y;){do{var E,M=new R,B=255;if(E=0!=(2&u.substep_shaping)?20:3,u.sfb21_extra){if(p[_.sfbmax]>1)break;if(_.block_type==O.SHORT_TYPE&&(p[_.sfbmax+1]>1||p[_.sfbmax+2]>1))break}if(!h(e,_,p,i,S))break;0!=_.scalefac_scale&&(B=254);var P=o-_.part2_length;if(0>=P)break;for(;(_.part2_3_length=b.count_bits(u,i,_,g))>P&&_.global_gain<=B;)_.global_gain++;if(_.global_gain>B)break;if(0==v.over_count){for(;(_.part2_3_length=b.count_bits(u,i,_,g))>w&&_.global_gain<=B;)_.global_gain++;if(_.global_gain>B)break}if(m.calc_noise(_,r,p,M,g),M.bits=_.part2_3_length,c=t.block_type!=O.SHORT_TYPE?e.quant_comp:e.quant_comp_short,c=l(c,v,M,_,p)?1:0,0!=c)w=t.part2_3_length,v=M,t.assign(_),T=0,Q.arraycopy(i,0,d,0,576);else if(0==u.full_outer_loop){if(++T>E&&0==v.over_count)break;if(3==u.noise_shaping_amp&&S&&T>30)break;if(3==u.noise_shaping_amp&&S&&_.global_gain-A>15)break}}while(_.global_gain+_.scalefac_scale<255);3==u.noise_shaping_amp?S?y=!0:(_.assign(t),Q.arraycopy(d,0,i,0,576),T=0,A=_.global_gain,S=!0):y=!0}return e.VBR==f.vbr_rh||e.VBR==f.vbr_mtrh?Q.arraycopy(d,0,i,0,576):0!=(1&u.substep_shaping)&&trancate_smallspectrums(u,t,r,i),v.over_count},this.iteration_finish_one=function(e,t,r){var n=e.l3_side,a=n.tt[t][r];b.best_scalefac_store(e,t,r,n),1==e.use_best_huffman&&b.best_huffman_divide(e,a),p.ResvAdjust(e,a)},this.VBR_encode_granule=function(e,t,r,a,i,s,o){var l,c,f=e.internal_flags,u=new x,_=n(576),h=o,d=o+1,p=(o+s)/2,m=0,v=f.sfb21_extra;W.fill(u.l3_enc,0);do p>h-42?f.sfb21_extra=!1:f.sfb21_extra=v,c=outer_loop(e,t,r,a,i,p),0>=c?(m=1,d=t.part2_3_length,u.assign(t),Q.arraycopy(a,0,_,0,576),o=d-32,l=o-s,p=(o+s)/2):(s=p+32,l=o-s,p=(o+s)/2,0!=m&&(m=2,t.assign(u),Q.arraycopy(_,0,a,0,576)));while(l>12);f.sfb21_extra=v,2==m&&Q.arraycopy(u.l3_enc,0,t.l3_enc,0,576)},this.get_framebits=function(e,t){var r=e.internal_flags;r.bitrate_index=r.VBR_min_bitrate;var n=d.getframebits(e);r.bitrate_index=1,n=d.getframebits(e);for(var a=1;a<=r.VBR_max_bitrate;a++){r.bitrate_index=a;var i=new w(n);t[a]=p.ResvFrameBegin(e,i),n=i.bits}},this.VBR_old_prepare=function(e,t,r,n,a,i,s,o,l){var c,f=e.internal_flags,u=0,_=1,h=0;f.bitrate_index=f.VBR_max_bitrate;var d=p.ResvFrameBegin(e,new w(0))/f.mode_gr;get_framebits(e,i);for(var v=0;v<f.mode_gr;v++){var b=m.on_pe(e,t,o[v],d,v,0);f.mode_ext==O.MPG_MD_MS_LR&&(ms_convert(f.l3_side,v),m.reduce_side(o[v],r[v],d,b));for(var g=0;g<f.channels_out;++g){var y=f.l3_side.tt[v][g];y.block_type!=O.SHORT_TYPE?(u=1.28/(1+Math.exp(3.5-t[v][g]/300))-.05,c=f.PSY.mask_adjust-u):(u=2.56/(1+Math.exp(3.5-t[v][g]/300))-.14,c=f.PSY.mask_adjust_short-u),f.masking_lower=Math.pow(10,.1*c),init_outer_loop(f,y),l[v][g]=m.calc_xmin(e,n[v][g],y,a[v][g]),0!=l[v][g]&&(_=0),s[v][g]=126,h+=o[v][g]}}for(var v=0;v<f.mode_gr;v++)for(var g=0;g<f.channels_out;g++)h>i[f.VBR_max_bitrate]&&(o[v][g]*=i[f.VBR_max_bitrate],o[v][g]/=h),s[v][g]>o[v][g]&&(s[v][g]=o[v][g]);return _},this.bitpressure_strategy=function(e,t,r,n){for(var a=0;a<e.mode_gr;a++)for(var i=0;i<e.channels_out;i++){for(var s=e.l3_side.tt[a][i],o=t[a][i],l=0,c=0;c<s.psy_lmax;c++)o[l++]*=1+.029*c*c/O.SBMAX_l/O.SBMAX_l;if(s.block_type==O.SHORT_TYPE)for(var c=s.sfb_smin;c<O.SBMAX_s;c++)o[l++]*=1+.029*c*c/O.SBMAX_s/O.SBMAX_s,o[l++]*=1+.029*c*c/O.SBMAX_s/O.SBMAX_s,o[l++]*=1+.029*c*c/O.SBMAX_s/O.SBMAX_s;n[a][i]=0|Math.max(r[a][i],.9*n[a][i])}},this.VBR_new_prepare=function(e,t,r,n,a,i){var s,o=e.internal_flags,l=1,c=0,f=0;if(e.free_format){o.bitrate_index=0;var u=new w(c);s=p.ResvFrameBegin(e,u),c=u.bits,a[0]=s}else{o.bitrate_index=o.VBR_max_bitrate;var u=new w(c);p.ResvFrameBegin(e,u),c=u.bits,get_framebits(e,a),s=a[o.VBR_max_bitrate]}for(var _=0;_<o.mode_gr;_++){m.on_pe(e,t,i[_],c,_,0),o.mode_ext==O.MPG_MD_MS_LR&&ms_convert(o.l3_side,_);for(var h=0;h<o.channels_out;++h){var d=o.l3_side.tt[_][h];o.masking_lower=Math.pow(10,.1*o.PSY.mask_adjust),init_outer_loop(o,d),0!=m.calc_xmin(e,r[_][h],d,n[_][h])&&(l=0),f+=i[_][h]}}for(var _=0;_<o.mode_gr;_++)for(var h=0;h<o.channels_out;h++)f>s&&(i[_][h]*=s,i[_][h]/=f);return l},this.calc_target_bits=function(e,t,r,n,a,i){var s,o,l,c,f=e.internal_flags,u=f.l3_side,_=0;f.bitrate_index=f.VBR_max_bitrate;var h=new w(_);for(i[0]=p.ResvFrameBegin(e,h),_=h.bits,f.bitrate_index=1,_=d.getframebits(e)-8*f.sideinfo_len,a[0]=_/(f.mode_gr*f.channels_out),_=e.VBR_mean_bitrate_kbps*e.framesize*1e3,0!=(1&f.substep_shaping)&&(_*=1.09),_/=e.out_samplerate,_-=8*f.sideinfo_len,_/=f.mode_gr*f.channels_out,s=.93+.07*(11-e.compression_ratio)/5.5,.9>s&&(s=.9),s>1&&(s=1),o=0;o<f.mode_gr;o++){var v=0;for(l=0;l<f.channels_out;l++){if(n[o][l]=int(s*_),t[o][l]>700){var b=int((t[o][l]-700)/1.4),g=u.tt[o][l];n[o][l]=int(s*_),g.block_type==O.SHORT_TYPE&&_/2>b&&(b=_/2),b>3*_/2?b=3*_/2:0>b&&(b=0),n[o][l]+=b}n[o][l]>H.MAX_BITS_PER_CHANNEL&&(n[o][l]=H.MAX_BITS_PER_CHANNEL),v+=n[o][l]}if(v>H.MAX_BITS_PER_GRANULE)for(l=0;l<f.channels_out;++l)n[o][l]*=H.MAX_BITS_PER_GRANULE,n[o][l]/=v}if(f.mode_ext==O.MPG_MD_MS_LR)for(o=0;o<f.mode_gr;o++)m.reduce_side(n[o],r[o],_*f.channels_out,H.MAX_BITS_PER_GRANULE);for(c=0,o=0;o<f.mode_gr;o++)for(l=0;l<f.channels_out;l++)n[o][l]>H.MAX_BITS_PER_CHANNEL&&(n[o][l]=H.MAX_BITS_PER_CHANNEL),c+=n[o][l];if(c>i[0])for(o=0;o<f.mode_gr;o++)for(l=0;l<f.channels_out;l++)n[o][l]*=i[0],n[o][l]/=c}}function I(){this.thm=new V,this.en=new V}function L(){function e(e,t,r){for(var n=10,i=t+238-14-286,s=-15;0>s;s++){var o,l,c;o=a[n+-10],l=e[i+-224]*o,c=e[t+224]*o,o=a[n+-9],l+=e[i+-160]*o,c+=e[t+160]*o,o=a[n+-8],l+=e[i+-96]*o,c+=e[t+96]*o,o=a[n+-7],l+=e[i+-32]*o,c+=e[t+32]*o,o=a[n+-6],l+=e[i+32]*o,c+=e[t+-32]*o,o=a[n+-5],l+=e[i+96]*o,c+=e[t+-96]*o,o=a[n+-4],l+=e[i+160]*o,c+=e[t+-160]*o,o=a[n+-3],l+=e[i+224]*o,c+=e[t+-224]*o,o=a[n+-2],l+=e[t+-256]*o,c-=e[i+256]*o,o=a[n+-1],l+=e[t+-192]*o,c-=e[i+192]*o,o=a[n+0],l+=e[t+-128]*o,c-=e[i+128]*o,o=a[n+1],l+=e[t+-64]*o,c-=e[i+64]*o,o=a[n+2],l+=e[t+0]*o,c-=e[i+0]*o,o=a[n+3],l+=e[t+64]*o,c-=e[i+-64]*o,o=a[n+4],l+=e[t+128]*o,c-=e[i+-128]*o,o=a[n+5],l+=e[t+192]*o,c-=e[i+-192]*o,l*=a[n+6],o=c-l,r[30+2*s]=c+l,r[31+2*s]=a[n+7]*o,n+=18,t--,i++}var l,c,f,u;c=e[t+-16]*a[n+-10],l=e[t+-32]*a[n+-2],c+=(e[t+-48]-e[t+16])*a[n+-9],l+=e[t+-96]*a[n+-1],c+=(e[t+-80]+e[t+48])*a[n+-8],l+=e[t+-160]*a[n+0],c+=(e[t+-112]-e[t+80])*a[n+-7],l+=e[t+-224]*a[n+1],c+=(e[t+-144]+e[t+112])*a[n+-6],l-=e[t+32]*a[n+2],c+=(e[t+-176]-e[t+144])*a[n+-5],l-=e[t+96]*a[n+3],c+=(e[t+-208]+e[t+176])*a[n+-4],l-=e[t+160]*a[n+4],c+=(e[t+-240]-e[t+208])*a[n+-3],l-=e[t+224],f=l-c,u=l+c,c=r[14],l=r[15]-c,r[31]=u+c,r[30]=f+l,r[15]=f-l,r[14]=u-c;var _;_=r[28]-r[0],r[0]+=r[28],r[28]=_*a[n+-36+7],_=r[29]-r[1],r[1]+=r[29],r[29]=_*a[n+-36+7],_=r[26]-r[2],r[2]+=r[26],r[26]=_*a[n+-72+7],_=r[27]-r[3],r[3]+=r[27],r[27]=_*a[n+-72+7],_=r[24]-r[4],r[4]+=r[24],r[24]=_*a[n+-108+7],_=r[25]-r[5],r[5]+=r[25],r[25]=_*a[n+-108+7],_=r[22]-r[6],r[6]+=r[22],r[22]=_*J.SQRT2,_=r[23]-r[7],r[7]+=r[23],r[23]=_*J.SQRT2-r[7],r[7]-=r[6],r[22]-=r[7],r[23]-=r[22],_=r[6],r[6]=r[31]-_,r[31]=r[31]+_,_=r[7],r[7]=r[30]-_,r[30]=r[30]+_,_=r[22],r[22]=r[15]-_,r[15]=r[15]+_,_=r[23],r[23]=r[14]-_,r[14]=r[14]+_,_=r[20]-r[8],r[8]+=r[20],r[20]=_*a[n+-180+7],_=r[21]-r[9],r[9]+=r[21],r[21]=_*a[n+-180+7],_=r[18]-r[10],r[10]+=r[18],r[18]=_*a[n+-216+7],_=r[19]-r[11],r[11]+=r[19],r[19]=_*a[n+-216+7],_=r[16]-r[12],r[12]+=r[16],r[16]=_*a[n+-252+7],_=r[17]-r[13],r[13]+=r[17],r[17]=_*a[n+-252+7],_=-r[20]+r[24],r[20]+=r[24],r[24]=_*a[n+-216+7],_=-r[21]+r[25],r[21]+=r[25],r[25]=_*a[n+-216+7],_=r[4]-r[8],r[4]+=r[8],r[8]=_*a[n+-216+7],_=r[5]-r[9],r[5]+=r[9],r[9]=_*a[n+-216+7],_=r[0]-r[12],r[0]+=r[12],r[12]=_*a[n+-72+7],_=r[1]-r[13],r[1]+=r[13],r[13]=_*a[n+-72+7],_=r[16]-r[28],r[16]+=r[28],r[28]=_*a[n+-72+7],_=-r[17]+r[29],r[17]+=r[29],r[29]=_*a[n+-72+7],_=J.SQRT2*(r[2]-r[10]),r[2]+=r[10],r[10]=_,_=J.SQRT2*(r[3]-r[11]),r[3]+=r[11],r[11]=_,_=J.SQRT2*(-r[18]+r[26]),r[18]+=r[26],r[26]=_-r[18],_=J.SQRT2*(-r[19]+r[27]),r[19]+=r[27],r[27]=_-r[19],_=r[2],r[19]-=r[3],r[3]-=_,r[2]=r[31]-_,r[31]+=_,_=r[3],r[11]-=r[19],r[18]-=_,r[3]=r[30]-_,r[30]+=_,_=r[18],r[27]-=r[11],r[19]-=_,r[18]=r[15]-_,r[15]+=_,_=r[19],r[10]-=_,r[19]=r[14]-_,r[14]+=_,_=r[10],r[11]-=_,r[10]=r[23]-_,r[23]+=_,_=r[11],r[26]-=_,r[11]=r[22]-_,r[22]+=_,_=r[26],r[27]-=_,r[26]=r[7]-_,r[7]+=_,_=r[27],r[27]=r[6]-_,r[6]+=_,_=J.SQRT2*(r[0]-r[4]),r[0]+=r[4],r[4]=_,_=J.SQRT2*(r[1]-r[5]),r[1]+=r[5],r[5]=_,_=J.SQRT2*(r[16]-r[20]),r[16]+=r[20],r[20]=_,_=J.SQRT2*(r[17]-r[21]),r[17]+=r[21],r[21]=_,_=-J.SQRT2*(r[8]-r[12]),r[8]+=r[12],r[12]=_-r[8],_=-J.SQRT2*(r[9]-r[13]),r[9]+=r[13],r[13]=_-r[9],_=-J.SQRT2*(r[25]-r[29]),r[25]+=r[29],r[29]=_-r[25],_=-J.SQRT2*(r[24]+r[28]),r[24]-=r[28],r[28]=_-r[24],_=r[24]-r[16],r[24]=_,_=r[20]-_,r[20]=_,_=r[28]-_,r[28]=_,_=r[25]-r[17],r[25]=_,_=r[21]-_,r[21]=_,_=r[29]-_,r[29]=_,_=r[17]-r[1],r[17]=_,_=r[9]-_,r[9]=_,_=r[25]-_,r[25]=_,_=r[5]-_,r[5]=_,_=r[21]-_,r[21]=_,_=r[13]-_,r[13]=_,_=r[29]-_,r[29]=_,_=r[1]-r[0],r[1]=_,_=r[16]-_,r[16]=_,_=r[17]-_,r[17]=_,_=r[8]-_,r[8]=_,_=r[9]-_,r[9]=_,_=r[24]-_,r[24]=_,_=r[25]-_,r[25]=_,_=r[4]-_,r[4]=_,_=r[5]-_,r[5]=_,_=r[20]-_,r[20]=_,_=r[21]-_,r[21]=_,_=r[12]-_,r[12]=_,_=r[13]-_,r[13]=_,_=r[28]-_,r[28]=_,_=r[29]-_,r[29]=_,_=r[0],r[0]+=r[31],r[31]-=_,_=r[1],r[1]+=r[30],r[30]-=_,_=r[16],r[16]+=r[15],r[15]-=_,_=r[17],r[17]+=r[14],r[14]-=_,_=r[8],r[8]+=r[23],r[23]-=_,_=r[9],r[9]+=r[22],r[22]-=_,_=r[24],r[24]+=r[7],r[7]-=_,_=r[25],r[25]+=r[6],r[6]-=_,_=r[4],r[4]+=r[27],r[27]-=_,_=r[5],r[5]+=r[26],r[26]-=_,_=r[20],r[20]+=r[11],r[11]-=_,_=r[21],r[21]+=r[10],r[10]-=_,_=r[12],r[12]+=r[19],r[19]-=_,_=r[13],r[13]+=r[18],r[18]-=_,_=r[28],r[28]+=r[3],r[3]-=_,_=r[29],r[29]+=r[2],r[2]-=_}function t(e,t){for(var r=0;3>r;r++){var n,a,i,s,l,c;s=e[t+6]*o[O.SHORT_TYPE][0]-e[t+15],n=e[t+0]*o[O.SHORT_TYPE][2]-e[t+9],a=s+n,i=s-n,s=e[t+15]*o[O.SHORT_TYPE][0]+e[t+6],n=e[t+9]*o[O.SHORT_TYPE][2]+e[t+0],l=s+n,c=-s+n,n=2.069978111953089e-11*(e[t+3]*o[O.SHORT_TYPE][1]-e[t+12]),s=2.069978111953089e-11*(e[t+12]*o[O.SHORT_TYPE][1]+e[t+3]),e[t+0]=1.90752519173728e-11*a+n,e[t+15]=1.90752519173728e-11*-l+s,i=.8660254037844387*i*1.907525191737281e-11,l=.5*l*1.907525191737281e-11+s,e[t+3]=i-l,e[t+6]=i+l,a=.5*a*1.907525191737281e-11-n,c=.8660254037844387*c*1.907525191737281e-11,
e[t+9]=a+c,e[t+12]=a-c,t++}}function r(e,t,r){var n,a,i,s,o,l,f,u,_,h;i=r[17]-r[9],o=r[15]-r[11],l=r[14]-r[12],f=r[0]+r[8],u=r[1]+r[7],_=r[2]+r[6],h=r[3]+r[5],e[t+17]=f+_-h-(u-r[4]),a=(f+_-h)*c[19]+(u-r[4]),n=(i-o-l)*c[18],e[t+5]=n+a,e[t+6]=n-a,s=(r[16]-r[10])*c[18],u=u*c[19]+r[4],n=i*c[12]+s+o*c[13]+l*c[14],a=-f*c[16]+u-_*c[17]+h*c[15],e[t+1]=n+a,e[t+2]=n-a,n=i*c[13]-s-o*c[14]+l*c[12],a=-f*c[17]+u-_*c[15]+h*c[16],e[t+9]=n+a,e[t+10]=n-a,n=i*c[14]-s+o*c[12]-l*c[13],a=f*c[15]-u+_*c[16]-h*c[17],e[t+13]=n+a,e[t+14]=n-a;var d,p,m,v,b,g,w,y;d=r[8]-r[0],m=r[6]-r[2],v=r[5]-r[3],b=r[17]+r[9],g=r[16]+r[10],w=r[15]+r[11],y=r[14]+r[12],e[t+0]=b+w+y+(g+r[13]),n=(b+w+y)*c[19]-(g+r[13]),a=(d-m+v)*c[18],e[t+11]=n+a,e[t+12]=n-a,p=(r[7]-r[1])*c[18],g=r[13]-g*c[19],n=b*c[15]-g+w*c[16]+y*c[17],a=d*c[14]+p+m*c[12]+v*c[13],e[t+3]=n+a,e[t+4]=n-a,n=-b*c[17]+g-w*c[15]-y*c[16],a=d*c[13]+p-m*c[14]-v*c[12],e[t+7]=n+a,e[t+8]=n-a,n=-b*c[16]+g-w*c[17]-y*c[15],a=d*c[12]-p+m*c[13]-v*c[14],e[t+15]=n+a,e[t+16]=n-a}var a=[-0.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-0.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-0.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-0.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-0.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-0.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-0.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-0.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-0.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-0.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-0.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-0.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-0.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-0.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-0.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*J.SQRT2*.5/2384e-9,.017876148*J.SQRT2*.5/2384e-9,.003134727*J.SQRT2*.5/2384e-9,.002457142*J.SQRT2*.5/2384e-9,971317e-9*J.SQRT2*.5/2384e-9,218868e-9*J.SQRT2*.5/2384e-9,101566e-9*J.SQRT2*.5/2384e-9,13828e-9*J.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,49591e-9/2384e-9,1995.1556208053692,21458e-9/2384e-9,-69618e-9/2384e-9],i=12,s=36,o=[[2.382191739347913e-13,6.423305872147834e-13,9.400849094049688e-13,1.122435026096556e-12,1.183840321267481e-12,1.122435026096556e-12,9.40084909404969e-13,6.423305872147839e-13,2.382191739347918e-13,5.456116108943412e-12,4.878985199565852e-12,4.240448995017367e-12,3.559909094758252e-12,2.858043359288075e-12,2.156177623817898e-12,1.475637723558783e-12,8.371015190102974e-13,2.599706096327376e-13,-5.456116108943412e-12,-4.878985199565852e-12,-4.240448995017367e-12,-3.559909094758252e-12,-2.858043359288076e-12,-2.156177623817898e-12,-1.475637723558783e-12,-8.371015190102975e-13,-2.599706096327376e-13,-2.382191739347923e-13,-6.423305872147843e-13,-9.400849094049696e-13,-1.122435026096556e-12,-1.183840321267481e-12,-1.122435026096556e-12,-9.400849094049694e-13,-6.42330587214784e-13,-2.382191739347918e-13],[2.382191739347913e-13,6.423305872147834e-13,9.400849094049688e-13,1.122435026096556e-12,1.183840321267481e-12,1.122435026096556e-12,9.400849094049688e-13,6.423305872147841e-13,2.382191739347918e-13,5.456116108943413e-12,4.878985199565852e-12,4.240448995017367e-12,3.559909094758253e-12,2.858043359288075e-12,2.156177623817898e-12,1.475637723558782e-12,8.371015190102975e-13,2.599706096327376e-13,-5.461314069809755e-12,-4.921085770524055e-12,-4.343405037091838e-12,-3.732668368707687e-12,-3.093523840190885e-12,-2.430835727329465e-12,-1.734679010007751e-12,-9.74825365660928e-13,-2.797435120168326e-13,0,0,0,0,0,0,-2.283748241799531e-13,-4.037858874020686e-13,-2.146547464825323e-13],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2.283748241799531e-13,4.037858874020686e-13,2.146547464825323e-13,5.461314069809755e-12,4.921085770524055e-12,4.343405037091838e-12,3.732668368707687e-12,3.093523840190885e-12,2.430835727329466e-12,1.734679010007751e-12,9.74825365660928e-13,2.797435120168326e-13,-5.456116108943413e-12,-4.878985199565852e-12,-4.240448995017367e-12,-3.559909094758253e-12,-2.858043359288075e-12,-2.156177623817898e-12,-1.475637723558782e-12,-8.371015190102975e-13,-2.599706096327376e-13,-2.382191739347913e-13,-6.423305872147834e-13,-9.400849094049688e-13,-1.122435026096556e-12,-1.183840321267481e-12,-1.122435026096556e-12,-9.400849094049688e-13,-6.423305872147841e-13,-2.382191739347918e-13]],l=o[O.SHORT_TYPE],c=o[O.SHORT_TYPE],f=o[O.SHORT_TYPE],u=o[O.SHORT_TYPE],_=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];this.mdct_sub48=function(a,c,h){for(var d=c,p=286,m=0;m<a.channels_out;m++){for(var v=0;v<a.mode_gr;v++){for(var b,g=a.l3_side.tt[v][m],w=g.xr,y=0,R=a.sb_sample[m][1-v],S=0,A=0;9>A;A++)for(e(d,p,R[S]),e(d,p+32,R[S+1]),S+=2,p+=64,b=1;32>b;b+=2)R[S-1][b]*=-1;for(b=0;32>b;b++,y+=18){var T=g.block_type,E=a.sb_sample[m][v],M=a.sb_sample[m][1-v];if(0!=g.mixed_block_flag&&2>b&&(T=0),a.amp_filter[b]<1e-12)W.fill(w,y+0,y+18,0);else{if(a.amp_filter[b]<1)for(var A=0;18>A;A++)M[A][_[b]]*=a.amp_filter[b];if(T==O.SHORT_TYPE){for(var A=-i/4;0>A;A++){var B=o[O.SHORT_TYPE][A+3];w[y+3*A+9]=E[9+A][_[b]]*B-E[8-A][_[b]],w[y+3*A+18]=E[14-A][_[b]]*B+E[15+A][_[b]],w[y+3*A+10]=E[15+A][_[b]]*B-E[14-A][_[b]],w[y+3*A+19]=M[2-A][_[b]]*B+M[3+A][_[b]],w[y+3*A+11]=M[3+A][_[b]]*B-M[2-A][_[b]],w[y+3*A+20]=M[8-A][_[b]]*B+M[9+A][_[b]]}t(w,y)}else{for(var k=n(18),A=-s/4;0>A;A++){var x,P;x=o[T][A+27]*M[A+9][_[b]]+o[T][A+36]*M[8-A][_[b]],P=o[T][A+9]*E[A+9][_[b]]-o[T][A+18]*E[8-A][_[b]],k[A+9]=x-P*l[3+A+9],k[A+18]=x*l[3+A+9]+P}r(w,y,k)}}if(T!=O.SHORT_TYPE&&0!=b)for(var A=7;A>=0;--A){var I,L;I=w[y+A]*f[20+A]+w[y+-1-A]*u[28+A],L=w[y+A]*u[28+A]-w[y+-1-A]*f[20+A],w[y+-1-A]=I,w[y+A]=L}}}if(d=h,p=286,1==a.mode_gr)for(var C=0;18>C;C++)Q.arraycopy(a.sb_sample[m][1][C],0,a.sb_sample[m][0][C],0,32)}}}function O(){function e(e){var t,r;if(0==e.ATH.useAdjust)return void(e.ATH.adjust=1);if(r=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?(r+=e.loudness_sq[0][1],t+=e.loudness_sq[1][1]):(r+=r,t+=t),2==e.mode_gr&&(r=Math.max(r,t)),r*=.5,r*=e.ATH.aaSensitivityP,r>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var n=31.98*r+625e-6;e.ATH.adjust>=n?(e.ATH.adjust*=.075*n+.925,e.ATH.adjust<n&&(e.ATH.adjust=n)):e.ATH.adjustLimit>=n?e.ATH.adjust=n:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=n}}function t(e){var t,r;for(e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),t=0;t<e.mode_gr;++t)for(r=0;r<e.channels_out;++r){var n=0|e.l3_side.tt[t][r].block_type;0!=e.l3_side.tt[t][r].mixed_block_flag&&(n=4),e.bitrate_blockType_Hist[e.bitrate_index][n]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][n]++,e.bitrate_blockType_Hist[15][5]++}}function a(e,t){var r,a,i=e.internal_flags;if(0==i.lame_encode_frame_init){var s,o,l=n(2014),c=n(2014);for(i.lame_encode_frame_init=1,s=0,o=0;s<286+576*(1+i.mode_gr);++s)s<576*i.mode_gr?(l[s]=0,2==i.channels_out&&(c[s]=0)):(l[s]=t[0][o],2==i.channels_out&&(c[s]=t[1][o]),++o);for(a=0;a<i.mode_gr;a++)for(r=0;r<i.channels_out;r++)i.l3_side.tt[a][r].block_type=O.SHORT_TYPE;p.mdct_sub48(i,l,c)}}var s=O.FFTOFFSET,o=O.MPG_MD_MS_LR,c=null;this.psy=null;var _=null,h=null,d=null;this.setModules=function(e,t,r,n){c=e,this.psy=t,_=t,h=n,d=r};var p=new L;this.lame_encode_mp3_frame=function(n,m,v,b,g,w){var y,R=l([2,2]);R[0][0]=new I,R[0][1]=new I,R[1][0]=new I,R[1][1]=new I;var S=l([2,2]);S[0][0]=new I,S[0][1]=new I,S[1][0]=new I,S[1][1]=new I;var A,T,E,M,B=[null,null],k=n.internal_flags,x=i([2,4]),P=[.5,.5],L=[[0,0],[0,0]],C=[[0,0],[0,0]];if(B[0]=m,B[1]=v,0==k.lame_encode_frame_init&&a(n,B),k.padding=0,(k.slot_lag-=k.frac_SpF)<0&&(k.slot_lag+=n.out_samplerate,k.padding=1),0!=k.psymodel){var D,N=[null,null],V=0,H=r(2);for(M=0;M<k.mode_gr;M++){for(E=0;E<k.channels_out;E++)N[E]=B[E],V=576+576*M-O.FFTOFFSET;if(D=n.VBR==f.vbr_mtrh||n.VBR==f.vbr_mt?_.L3psycho_anal_vbr(n,N,V,M,R,S,L[M],C[M],x[M],H):_.L3psycho_anal_ns(n,N,V,M,R,S,L[M],C[M],x[M],H),0!=D)return-4;for(n.mode==u.JOINT_STEREO&&(P[M]=x[M][2]+x[M][3],P[M]>0&&(P[M]=x[M][3]/P[M])),E=0;E<k.channels_out;E++){var U=k.l3_side.tt[M][E];U.block_type=H[E],U.mixed_block_flag=0}}}else for(M=0;M<k.mode_gr;M++)for(E=0;E<k.channels_out;E++)k.l3_side.tt[M][E].block_type=O.NORM_TYPE,k.l3_side.tt[M][E].mixed_block_flag=0,C[M][E]=L[M][E]=700;if(e(k),p.mdct_sub48(k,B[0],B[1]),k.mode_ext=O.MPG_MD_LR_LR,n.force_ms)k.mode_ext=O.MPG_MD_MS_LR;else if(n.mode==u.JOINT_STEREO){var j=0,Y=0;for(M=0;M<k.mode_gr;M++)for(E=0;E<k.channels_out;E++)j+=C[M][E],Y+=L[M][E];if(1*Y>=j){var F=k.l3_side.tt[0],X=k.l3_side.tt[k.mode_gr-1];F[0].block_type==F[1].block_type&&X[0].block_type==X[1].block_type&&(k.mode_ext=O.MPG_MD_MS_LR)}}if(k.mode_ext==o?(A=S,T=C):(A=R,T=L),n.analysis&&null!=k.pinfo)for(M=0;M<k.mode_gr;M++)for(E=0;E<k.channels_out;E++)k.pinfo.ms_ratio[M]=k.ms_ratio[M],k.pinfo.ms_ener_ratio[M]=P[M],k.pinfo.blocktype[M][E]=k.l3_side.tt[M][E].block_type,k.pinfo.pe[M][E]=T[M][E],Q.arraycopy(k.l3_side.tt[M][E].xr,0,k.pinfo.xr[M][E],0,576),k.mode_ext==o&&(k.pinfo.ers[M][E]=k.pinfo.ers[M][E+2],Q.arraycopy(k.pinfo.energy[M][E+2],0,k.pinfo.energy[M][E],0,k.pinfo.energy[M][E].length));if(n.VBR==f.vbr_off||n.VBR==f.vbr_abr){var q,z;for(q=0;18>q;q++)k.nsPsy.pefirbuf[q]=k.nsPsy.pefirbuf[q+1];for(z=0,M=0;M<k.mode_gr;M++)for(E=0;E<k.channels_out;E++)z+=T[M][E];for(k.nsPsy.pefirbuf[18]=z,z=k.nsPsy.pefirbuf[9],q=0;9>q;q++)z+=(k.nsPsy.pefirbuf[q]+k.nsPsy.pefirbuf[18-q])*O.fircoef[q];for(z=3350*k.mode_gr*k.channels_out/z,M=0;M<k.mode_gr;M++)for(E=0;E<k.channels_out;E++)T[M][E]*=z}if(k.iteration_loop.iteration_loop(n,T,P,A),c.format_bitstream(n),y=c.copy_buffer(k,b,g,w,1),n.bWriteVbrTag&&h.addVbrFrame(n),n.analysis&&null!=k.pinfo){for(E=0;E<k.channels_out;E++){var G;for(G=0;s>G;G++)k.pinfo.pcmdata[E][G]=k.pinfo.pcmdata[E][G+n.framesize];for(G=s;1600>G;G++)k.pinfo.pcmdata[E][G]=B[E][G-s]}d.set_frame_pinfo(n,A)}return t(k),y}}function C(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function D(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[r(4),r(4)];for(var e=0;2>e;e++)for(var t=0;2>t;t++)this.tt[e][t]=new x}function N(){this.last_en_subshort=i([4,9]),this.lastAttacks=r(4),this.pefirbuf=n(19),this.longfact=n(O.SBMAX_l),this.shortfact=n(O.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function V(){this.l=n(O.SBMAX_l),this.s=i([O.SBMAX_s,3]);var e=this;this.assign=function(t){Q.arraycopy(t.l,0,e.l,0,O.SBMAX_l);for(var r=0;r<O.SBMAX_s;r++)for(var n=0;3>n;n++)e.s[r][n]=t.s[r][n]}}function H(){function t(){this.write_timing=0,this.ptr=0,this.buf=e(o)}var o=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=i([2,H.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new D,this.ms_ratio=n(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=r(2),this.CurrentStep=r(2),this.masking_lower=0,this.bv_scf=r(576),this.pseudohalf=r(te.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*H.BPC+1),this.itime=a(2),this.sideinfo_len=0,this.sb_sample=i([2,2,18,O.SBLIMIT]),this.amp_filter=n(32),this.header=new Array(H.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new M,this.minval_l=n(O.CBANDS),this.minval_s=n(O.CBANDS),this.nb_1=i([4,O.CBANDS]),this.nb_2=i([4,O.CBANDS]),this.nb_s1=i([4,O.CBANDS]),this.nb_s2=i([4,O.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=n(4),this.loudness_sq=i([2,2]),this.loudness_sq_save=n(2),this.mld_l=n(O.SBMAX_l),this.mld_s=n(O.SBMAX_s),this.bm_l=r(O.SBMAX_l),this.bo_l=r(O.SBMAX_l),this.bm_s=r(O.SBMAX_s),this.bo_s=r(O.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=s([O.CBANDS,2]),this.s3ind_s=s([O.CBANDS,2]),this.numlines_s=r(O.CBANDS),this.numlines_l=r(O.CBANDS),this.rnumlines_l=n(O.CBANDS),this.mld_cb_l=n(O.CBANDS),this.mld_cb_s=n(O.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=n(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=r(2),this.nsPsy=new N,this.VBR_seek_table=new C,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=s([16,5]),this.bitrate_blockType_Hist=s([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var l=0;l<this.en.length;l++)this.en[l]=new V;for(var l=0;l<this.thm.length;l++)this.thm[l]=new V;for(var l=0;l<this.header.length;l++)this.header[l]=new t}function U(){function e(e,t,r){var n,i,s,o=0;r<<=1;var l=t+r;n=4;do{var c,f,u,_,h,d,p;p=n>>1,_=n,h=n<<1,d=h+_,n=h<<1,i=t,s=i+p;do{var m,v,b,g;v=e[i+0]-e[i+_],m=e[i+0]+e[i+_],g=e[i+h]-e[i+d],b=e[i+h]+e[i+d],e[i+h]=m-b,e[i+0]=m+b,e[i+d]=v-g,e[i+_]=v+g,v=e[s+0]-e[s+_],m=e[s+0]+e[s+_],g=J.SQRT2*e[s+d],b=J.SQRT2*e[s+h],e[s+h]=m-b,e[s+0]=m+b,e[s+d]=v-g,e[s+_]=v+g,s+=n,i+=n}while(l>i);for(f=a[o+0],c=a[o+1],u=1;p>u;u++){var w,y;w=1-2*c*c,y=2*c*f,i=t+u,s=t+_-u;do{var R,S,A,m,v,T,b,E,g,M;S=y*e[i+_]-w*e[s+_],R=w*e[i+_]+y*e[s+_],v=e[i+0]-R,m=e[i+0]+R,T=e[s+0]-S,A=e[s+0]+S,S=y*e[i+d]-w*e[s+d],R=w*e[i+d]+y*e[s+d],g=e[i+h]-R,b=e[i+h]+R,M=e[s+h]-S,E=e[s+h]+S,S=c*b-f*M,R=f*b+c*M,e[i+h]=m-R,e[i+0]=m+R,e[s+d]=T-S,e[s+_]=T+S,S=f*E-c*g,R=c*E+f*g,e[s+h]=A-R,e[s+0]=A+R,e[i+d]=v-S,e[i+_]=v+S,s+=n,i+=n}while(l>i);w=f,f=w*a[o+0]-c*a[o+1],c=w*a[o+1]+c*a[o+0]}o+=2}while(r>n)}var t=n(O.BLKSIZE),r=n(O.BLKSIZE_s/2),a=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475],i=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(t,n,a,s,o){for(var l=0;3>l;l++){var c=O.BLKSIZE_s/2,f=65535&192*(l+1),u=O.BLKSIZE_s/8-1;do{var _,h,d,p,m,v=255&i[u<<2];_=r[v]*s[a][o+v+f],m=r[127-v]*s[a][o+v+f+128],h=_-m,_+=m,d=r[v+64]*s[a][o+v+f+64],m=r[63-v]*s[a][o+v+f+192],p=d-m,d+=m,c-=4,n[l][c+0]=_+d,n[l][c+2]=_-d,n[l][c+1]=h+p,n[l][c+3]=h-p,_=r[v+1]*s[a][o+v+f+1],m=r[126-v]*s[a][o+v+f+129],h=_-m,_+=m,d=r[v+65]*s[a][o+v+f+65],m=r[62-v]*s[a][o+v+f+193],p=d-m,d+=m,n[l][c+O.BLKSIZE_s/2+0]=_+d,n[l][c+O.BLKSIZE_s/2+2]=_-d,n[l][c+O.BLKSIZE_s/2+1]=h+p,n[l][c+O.BLKSIZE_s/2+3]=h-p}while(--u>=0);e(n[l],c,O.BLKSIZE_s/2)}},this.fft_long=function(r,n,a,s,o){var l=O.BLKSIZE/8-1,c=O.BLKSIZE/2;do{var f,u,_,h,d,p=255&i[l];f=t[p]*s[a][o+p],d=t[p+512]*s[a][o+p+512],u=f-d,f+=d,_=t[p+256]*s[a][o+p+256],d=t[p+768]*s[a][o+p+768],h=_-d,_+=d,c-=4,n[c+0]=f+_,n[c+2]=f-_,n[c+1]=u+h,n[c+3]=u-h,f=t[p+1]*s[a][o+p+1],d=t[p+513]*s[a][o+p+513],u=f-d,f+=d,_=t[p+257]*s[a][o+p+257],d=t[p+769]*s[a][o+p+769],h=_-d,_+=d,n[c+O.BLKSIZE/2+0]=f+_,n[c+O.BLKSIZE/2+2]=f-_,n[c+O.BLKSIZE/2+1]=u+h,n[c+O.BLKSIZE/2+3]=u-h}while(--l>=0);e(n,c,O.BLKSIZE/2)},this.init_fft=function(e){for(var n=0;n<O.BLKSIZE;n++)t[n]=.42-.5*Math.cos(2*Math.PI*(n+.5)/O.BLKSIZE)+.08*Math.cos(4*Math.PI*(n+.5)/O.BLKSIZE);for(var n=0;n<O.BLKSIZE_s/2;n++)r[n]=.5*(1-Math.cos(2*Math.PI*(n+.5)/O.BLKSIZE_s))}}function j(){function e(e){return e}function t(e,t){for(var r=0,n=0;n<O.BLKSIZE/2;++n)r+=e[n]*t.ATH.eql_w[n];return r*=ie}function a(r,n,a,i,s,o,l,c,f,u,_){var h=r.internal_flags;if(2>f)Z.fft_long(h,i[s],f,u,_),Z.fft_short(h,o[l],f,u,_);else if(2==f){for(var d=O.BLKSIZE-1;d>=0;--d){var p=i[s+0][d],m=i[s+1][d];i[s+0][d]=(p+m)*J.SQRT2*.5,i[s+1][d]=(p-m)*J.SQRT2*.5}for(var v=2;v>=0;--v)for(var d=O.BLKSIZE_s-1;d>=0;--d){var p=o[l+0][v][d],m=o[l+1][v][d];o[l+0][v][d]=(p+m)*J.SQRT2*.5,o[l+1][v][d]=(p-m)*J.SQRT2*.5}}n[0]=e(i[s+0][0]),n[0]*=n[0];for(var d=O.BLKSIZE/2-1;d>=0;--d){var b=i[s+0][O.BLKSIZE/2-d],g=i[s+0][O.BLKSIZE/2+d];n[O.BLKSIZE/2-d]=e(.5*(b*b+g*g))}for(var v=2;v>=0;--v){a[v][0]=o[l+0][v][0],a[v][0]*=a[v][0];for(var d=O.BLKSIZE_s/2-1;d>=0;--d){var b=o[l+0][v][O.BLKSIZE_s/2-d],g=o[l+0][v][O.BLKSIZE_s/2+d];a[v][O.BLKSIZE_s/2-d]=e(.5*(b*b+g*g))}}for(var w=0,d=11;d<O.HBLKSIZE;d++)w+=n[d];if(h.tot_ener[f]=w,r.analysis){for(var d=0;d<O.HBLKSIZE;d++)h.pinfo.energy[c][f][d]=h.pinfo.energy_save[f][d],h.pinfo.energy_save[f][d]=n[d];h.pinfo.pe[c][f]=h.pe[f]}2==r.athaa_loudapprox&&2>f&&(h.loudness_sq[c][f]=h.loudness_sq_save[f],h.loudness_sq_save[f]=t(n,h))}function s(){z=Math.pow(10,(he+1)/16),G=Math.pow(10,(de+1)/16),K=Math.pow(10,pe/10)}function o(e,t,r,n,a,i){var s;if(t>e){if(!(e*G>t))return e+t;s=t/e}else{if(e>=t*G)return e+t;s=e/t}if(e+=t,6>=n+3){if(s>=z)return e;var o=0|J.FAST_LOG10_X(s,16);return e*be[o]}var o=0|J.FAST_LOG10_X(s,16);if(t=0!=i?a.ATH.cb_s[r]*a.ATH.adjust:a.ATH.cb_l[r]*a.ATH.adjust,K*t>e){if(e>t){var l,c;return l=1,13>=o&&(l=ge[o]),c=J.FAST_LOG10_X(e/t,10/15),e*((ve[o]-l)*c+l)}return o>13?e:e*ge[o]}return e*ve[o]}function l(e,t,r){var n;if(0>e&&(e=0),0>t&&(t=0),0>=e)return t;if(0>=t)return e;if(n=t>e?t/e:e/t,r>=-2&&2>=r){if(n>=z)return e+t;var a=0|J.FAST_LOG10_X(n,16);return(e+t)*we[a]}return G>n?e+t:(t>e&&(e=t),e)}function _(e,t){var r=e.internal_flags;if(r.channels_out>1){for(var n=0;n<O.SBMAX_l;n++){var a=r.thm[0].l[n],i=r.thm[1].l[n];r.thm[0].l[n]+=i*t,r.thm[1].l[n]+=a*t}for(var n=0;n<O.SBMAX_s;n++)for(var s=0;3>s;s++){var a=r.thm[0].s[n][s],i=r.thm[1].s[n][s];r.thm[0].s[n][s]+=i*t,r.thm[1].s[n][s]+=a*t}}}function h(e){for(var t=0;t<O.SBMAX_l;t++)if(!(e.thm[0].l[t]>1.58*e.thm[1].l[t]||e.thm[1].l[t]>1.58*e.thm[0].l[t])){var r=e.mld_l[t]*e.en[3].l[t],n=Math.max(e.thm[2].l[t],Math.min(e.thm[3].l[t],r));r=e.mld_l[t]*e.en[2].l[t];var a=Math.max(e.thm[3].l[t],Math.min(e.thm[2].l[t],r));e.thm[2].l[t]=n,e.thm[3].l[t]=a}for(var t=0;t<O.SBMAX_s;t++)for(var i=0;3>i;i++)if(!(e.thm[0].s[t][i]>1.58*e.thm[1].s[t][i]||e.thm[1].s[t][i]>1.58*e.thm[0].s[t][i])){var r=e.mld_s[t]*e.en[3].s[t][i],n=Math.max(e.thm[2].s[t][i],Math.min(e.thm[3].s[t][i],r));r=e.mld_s[t]*e.en[2].s[t][i];var a=Math.max(e.thm[3].s[t][i],Math.min(e.thm[2].s[t][i],r));e.thm[2].s[t][i]=n,e.thm[3].s[t][i]=a}}function d(e,t,r){var n=t,a=Math.pow(10,r);t*=2,n*=2;for(var i=0;i<O.SBMAX_l;i++){var s,o,l,c;if(c=e.ATH.cb_l[e.bm_l[i]]*a,s=Math.min(Math.max(e.thm[0].l[i],c),Math.max(e.thm[1].l[i],c)),o=Math.max(e.thm[2].l[i],c),l=Math.max(e.thm[3].l[i],c),o+l>s*t){var f=s*n/(o+l);o*=f,l*=f}e.thm[2].l[i]=Math.min(o,e.thm[2].l[i]),e.thm[3].l[i]=Math.min(l,e.thm[3].l[i])}a*=O.BLKSIZE_s/O.BLKSIZE;for(var i=0;i<O.SBMAX_s;i++)for(var u=0;3>u;u++){var s,o,l,c;if(c=e.ATH.cb_s[e.bm_s[i]]*a,s=Math.min(Math.max(e.thm[0].s[i][u],c),Math.max(e.thm[1].s[i][u],c)),o=Math.max(e.thm[2].s[i][u],c),l=Math.max(e.thm[3].s[i][u],c),o+l>s*t){var f=s*t/(o+l);o*=f,l*=f}e.thm[2].s[i][u]=Math.min(e.thm[2].s[i][u],o),e.thm[3].s[i][u]=Math.min(e.thm[3].s[i][u],l)}}function p(e,t,r,n,a){var i,s,o=0,l=0;for(i=s=0;i<O.SBMAX_s;++s,++i){for(var c=e.bo_s[i],f=e.npart_s,u=f>c?c:f;u>s;)o+=t[s],l+=r[s],s++;if(e.en[n].s[i][a]=o,e.thm[n].s[i][a]=l,s>=f){++i;break}var _=e.PSY.bo_s_weight[i],h=1-_;o=_*t[s],l=_*r[s],e.en[n].s[i][a]+=o,e.thm[n].s[i][a]+=l,o=h*t[s],l=h*r[s]}for(;i<O.SBMAX_s;++i)e.en[n].s[i][a]=0,e.thm[n].s[i][a]=0}function m(e,t,r,n){var a,i,s=0,o=0;for(a=i=0;a<O.SBMAX_l;++i,++a){for(var l=e.bo_l[a],c=e.npart_l,f=c>l?l:c;f>i;)s+=t[i],o+=r[i],i++;if(e.en[n].l[a]=s,e.thm[n].l[a]=o,i>=c){++a;break}var u=e.PSY.bo_l_weight[a],_=1-u;s=u*t[i],o=u*r[i],e.en[n].l[a]+=s,e.thm[n].l[a]+=o,s=_*t[i],o=_*r[i]}for(;a<O.SBMAX_l;++a)e.en[n].l[a]=0,e.thm[n].l[a]=0}function v(e,t,r,n,a,i){var s,o,l=e.internal_flags;for(o=s=0;o<l.npart_s;++o){for(var c=0,f=0,u=l.numlines_s[o],_=0;u>_;++_,++s){var h=t[i][s];c+=h,h>f&&(f=h)}r[o]=c}for(s=o=0;o<l.npart_s;o++){var d=l.s3ind_s[o][0],p=l.s3_ss[s++]*r[d];for(++d;d<=l.s3ind_s[o][1];)p+=l.s3_ss[s]*r[d],++s,++d;var m=re*l.nb_s1[a][o];if(n[o]=Math.min(p,m),l.blocktype_old[1&a]==O.SHORT_TYPE){var m=ne*l.nb_s2[a][o],v=n[o];n[o]=Math.min(m,v)}l.nb_s2[a][o]=l.nb_s1[a][o],l.nb_s1[a][o]=p}for(;o<=O.CBANDS;++o)r[o]=0,n[o]=0}function b(e,t,r,n){var a=e.internal_flags;e.short_blocks!=c.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var i=0;i<a.channels_out;i++)n[i]=O.NORM_TYPE,e.short_blocks==c.short_block_dispensed&&(t[i]=1),e.short_blocks==c.short_block_forced&&(t[i]=0),0!=t[i]?a.blocktype_old[i]==O.SHORT_TYPE&&(n[i]=O.STOP_TYPE):(n[i]=O.SHORT_TYPE,a.blocktype_old[i]==O.NORM_TYPE&&(a.blocktype_old[i]=O.START_TYPE),a.blocktype_old[i]==O.STOP_TYPE&&(a.blocktype_old[i]=O.SHORT_TYPE)),r[i]=a.blocktype_old[i],a.blocktype_old[i]=n[i]}function g(e,t,r){return r>=1?e:0>=r?t:t>0?Math.pow(e/t,r)*t:0}function w(e,t){for(var r=309.07,n=0;n<O.SBMAX_s-1;n++)for(var a=0;3>a;a++){var i=e.thm.s[n][a];if(i>0){var s=i*t,o=e.en.s[n][a];o>s&&(r+=o>1e10*s?ye[n]*(10*Q):ye[n]*J.FAST_LOG10(o/s))}}return r}function y(e,t){for(var r=281.0575,n=0;n<O.SBMAX_l-1;n++){var a=e.thm.l[n];if(a>0){var i=a*t,s=e.en.l[n];s>i&&(r+=s>1e10*i?Re[n]*(10*Q):Re[n]*J.FAST_LOG10(s/i))}}return r}function R(e,t,r,n,a){var i,s;for(i=s=0;i<e.npart_l;++i){var o,l=0,c=0;for(o=0;o<e.numlines_l[i];++o,++s){var f=t[s];l+=f,f>c&&(c=f)}r[i]=l,n[i]=c,a[i]=l*e.rnumlines_l[i]}}function S(e,t,r,n){var a=me.length-1,i=0,s=r[i]+r[i+1];if(s>0){var o=t[i];o<t[i+1]&&(o=t[i+1]),s=20*(2*o-s)/(s*(e.numlines_l[i]+e.numlines_l[i+1]-1));var l=0|s;l>a&&(l=a),n[i]=l}else n[i]=0;for(i=1;i<e.npart_l-1;i++)if(s=r[i-1]+r[i]+r[i+1],s>0){var o=t[i-1];o<t[i]&&(o=t[i]),o<t[i+1]&&(o=t[i+1]),s=20*(3*o-s)/(s*(e.numlines_l[i-1]+e.numlines_l[i]+e.numlines_l[i+1]-1));var l=0|s;l>a&&(l=a),n[i]=l}else n[i]=0;if(s=r[i-1]+r[i],s>0){var o=t[i-1];o<t[i]&&(o=t[i]),s=20*(2*o-s)/(s*(e.numlines_l[i-1]+e.numlines_l[i]-1));var l=0|s;l>a&&(l=a),n[i]=l}else n[i]=0}function A(t,r,n,a,i,s,o,l){var c=t.internal_flags;if(2>a)Z.fft_long(c,o[l],a,r,n);else if(2==a)for(var f=O.BLKSIZE-1;f>=0;--f){var u=o[l+0][f],_=o[l+1][f];o[l+0][f]=(u+_)*J.SQRT2*.5,o[l+1][f]=(u-_)*J.SQRT2*.5}s[0]=e(o[l+0][0]),s[0]*=s[0];for(var f=O.BLKSIZE/2-1;f>=0;--f){var h=o[l+0][O.BLKSIZE/2-f],d=o[l+0][O.BLKSIZE/2+f];s[O.BLKSIZE/2-f]=e(.5*(h*h+d*d))}for(var p=0,f=11;f<O.HBLKSIZE;f++)p+=s[f];if(c.tot_ener[a]=p,t.analysis){for(var f=0;f<O.HBLKSIZE;f++)c.pinfo.energy[i][a][f]=c.pinfo.energy_save[a][f],c.pinfo.energy_save[a][f]=s[f];c.pinfo.pe[i][a]=c.pe[a]}}function T(t,r,n,a,i,s,o,l){var c=t.internal_flags;if(0==i&&2>a&&Z.fft_short(c,o[l],a,r,n),2==a)for(var f=O.BLKSIZE_s-1;f>=0;--f){var u=o[l+0][i][f],_=o[l+1][i][f];o[l+0][i][f]=(u+_)*J.SQRT2*.5,o[l+1][i][f]=(u-_)*J.SQRT2*.5}s[i][0]=o[l+0][i][0],s[i][0]*=s[i][0];for(var f=O.BLKSIZE_s/2-1;f>=0;--f){var h=o[l+0][i][O.BLKSIZE_s/2-f],d=o[l+0][i][O.BLKSIZE_s/2+f];s[i][O.BLKSIZE_s/2-f]=e(.5*(h*h+d*d))}}function E(e,r,n,a){var i=e.internal_flags;2==e.athaa_loudapprox&&2>n&&(i.loudness_sq[r][n]=i.loudness_sq_save[n],i.loudness_sq_save[n]=t(a,i))}function M(e,t,r,a,s,o,l,c,f,_){for(var h=i([2,576]),d=e.internal_flags,p=d.channels_out,m=e.mode==u.JOINT_STEREO?4:p,v=0;p>v;v++){firbuf=t[v];for(var b=r+576-350-ue+192,g=0;576>g;g++){var w,y;w=firbuf[b+g+10],y=0;for(var R=0;(ue-1)/2-1>R;R+=2)w+=Ae[R]*(firbuf[b+g+R]+firbuf[b+g+ue-R]),y+=Ae[R+1]*(firbuf[b+g+R+1]+firbuf[b+g+ue-R-1]);h[v][g]=w+y}s[a][v].en.assign(d.en[v]),s[a][v].thm.assign(d.thm[v]),m>2&&(o[a][v].en.assign(d.en[v+2]),o[a][v].thm.assign(d.thm[v+2]))}for(var v=0;m>v;v++){var S=n(12),A=n(12),T=[0,0,0,0],E=h[1&v],M=0,B=3==v?d.nsPsy.attackthre_s:d.nsPsy.attackthre,k=1;if(2==v)for(var g=0,R=576;R>0;++g,--R){var x=h[0][g],P=h[1][g];h[0][g]=x+P,h[1][g]=x-P}for(var g=0;3>g;g++)A[g]=d.nsPsy.last_en_subshort[v][g+6],S[g]=A[g]/d.nsPsy.last_en_subshort[v][g+4],T[0]+=A[g];for(var g=0;9>g;g++){for(var I=M+64,L=1;I>M;M++)L<Math.abs(E[M])&&(L=Math.abs(E[M]));d.nsPsy.last_en_subshort[v][g]=A[g+3]=L,T[1+g/3]+=L,L>A[g+3-2]?L/=A[g+3-2]:L=A[g+3-2]>10*L?A[g+3-2]/(10*L):0,S[g+3]=L}for(var g=0;3>g;++g){var O=A[3*g+3]+A[3*g+4]+A[3*g+5],C=1;6*A[3*g+5]<O&&(C*=.5,6*A[3*g+4]<O&&(C*=.5)),c[v][g]=C}if(e.analysis){for(var D=S[0],g=1;12>g;g++)D<S[g]&&(D=S[g]);d.pinfo.ers[a][v]=d.pinfo.ers_save[v],d.pinfo.ers_save[v]=D}for(var g=0;12>g;g++)0==f[v][g/3]&&S[g]>B&&(f[v][g/3]=g%3+1);for(var g=1;4>g;g++){var N=T[g-1],V=T[g],H=Math.max(N,V);4e4>H&&1.7*V>N&&1.7*N>V&&(1==g&&f[v][0]<=f[v][g]&&(f[v][0]=0),f[v][g]=0)}f[v][0]<=d.nsPsy.lastAttacks[v]&&(f[v][0]=0),(3==d.nsPsy.lastAttacks[v]||f[v][0]+f[v][1]+f[v][2]+f[v][3]!=0)&&(k=0,0!=f[v][1]&&0!=f[v][0]&&(f[v][1]=0),0!=f[v][2]&&0!=f[v][1]&&(f[v][2]=0),0!=f[v][3]&&0!=f[v][2]&&(f[v][3]=0)),2>v?_[v]=k:0==k&&(_[0]=_[1]=0),l[v]=d.tot_ener[v]}}function B(e,t,r){if(0==r)for(var n=0;n<e.npart_s;n++)e.nb_s2[t][n]=e.nb_s1[t][n],e.nb_s1[t][n]=0}function k(e,t){for(var r=0;r<e.npart_l;r++)e.nb_2[t][r]=e.nb_1[t][r],e.nb_1[t][r]=0}function x(e,t,r,n){var a=me.length-1,i=0,s=r[i]+r[i+1];if(s>0){var o=t[i];o<t[i+1]&&(o=t[i+1]),s=20*(2*o-s)/(s*(e.numlines_s[i]+e.numlines_s[i+1]-1));var l=0|s;l>a&&(l=a),n[i]=l}else n[i]=0;for(i=1;i<e.npart_s-1;i++)if(s=r[i-1]+r[i]+r[i+1],s>0){var o=t[i-1];o<t[i]&&(o=t[i]),o<t[i+1]&&(o=t[i+1]),s=20*(3*o-s)/(s*(e.numlines_s[i-1]+e.numlines_s[i]+e.numlines_s[i+1]-1));var l=0|s;l>a&&(l=a),n[i]=l}else n[i]=0;if(s=r[i-1]+r[i],s>0){var o=t[i-1];o<t[i]&&(o=t[i]),s=20*(2*o-s)/(s*(e.numlines_s[i-1]+e.numlines_s[i]-1));var l=0|s;l>a&&(l=a),n[i]=l}else n[i]=0}function P(e,t,r,a,i,s){var o,c,f,u=e.internal_flags,_=new float[O.CBANDS],h=n(O.CBANDS),d=new int[O.CBANDS];for(f=c=0;f<u.npart_s;++f){var p=0,m=0,v=u.numlines_s[f];for(o=0;v>o;++o,++c){var b=t[s][c];p+=b,b>m&&(m=b)}r[f]=p,_[f]=m,h[f]=p/v}for(;f<O.CBANDS;++f)_[f]=0,h[f]=0;for(x(u,_,h,d),c=f=0;f<u.npart_s;f++){var g,w,y,R,S,A=u.s3ind_s[f][0],T=u.s3ind_s[f][1];for(g=d[A],w=1,R=u.s3_ss[c]*r[A]*me[d[A]],++c,++A;T>=A;)g+=d[A],w+=1,y=u.s3_ss[c]*r[A]*me[d[A]],R=l(R,y,A-f),++c,++A;g=(1+2*g)/(2*w),S=.5*me[g],R*=S,a[f]=R,u.nb_s2[i][f]=u.nb_s1[i][f],u.nb_s1[i][f]=R,y=_[f],y*=u.minval_s[f],y*=S,a[f]>y&&(a[f]=y),u.masking_lower>1&&(a[f]*=u.masking_lower),a[f]>r[f]&&(a[f]=r[f]),u.masking_lower<1&&(a[f]*=u.masking_lower);
}for(;f<O.CBANDS;++f)r[f]=0,a[f]=0}function I(e,t,a,i,s){var o,c=n(O.CBANDS),f=n(O.CBANDS),u=r(O.CBANDS+2);R(e,t,a,c,f),S(e,c,f,u);var _=0;for(o=0;o<e.npart_l;o++){var h,d,p,m,v=e.s3ind[o][0],b=e.s3ind[o][1],g=0,w=0;for(g=u[v],w+=1,d=e.s3_ll[_]*a[v]*me[u[v]],++_,++v;b>=v;)g+=u[v],w+=1,h=e.s3_ll[_]*a[v]*me[u[v]],m=l(d,h,v-o),d=m,++_,++v;if(g=(1+2*g)/(2*w),p=.5*me[g],d*=p,e.blocktype_old[1&s]==O.SHORT_TYPE){var y=ee*e.nb_1[s][o];y>0?i[o]=Math.min(d,y):i[o]=Math.min(d,a[o]*ce)}else{var y,A=te*e.nb_2[s][o],T=ee*e.nb_1[s][o];0>=A&&(A=d),0>=T&&(T=d),y=e.blocktype_old[1&s]==O.NORM_TYPE?Math.min(T,A):T,i[o]=Math.min(d,y)}e.nb_2[s][o]=e.nb_1[s][o],e.nb_1[s][o]=d,h=c[o],h*=e.minval_l[o],h*=p,i[o]>h&&(i[o]=h),e.masking_lower>1&&(i[o]*=e.masking_lower),i[o]>a[o]&&(i[o]=a[o]),e.masking_lower<1&&(i[o]*=e.masking_lower)}for(;o<O.CBANDS;++o)a[o]=0,i[o]=0}function L(e,t){var r=e.internal_flags;e.short_blocks!=c.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var n=0;n<r.channels_out;n++)e.short_blocks==c.short_block_dispensed&&(t[n]=1),e.short_blocks==c.short_block_forced&&(t[n]=0)}function C(e,t,r){for(var n=e.internal_flags,a=0;a<n.channels_out;a++){var i=O.NORM_TYPE;0!=t[a]?n.blocktype_old[a]==O.SHORT_TYPE&&(i=O.STOP_TYPE):(i=O.SHORT_TYPE,n.blocktype_old[a]==O.NORM_TYPE&&(n.blocktype_old[a]=O.START_TYPE),n.blocktype_old[a]==O.STOP_TYPE&&(n.blocktype_old[a]=O.SHORT_TYPE)),r[a]=n.blocktype_old[a],n.blocktype_old[a]=i}}function D(e,t,r,n,a,i,s){for(var o,l,c=2*i,f=i>0?Math.pow(10,a):1,u=0;s>u;++u){var _=e[2][u],h=e[3][u],d=t[0][u],p=t[1][u],m=t[2][u],v=t[3][u];if(1.58*p>=d&&1.58*d>=p){var b=r[u]*h,g=r[u]*_;l=Math.max(m,Math.min(v,b)),o=Math.max(v,Math.min(m,g))}else l=m,o=v;if(i>0){var w,y,R=n[u]*f;if(w=Math.min(Math.max(d,R),Math.max(p,R)),m=Math.max(l,R),v=Math.max(o,R),y=m+v,y>0&&y>w*c){var S=w*c/y;m*=S,v*=S}l=Math.min(m,l),o=Math.min(v,o)}l>_&&(l=_),o>h&&(o=h),t[2][u]=l,t[3][u]=o}}function N(e,t){var r,n=e;return r=n>=0?27*-n:n*t,-72>=r?0:Math.exp(r*_e)}function V(e){var t,r,n=0,a=0,i=0;for(i=0;N(i,e)>1e-20;i-=1);for(t=i,r=0;Math.abs(r-t)>1e-12;)i=(r+t)/2,N(i,e)>0?r=i:t=i;n=t;var t,r,i=0;for(i=0;N(i,e)>1e-20;i+=1);for(t=0,r=i;Math.abs(r-t)>1e-12;)i=(r+t)/2,N(i,e)>0?t=i:r=i;a=r;var s,o=0,l=1e3;for(s=0;l>=s;++s){var i=n+s*(a-n)/l,c=N(i,e);o+=c}var f=(l+1)/(o*(a-n));return f}function H(e){var t,r,n,a;return t=e,t*=t>=0?3:1.5,t>=.5&&2.5>=t?(a=t-.5,r=8*(a*a-2*a)):r=0,t+=.474,n=15.811389+7.5*t-17.5*Math.sqrt(1+t*t),-60>=n?0:(t=Math.exp((r+n)*_e),t/=.6609193)}function j(e){return 0>e&&(e=0),e=.001*e,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function Y(e,t,a,i,s,o,l,c,f,u,_,h){var d,p=n(O.CBANDS+1),m=c/(h>15?1152:384),v=r(O.HBLKSIZE);c/=f;var b=0,g=0;for(d=0;d<O.CBANDS;d++){var w,y;for(w=j(c*b),p[d]=c*b,y=b;j(c*y)-w<ae&&f/2>=y;y++);for(e[d]=y-b,g=d+1;y>b;)v[b++]=d;if(b>f/2){b=f/2,++d;break}}p[d]=c*b;for(var R=0;h>R;R++){var S,A,T,E,M;T=u[R],E=u[R+1],S=0|Math.floor(.5+_*(T-.5)),0>S&&(S=0),A=0|Math.floor(.5+_*(E-.5)),A>f/2&&(A=f/2),a[R]=(v[S]+v[A])/2,t[R]=v[A];var B=m*E;l[R]=(B-p[t[R]])/(p[t[R]+1]-p[t[R]]),l[R]<0?l[R]=0:l[R]>1&&(l[R]=1),M=j(c*u[R]*_),M=Math.min(M,15.5)/15.5,o[R]=Math.pow(10,1.25*(1-Math.cos(Math.PI*M))-2.5)}b=0;for(var k=0;g>k;k++){var w,x,P=e[k];w=j(c*b),x=j(c*(b+P-1)),i[k]=.5*(w+x),w=j(c*(b-.5)),x=j(c*(b+P-.5)),s[k]=x-w,b+=P}return g}function F(e,t,r,a,s,o){var l,c=i([O.CBANDS,O.CBANDS]),f=0;if(o)for(var u=0;t>u;u++)for(l=0;t>l;l++){var _=H(r[u]-r[l])*a[l];c[u][l]=_*s[u]}else for(l=0;t>l;l++)for(var h=15+Math.min(21/r[l],12),d=V(h),u=0;t>u;u++){var _=d*N(r[u]-r[l],h)*a[l];c[u][l]=_*s[u]}for(var u=0;t>u;u++){for(l=0;t>l&&!(c[u][l]>0);l++);for(e[u][0]=l,l=t-1;l>0&&!(c[u][l]>0);l--);e[u][1]=l,f+=e[u][1]-e[u][0]+1}for(var p=n(f),m=0,u=0;t>u;u++)for(l=e[u][0];l<=e[u][1];l++)p[m++]=c[u][l];return p}function X(e){var t=j(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function q(e,t){-.3>e&&(e=3410),e/=1e3,e=Math.max(.1,e);var r=3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4);return r}var z,G,K,Z=new U,Q=2.302585092994046,ee=2,te=16,re=2,ne=16,ae=.34,ie=1/217621504/(O.BLKSIZE/2),se=.01,oe=.8,le=.6,ce=.3,fe=3.5,ue=21,_e=.2302585093,he=8,de=23,pe=15,me=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],ve=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],be=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],ge=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276],we=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],ye=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130],Re=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1],Se=[-1.730326e-17,-0.01703172,-1.349528e-17,.0418072,-6.73278e-17,-0.0876324,-3.0835e-17,.1863476,-1.104424e-16,-0.627638];this.L3psycho_anal_ns=function(e,t,s,l,c,A,T,E,M,B){var k,x,P,I,L,C,D,N,V,H=e.internal_flags,U=i([2,O.BLKSIZE]),j=i([2,3,O.BLKSIZE_s]),Y=n(O.CBANDS+1),F=n(O.CBANDS+1),X=n(O.CBANDS+2),q=r(2),z=r(2),G=i([2,576]),K=r(O.CBANDS+2),Z=r(O.CBANDS+2);for(W.fill(Z,0),k=H.channels_out,e.mode==u.JOINT_STEREO&&(k=4),V=e.VBR==f.vbr_off?0==H.ResvMax?0:H.ResvSize/H.ResvMax*.5:e.VBR==f.vbr_rh||e.VBR==f.vbr_mtrh||e.VBR==f.vbr_mt?.6:1,x=0;x<H.channels_out;x++){var Q=t[x],J=s+576-350-ue+192;for(I=0;576>I;I++){var $,re;for($=Q[J+I+10],re=0,L=0;(ue-1)/2-1>L;L+=2)$+=Se[L]*(Q[J+I+L]+Q[J+I+ue-L]),re+=Se[L+1]*(Q[J+I+L+1]+Q[J+I+ue-L-1]);G[x][I]=$+re}c[l][x].en.assign(H.en[x]),c[l][x].thm.assign(H.thm[x]),k>2&&(A[l][x].en.assign(H.en[x+2]),A[l][x].thm.assign(H.thm[x+2]))}for(x=0;k>x;x++){var ne,ae,ie,se=n(12),fe=[0,0,0,0],_e=n(12),he=1,de=n(O.CBANDS),pe=n(O.CBANDS),ve=[0,0,0,0],be=n(O.HBLKSIZE),ge=i([3,O.HBLKSIZE_s]);for(I=0;3>I;I++)se[I]=H.nsPsy.last_en_subshort[x][I+6],_e[I]=se[I]/H.nsPsy.last_en_subshort[x][I+4],fe[0]+=se[I];if(2==x)for(I=0;576>I;I++){var we,ye;we=G[0][I],ye=G[1][I],G[0][I]=we+ye,G[1][I]=we-ye}var Re=G[1&x],Ae=0;for(I=0;9>I;I++){for(var Te=Ae+64,Ee=1;Te>Ae;Ae++)Ee<Math.abs(Re[Ae])&&(Ee=Math.abs(Re[Ae]));H.nsPsy.last_en_subshort[x][I]=se[I+3]=Ee,fe[1+I/3]+=Ee,Ee>se[I+3-2]?Ee/=se[I+3-2]:Ee=se[I+3-2]>10*Ee?se[I+3-2]/(10*Ee):0,_e[I+3]=Ee}if(e.analysis){var Me=_e[0];for(I=1;12>I;I++)Me<_e[I]&&(Me=_e[I]);H.pinfo.ers[l][x]=H.pinfo.ers_save[x],H.pinfo.ers_save[x]=Me}for(ie=3==x?H.nsPsy.attackthre_s:H.nsPsy.attackthre,I=0;12>I;I++)0==ve[I/3]&&_e[I]>ie&&(ve[I/3]=I%3+1);for(I=1;4>I;I++){var Be;Be=fe[I-1]>fe[I]?fe[I-1]/fe[I]:fe[I]/fe[I-1],1.7>Be&&(ve[I]=0,1==I&&(ve[0]=0))}for(0!=ve[0]&&0!=H.nsPsy.lastAttacks[x]&&(ve[0]=0),(3==H.nsPsy.lastAttacks[x]||ve[0]+ve[1]+ve[2]+ve[3]!=0)&&(he=0,0!=ve[1]&&0!=ve[0]&&(ve[1]=0),0!=ve[2]&&0!=ve[1]&&(ve[2]=0),0!=ve[3]&&0!=ve[2]&&(ve[3]=0)),2>x?z[x]=he:0==he&&(z[0]=z[1]=0),M[x]=H.tot_ener[x],ae=j,ne=U,a(e,be,ge,ne,1&x,ae,1&x,l,x,t,s),R(H,be,Y,de,pe),S(H,de,pe,K),N=0;3>N;N++){var ke,xe;for(v(e,ge,F,X,x,N),p(H,F,X,x,N),D=0;D<O.SBMAX_s;D++){if(xe=H.thm[x].s[D][N],xe*=oe,ve[N]>=2||1==ve[N+1]){var Pe=0!=N?N-1:2,Ee=g(H.thm[x].s[D][Pe],xe,le*V);xe=Math.min(xe,Ee)}if(1==ve[N]){var Pe=0!=N?N-1:2,Ee=g(H.thm[x].s[D][Pe],xe,ce*V);xe=Math.min(xe,Ee)}else if(0!=N&&3==ve[N-1]||0==N&&3==H.nsPsy.lastAttacks[x]){var Pe=2!=N?N+1:0,Ee=g(H.thm[x].s[D][Pe],xe,ce*V);xe=Math.min(xe,Ee)}ke=se[3*N+3]+se[3*N+4]+se[3*N+5],6*se[3*N+5]<ke&&(xe*=.5,6*se[3*N+4]<ke&&(xe*=.5)),H.thm[x].s[D][N]=xe}}for(H.nsPsy.lastAttacks[x]=ve[2],C=0,P=0;P<H.npart_l;P++){for(var Ie=H.s3ind[P][0],Le=Y[Ie]*me[K[Ie]],Oe=H.s3_ll[C++]*Le;++Ie<=H.s3ind[P][1];)Le=Y[Ie]*me[K[Ie]],Oe=o(Oe,H.s3_ll[C++]*Le,Ie,Ie-P,H,0);Oe*=.158489319246111,H.blocktype_old[1&x]==O.SHORT_TYPE?X[P]=Oe:X[P]=g(Math.min(Oe,Math.min(ee*H.nb_1[x][P],te*H.nb_2[x][P])),Oe,V),H.nb_2[x][P]=H.nb_1[x][P],H.nb_1[x][P]=Oe}for(;P<=O.CBANDS;++P)Y[P]=0,X[P]=0;m(H,Y,X,x)}if((e.mode==u.STEREO||e.mode==u.JOINT_STEREO)&&e.interChRatio>0&&_(e,e.interChRatio),e.mode==u.JOINT_STEREO){var Ce;h(H),Ce=e.msfix,Math.abs(Ce)>0&&d(H,Ce,e.ATHlower*H.ATH.adjust)}for(b(e,z,B,q),x=0;k>x;x++){var De,Ne,Ve,He=0;x>1?(De=E,He=-2,Ne=O.NORM_TYPE,(B[0]==O.SHORT_TYPE||B[1]==O.SHORT_TYPE)&&(Ne=O.SHORT_TYPE),Ve=A[l][x-2]):(De=T,He=0,Ne=B[x],Ve=c[l][x]),Ne==O.SHORT_TYPE?De[He+x]=w(Ve,H.masking_lower):De[He+x]=y(Ve,H.masking_lower),e.analysis&&(H.pinfo.pe[l][x]=De[He+x])}return 0};var Ae=[-1.730326e-17,-0.01703172,-1.349528e-17,.0418072,-6.73278e-17,-0.0876324,-3.0835e-17,.1863476,-1.104424e-16,-0.627638];this.L3psycho_anal_vbr=function(e,t,a,s,o,l,c,f,_,h){var d,v,b=e.internal_flags,R=n(O.HBLKSIZE),S=i([3,O.HBLKSIZE_s]),x=i([2,O.BLKSIZE]),N=i([2,3,O.BLKSIZE_s]),V=i([4,O.CBANDS]),H=i([4,O.CBANDS]),U=i([4,3]),j=.6,Y=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],F=r(2),X=e.mode==u.JOINT_STEREO?4:b.channels_out;M(e,t,a,s,o,l,_,U,Y,F),L(e,F);for(var q=0;X>q;q++){var z=1&q;d=x,A(e,t,a,q,s,R,d,z),E(e,s,q,R),0!=F[z]?I(b,R,V[q],H[q],q):k(b,q)}F[0]+F[1]==2&&e.mode==u.JOINT_STEREO&&D(V,H,b.mld_cb_l,b.ATH.cb_l,e.ATHlower*b.ATH.adjust,e.msfix,b.npart_l);for(var q=0;X>q;q++){var z=1&q;0!=F[z]&&m(b,V[q],H[q],q)}for(var G=0;3>G;G++){for(var q=0;X>q;++q){var z=1&q;0!=F[z]?B(b,q,G):(v=N,T(e,t,a,q,G,S,v,z),P(e,S,V[q],H[q],q,G))}F[0]+F[1]==0&&e.mode==u.JOINT_STEREO&&D(V,H,b.mld_cb_s,b.ATH.cb_s,e.ATHlower*b.ATH.adjust,e.msfix,b.npart_s);for(var q=0;X>q;++q){var z=1&q;0==F[z]&&p(b,V[q],H[q],q,G)}}for(var q=0;X>q;q++){var z=1&q;if(0==F[z])for(var K=0;K<O.SBMAX_s;K++){for(var Z=n(3),G=0;3>G;G++){var W=b.thm[q].s[K][G];if(W*=oe,Y[q][G]>=2||1==Y[q][G+1]){var Q=0!=G?G-1:2,J=g(b.thm[q].s[K][Q],W,le*j);W=Math.min(W,J)}else if(1==Y[q][G]){var Q=0!=G?G-1:2,J=g(b.thm[q].s[K][Q],W,ce*j);W=Math.min(W,J)}else if(0!=G&&3==Y[q][G-1]||0==G&&3==b.nsPsy.lastAttacks[q]){var Q=2!=G?G+1:0,J=g(b.thm[q].s[K][Q],W,ce*j);W=Math.min(W,J)}W*=U[q][G],Z[G]=W}for(var G=0;3>G;G++)b.thm[q].s[K][G]=Z[G]}}for(var q=0;X>q;q++)b.nsPsy.lastAttacks[q]=Y[q][2];C(e,F,h);for(var q=0;X>q;q++){var $,ee,te,re;q>1?($=f,ee=-2,te=O.NORM_TYPE,(h[0]==O.SHORT_TYPE||h[1]==O.SHORT_TYPE)&&(te=O.SHORT_TYPE),re=l[s][q-2]):($=c,ee=0,te=h[q],re=o[s][q]),te==O.SHORT_TYPE?$[ee+q]=w(re,b.masking_lower):$[ee+q]=y(re,b.masking_lower),e.analysis&&(b.pinfo.pe[s][q]=$[ee+q])}return 0},this.psymodel_init=function(e){var t,r=e.internal_flags,a=!0,i=13,o=24,l=0,c=0,u=-8.25,_=-4.5,h=n(O.CBANDS),d=n(O.CBANDS),p=n(O.CBANDS),m=e.out_samplerate;switch(e.experimentalZ){default:case 0:a=!0;break;case 1:a=e.VBR==f.vbr_mtrh||e.VBR==f.vbr_mt?!1:!0;break;case 2:a=!1;break;case 3:i=8,l=-1.75,c=-.0125,u=-8.25,_=-2.25}for(r.ms_ener_ratio_old=.25,r.blocktype_old[0]=r.blocktype_old[1]=O.NORM_TYPE,t=0;4>t;++t){for(var v=0;v<O.CBANDS;++v)r.nb_1[t][v]=1e20,r.nb_2[t][v]=1e20,r.nb_s1[t][v]=r.nb_s2[t][v]=1;for(var b=0;b<O.SBMAX_l;b++)r.en[t].l[b]=1e20,r.thm[t].l[b]=1e20;for(var v=0;3>v;++v){for(var b=0;b<O.SBMAX_s;b++)r.en[t].s[b][v]=1e20,r.thm[t].s[b][v]=1e20;r.nsPsy.lastAttacks[t]=0}for(var v=0;9>v;v++)r.nsPsy.last_en_subshort[t][v]=10}for(r.loudness_sq_save[0]=r.loudness_sq_save[1]=0,r.npart_l=Y(r.numlines_l,r.bo_l,r.bm_l,h,d,r.mld_l,r.PSY.bo_l_weight,m,O.BLKSIZE,r.scalefac_band.l,O.BLKSIZE/1152,O.SBMAX_l),t=0;t<r.npart_l;t++){var g=l;h[t]>=i&&(g=c*(h[t]-i)/(o-i)+l*(o-h[t])/(o-i)),p[t]=Math.pow(10,g/10),r.numlines_l[t]>0?r.rnumlines_l[t]=1/r.numlines_l[t]:r.rnumlines_l[t]=0}r.s3_ll=F(r.s3ind,r.npart_l,h,d,p,a);var v=0;for(t=0;t<r.npart_l;t++){var w;w=$.MAX_VALUE;for(var y=0;y<r.numlines_l[t];y++,v++){var R,S=m*v/(1e3*O.BLKSIZE);R=this.ATHformula(1e3*S,e)-20,R=Math.pow(10,.1*R),R*=r.numlines_l[t],w>R&&(w=R)}r.ATH.cb_l[t]=w,w=-20+20*h[t]/10,w>6&&(w=100),-15>w&&(w=-15),w-=8,r.minval_l[t]=Math.pow(10,w/10)*r.numlines_l[t]}for(r.npart_s=Y(r.numlines_s,r.bo_s,r.bm_s,h,d,r.mld_s,r.PSY.bo_s_weight,m,O.BLKSIZE_s,r.scalefac_band.s,O.BLKSIZE_s/384,O.SBMAX_s),v=0,t=0;t<r.npart_s;t++){var w,g=u;h[t]>=i&&(g=_*(h[t]-i)/(o-i)+u*(o-h[t])/(o-i)),p[t]=Math.pow(10,g/10),w=$.MAX_VALUE;for(var y=0;y<r.numlines_s[t];y++,v++){var R,S=m*v/(1e3*O.BLKSIZE_s);R=this.ATHformula(1e3*S,e)-20,R=Math.pow(10,.1*R),R*=r.numlines_s[t],w>R&&(w=R)}r.ATH.cb_s[t]=w,w=-7+7*h[t]/12,h[t]>12&&(w*=1+3.1*Math.log(1+w)),h[t]<12&&(w*=1+2.3*Math.log(1-w)),-15>w&&(w=-15),w-=8,r.minval_s[t]=Math.pow(10,w/10)*r.numlines_s[t]}r.s3_ss=F(r.s3ind_s,r.npart_s,h,d,p,a),s(),Z.init_fft(r),r.decay=Math.exp(-1*Q/(se*m/192));var A;A=fe,0!=(2&e.exp_nspsytune)&&(A=1),Math.abs(e.msfix)>0&&(A=e.msfix),e.msfix=A;for(var T=0;T<r.npart_l;T++)r.s3ind[T][1]>r.npart_l-1&&(r.s3ind[T][1]=r.npart_l-1);var E=576*r.mode_gr/m;if(r.ATH.decay=Math.pow(10,-1.2*E),r.ATH.adjust=.01,r.ATH.adjustLimit=1,-1!=e.ATHtype){var S,M=e.out_samplerate/O.BLKSIZE,B=0;for(S=0,t=0;t<O.BLKSIZE/2;++t)S+=M,r.ATH.eql_w[t]=1/Math.pow(10,this.ATHformula(S,e)/10),B+=r.ATH.eql_w[t];for(B=1/B,t=O.BLKSIZE/2;--t>=0;)r.ATH.eql_w[t]*=B}for(var T=v=0;T<r.npart_s;++T)for(t=0;t<r.numlines_s[T];++t)++v;for(var T=v=0;T<r.npart_l;++T)for(t=0;t<r.numlines_l[T];++t)++v;for(v=0,t=0;t<r.npart_l;t++){var S=m*(v+r.numlines_l[t]/2)/(1*O.BLKSIZE);r.mld_cb_l[t]=X(S),v+=r.numlines_l[t]}for(;t<O.CBANDS;++t)r.mld_cb_l[t]=1;for(v=0,t=0;t<r.npart_s;t++){var S=m*(v+r.numlines_s[t]/2)/(1*O.BLKSIZE_s);r.mld_cb_s[t]=X(S),v+=r.numlines_s[t]}for(;t<O.CBANDS;++t)r.mld_cb_s[t]=1;return 0},this.ATHformula=function(e,t){var r;switch(t.ATHtype){case 0:r=q(e,9);break;case 1:r=q(e,-1);break;case 2:r=q(e,0);break;case 3:r=q(e,1)+6;break;case 4:r=q(e,t.ATHcurve);break;default:r=q(e,0)}return r}}function Y(){function e(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=n(O.SBMAX_l),this.bo_s_weight=n(O.SBMAX_s)}function t(){this.lowerlimit=0}function r(e,t){this.lowpass=t}function a(e){var t;return e.class_id=$,t=e.internal_flags=new H,e.mode=u.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=f.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=O.ENCDELAY+O.POSTDELAY,e.encoder_padding=0,t.mf_size=O.ENCDELAY-O.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0,0}function i(e){return e>1?0:0>=e?1:Math.cos(Math.PI/2*e)}function l(e,t){var r=44100;return t>=48e3?r=48e3:t>=44100?r=44100:t>=32e3?r=32e3:t>=24e3?r=24e3:t>=22050?r=22050:t>=16e3?r=16e3:t>=12e3?r=12e3:t>=11025?r=11025:t>=8e3&&(r=8e3),-1==e?r:(15960>=e&&(r=44100),15250>=e&&(r=32e3),11220>=e&&(r=24e3),9970>=e&&(r=22050),7230>=e&&(r=16e3),5420>=e&&(r=12e3),4510>=e&&(r=11025),3970>=e&&(r=8e3),r>t?t>44100?48e3:t>32e3?44100:t>24e3?32e3:t>22050?24e3:t>16e3?22050:t>12e3?16e3:t>11025?12e3:t>8e3?11025:8e3:r)}function _(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:return t.version=0,0;case 24e3:return t.version=0,1;case 16e3:return t.version=0,2;case 11025:return t.version=0,0;case 12e3:return t.version=0,1;case 8e3:return t.version=0,2;default:return t.version=0,-1}}function h(e,t,r){16e3>r&&(t=2);for(var n=ee.bitrate_table[t][1],a=2;14>=a;a++)ee.bitrate_table[t][a]>0&&Math.abs(ee.bitrate_table[t][a]-e)<Math.abs(n-e)&&(n=ee.bitrate_table[t][a]);return n}function p(e,t,r){16e3>r&&(t=2);for(var n=0;14>=n;n++)if(ee.bitrate_table[t][n]>0&&ee.bitrate_table[t][n]==e)return n;return-1}function m(e,t){var n=[new r(8,2e3),new r(16,3700),new r(24,3900),new r(32,5500),new r(40,7e3),new r(48,7500),new r(56,1e4),new r(64,11e3),new r(80,13500),new r(96,15100),new r(112,15600),new r(128,17e3),new r(160,17500),new r(192,18600),new r(224,19400),new r(256,19700),new r(320,20500)],a=D.nearestBitrateFullIndex(t);e.lowerlimit=n[a].lowpass}function b(e){var t=e.internal_flags,r=32,n=-1;if(t.lowpass1>0){for(var a=999,s=0;31>=s;s++){var o=s/31;o>=t.lowpass2&&(r=Math.min(r,s)),t.lowpass1<o&&o<t.lowpass2&&(a=Math.min(a,s))}999==a?t.lowpass1=(r-.75)/31:t.lowpass1=(a-.75)/31,t.lowpass2=r/31}if(t.highpass2>0&&t.highpass2<.9*(.75/31)&&(t.highpass1=0,t.highpass2=0,Q.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),t.highpass2>0){for(var l=-1,s=0;31>=s;s++){var o=s/31;o<=t.highpass1&&(n=Math.max(n,s)),t.highpass1<o&&o<t.highpass2&&(l=Math.max(l,s))}t.highpass1=n/31,-1==l?t.highpass2=(n+.75)/31:t.highpass2=(l+.75)/31}for(var s=0;32>s;s++){var c,f,o=s/31;c=t.highpass2>t.highpass1?i((t.highpass2-o)/(t.highpass2-t.highpass1+1e-20)):1,f=t.lowpass2>t.lowpass1?i((o-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[s]=c*f}}function g(e){var t=e.internal_flags;switch(e.quality){default:case 9:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0}}function w(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&Z.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=s([16,5]),t.bitrate_blockType_Hist=s([16,6]),t.PeakSample=0,e.bWriteVbrTag&&G.InitVbrTag(e)}function y(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=n(t),e.in_buffer_1=n(t),e.in_buffer_nsamples=t)}function R(e){var t=O.BLKSIZE+e.framesize-O.FFTOFFSET;return t=Math.max(t,512+e.framesize-32)}function M(e,t,r,n,a,i,s){var o,l,c,f,u,_=e.internal_flags,h=0,p=[null,null],m=[null,null];if(_.Class_ID!=$)return-3;if(0==n)return 0;if(u=F.copy_buffer(_,a,i,s,0),0>u)return u;if(i+=u,h+=u,m[0]=t,m[1]=r,v.NEQ(e.scale,0)&&v.NEQ(e.scale,1))for(l=0;n>l;++l)m[0][l]*=e.scale,2==_.channels_out&&(m[1][l]*=e.scale);if(v.NEQ(e.scale_left,0)&&v.NEQ(e.scale_left,1))for(l=0;n>l;++l)m[0][l]*=e.scale_left;if(v.NEQ(e.scale_right,0)&&v.NEQ(e.scale_right,1))for(l=0;n>l;++l)m[1][l]*=e.scale_right;if(2==e.num_channels&&1==_.channels_out)for(l=0;n>l;++l)m[0][l]=.5*(m[0][l]+m[1][l]),m[1][l]=0;f=R(e),p[0]=_.mfbuf[0],p[1]=_.mfbuf[1];for(var b=0;n>0;){var g=[null,null],w=0,y=0;g[0]=m[0],g[1]=m[1];var S=new k;if(C(e,p,g,b,n,S),w=S.n_in,y=S.n_out,_.findReplayGain&&!_.decode_on_the_fly&&U.AnalyzeSamples(_.rgdata,p[0],_.mf_size,p[1],_.mf_size,y,_.channels_out)==d.GAIN_ANALYSIS_ERROR)return-6;if(n-=w,b+=w,2==_.channels_out,_.mf_size+=y,_.mf_samples_to_encode<1&&(_.mf_samples_to_encode=O.ENCDELAY+O.POSTDELAY),_.mf_samples_to_encode+=y,_.mf_size>=f){var A=s-h;if(0==s&&(A=0),o=B(e,p[0],p[1],a,i,A),0>o)return o;for(i+=o,h+=o,_.mf_size-=e.framesize,_.mf_samples_to_encode-=e.framesize,c=0;c<_.channels_out;c++)for(l=0;l<_.mf_size;l++)p[c][l]=p[c][l+e.framesize]}}return h}function B(e,t,r,n,a,i){var s=D.enc.lame_encode_mp3_frame(e,t,r,n,a,i);return e.frameNum++,s}function k(){this.n_in=0,this.n_out=0}function x(){this.num_used=0}function P(e,t){return 0!=t?P(t,e%t):e}function I(e,t,r){var n=Math.PI*t;e/=r,0>e&&(e=0),e>1&&(e=1);var a=e-.5,i=.42-.5*Math.cos(2*e*Math.PI)+.08*Math.cos(4*e*Math.PI);return Math.abs(a)<1e-9?n/Math.PI:i*Math.sin(r*n*a)/(Math.PI*r*a)}function L(e,t,r,a,i,s,o,l,c){var f,u,_=e.internal_flags,h=0,d=e.out_samplerate/P(e.out_samplerate,e.in_samplerate);d>H.BPC&&(d=H.BPC);var p=Math.abs(_.resample_ratio-Math.floor(.5+_.resample_ratio))<1e-4?1:0,m=1/_.resample_ratio;m>1&&(m=1);var v=31;0==v%2&&--v,v+=p;var b=v+1;if(0==_.fill_buffer_resample_init){for(_.inbuf_old[0]=n(b),_.inbuf_old[1]=n(b),f=0;2*d>=f;++f)_.blackfilt[f]=n(b);for(_.itime[0]=0,_.itime[1]=0,h=0;2*d>=h;h++){var g=0,w=(h-d)/(2*d);for(f=0;v>=f;f++)g+=_.blackfilt[h][f]=I(f-w,m,v);for(f=0;v>=f;f++)_.blackfilt[h][f]/=g}_.fill_buffer_resample_init=1}var y=_.inbuf_old[c];for(u=0;a>u;u++){var R,S;if(R=u*_.resample_ratio,h=0|Math.floor(R-_.itime[c]),v+h-v/2>=o)break;var w=R-_.itime[c]-(h+.5*(v%2));S=0|Math.floor(2*w*d+d+.5);var A=0;for(f=0;v>=f;++f){var T,E=f+h-v/2;T=0>E?y[b+E]:i[s+E],A+=T*_.blackfilt[S][f]}t[r+u]=A}if(l.num_used=Math.min(o,v+h-v/2),_.itime[c]+=l.num_used-u*_.resample_ratio,l.num_used>=b)for(f=0;b>f;f++)y[f]=i[s+l.num_used+f-b];else{var M=b-l.num_used;for(f=0;M>f;++f)y[f]=y[f+l.num_used];for(h=0;b>f;++f,++h)y[f]=i[s+h]}return u}function C(e,t,r,n,a,i){var s=e.internal_flags;if(s.resample_ratio<.9999||s.resample_ratio>1.0001)for(var o=0;o<s.channels_out;o++){var l=new x;i.n_out=L(e,t[o],s.mf_size,e.framesize,r[o],n,a,l,o),i.n_in=l.num_used}else{i.n_out=Math.min(e.framesize,a),i.n_in=i.n_out;for(var c=0;c<i.n_out;++c)t[0][s.mf_size+c]=r[0][n+c],2==s.channels_out&&(t[1][s.mf_size+c]=r[1][n+c])}}var D=this,N=131072;Y.V9=410,Y.V8=420,Y.V7=430,Y.V6=440,Y.V5=450,Y.V4=460,Y.V3=470,Y.V2=480,Y.V1=490,Y.V0=500,Y.R3MIX=1e3,Y.STANDARD=1001,Y.EXTREME=1002,Y.INSANE=1003,Y.STANDARD_FAST=1004,Y.EXTREME_FAST=1005,Y.MEDIUM=1006,Y.MEDIUM_FAST=1007;var V=16384+N;Y.LAME_MAXMP3BUFFER=V;var U,F,X,q,z,G,K,Z,W,J=new j;this.enc=new O,this.setModules=function(e,t,r,n,a,i,s,o,l){U=e,F=t,X=r,q=n,z=a,G=i,K=s,Z=o,W=l,this.enc.setModules(F,J,q,G)};var $=4294479419;this.lame_init=function(){var e=new S,t=a(e);return 0!=t?null:(e.lame_allocated_gfp=1,e)},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],r=0,n=0,a=0,i=0;i=t[16],a=16,n=t[16],r=16;for(var s=0;16>s;s++)if(Math.max(e,t[s+1])!=e){i=t[s+1],a=s+1,n=t[s],r=s;break}return i-e>e-n?r:a},this.lame_init_params=function(r){var n=r.internal_flags;if(n.Class_ID=0,null==n.ATH&&(n.ATH=new T),null==n.PSY&&(n.PSY=new e),null==n.rgdata&&(n.rgdata=new A),n.channels_in=r.num_channels,1==n.channels_in&&(r.mode=u.MONO),n.channels_out=r.mode==u.MONO?1:2,n.mode_ext=O.MPG_MD_MS_LR,r.mode==u.MONO&&(r.force_ms=!1),r.VBR==f.vbr_off&&128!=r.VBR_mean_bitrate_kbps&&0==r.brate&&(r.brate=r.VBR_mean_bitrate_kbps),r.VBR==f.vbr_off||r.VBR==f.vbr_mtrh||r.VBR==f.vbr_mt||(r.free_format=!1),r.VBR==f.vbr_off&&0==r.brate&&v.EQ(r.compression_ratio,0)&&(r.compression_ratio=11.025),r.VBR==f.vbr_off&&r.compression_ratio>0&&(0==r.out_samplerate&&(r.out_samplerate=map2MP3Frequency(int(.97*r.in_samplerate))),r.brate=0|16*r.out_samplerate*n.channels_out/(1e3*r.compression_ratio),n.samplerate_index=_(r.out_samplerate,r),r.free_format||(r.brate=h(r.brate,r.version,r.out_samplerate))),0!=r.out_samplerate&&(r.out_samplerate<16e3?(r.VBR_mean_bitrate_kbps=Math.max(r.VBR_mean_bitrate_kbps,8),r.VBR_mean_bitrate_kbps=Math.min(r.VBR_mean_bitrate_kbps,64)):r.out_samplerate<32e3?(r.VBR_mean_bitrate_kbps=Math.max(r.VBR_mean_bitrate_kbps,8),r.VBR_mean_bitrate_kbps=Math.min(r.VBR_mean_bitrate_kbps,160)):(r.VBR_mean_bitrate_kbps=Math.max(r.VBR_mean_bitrate_kbps,32),r.VBR_mean_bitrate_kbps=Math.min(r.VBR_mean_bitrate_kbps,320))),0==r.lowpassfreq){var a=16e3;switch(r.VBR){case f.vbr_off:var i=new t;m(i,r.brate),a=i.lowerlimit;break;case f.vbr_abr:var i=new t;m(i,r.VBR_mean_bitrate_kbps),a=i.lowerlimit;break;case f.vbr_rh:var s=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=r.VBR_q&&r.VBR_q<=9){var o=s[r.VBR_q],y=s[r.VBR_q+1],R=r.VBR_q_frac;a=linear_int(o,y,R)}else a=19500;break;default:var s=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=r.VBR_q&&r.VBR_q<=9){var o=s[r.VBR_q],y=s[r.VBR_q+1],R=r.VBR_q_frac;a=linear_int(o,y,R)}else a=19500}r.mode!=u.MONO||r.VBR!=f.vbr_off&&r.VBR!=f.vbr_abr||(a*=1.5),r.lowpassfreq=0|a}if(0==r.out_samplerate&&(2*r.lowpassfreq>r.in_samplerate&&(r.lowpassfreq=r.in_samplerate/2),r.out_samplerate=l(0|r.lowpassfreq,r.in_samplerate)),r.lowpassfreq=Math.min(20500,r.lowpassfreq),r.lowpassfreq=Math.min(r.out_samplerate/2,r.lowpassfreq),r.VBR==f.vbr_off&&(r.compression_ratio=16*r.out_samplerate*n.channels_out/(1e3*r.brate)),r.VBR==f.vbr_abr&&(r.compression_ratio=16*r.out_samplerate*n.channels_out/(1e3*r.VBR_mean_bitrate_kbps)),r.bWriteVbrTag||(r.findReplayGain=!1,r.decode_on_the_fly=!1,n.findPeakSample=!1),n.findReplayGain=r.findReplayGain,n.decode_on_the_fly=r.decode_on_the_fly,n.decode_on_the_fly&&(n.findPeakSample=!0),n.findReplayGain&&U.InitGainAnalysis(n.rgdata,r.out_samplerate)==d.INIT_GAIN_ANALYSIS_ERROR)return r.internal_flags=null,-6;switch(n.decode_on_the_fly&&!r.decode_only&&(null!=n.hip&&W.hip_decode_exit(n.hip),n.hip=W.hip_decode_init()),n.mode_gr=r.out_samplerate<=24e3?1:2,r.framesize=576*n.mode_gr,r.encoder_delay=O.ENCDELAY,n.resample_ratio=r.in_samplerate/r.out_samplerate,r.VBR){case f.vbr_mt:case f.vbr_rh:case f.vbr_mtrh:var S=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];r.compression_ratio=S[r.VBR_q];break;case f.vbr_abr:r.compression_ratio=16*r.out_samplerate*n.channels_out/(1e3*r.VBR_mean_bitrate_kbps);break;default:r.compression_ratio=16*r.out_samplerate*n.channels_out/(1e3*r.brate)}if(r.mode==u.NOT_SET&&(r.mode=u.JOINT_STEREO),r.highpassfreq>0?(n.highpass1=2*r.highpassfreq,r.highpasswidth>=0?n.highpass2=2*(r.highpassfreq+r.highpasswidth):n.highpass2=2*r.highpassfreq,n.highpass1/=r.out_samplerate,n.highpass2/=r.out_samplerate):(n.highpass1=0,n.highpass2=0),r.lowpassfreq>0?(n.lowpass2=2*r.lowpassfreq,r.lowpasswidth>=0?(n.lowpass1=2*(r.lowpassfreq-r.lowpasswidth),n.lowpass1<0&&(n.lowpass1=0)):n.lowpass1=2*r.lowpassfreq,n.lowpass1/=r.out_samplerate,n.lowpass2/=r.out_samplerate):(n.lowpass1=0,n.lowpass2=0),b(r),n.samplerate_index=_(r.out_samplerate,r),n.samplerate_index<0)return r.internal_flags=null,-1;if(r.VBR==f.vbr_off){if(r.free_format)n.bitrate_index=0;else if(r.brate=h(r.brate,r.version,r.out_samplerate),n.bitrate_index=p(r.brate,r.version,r.out_samplerate),n.bitrate_index<=0)return r.internal_flags=null,-1}else n.bitrate_index=1;r.analysis&&(r.bWriteVbrTag=!1),null!=n.pinfo&&(r.bWriteVbrTag=!1),F.init_bit_stream_w(n);for(var M=n.samplerate_index+3*r.version+6*(r.out_samplerate<16e3?1:0),B=0;B<O.SBMAX_l+1;B++)n.scalefac_band.l[B]=q.sfBandIndex[M].l[B];for(var B=0;B<O.PSFB21+1;B++){var k=(n.scalefac_band.l[22]-n.scalefac_band.l[21])/O.PSFB21,x=n.scalefac_band.l[21]+B*k;n.scalefac_band.psfb21[B]=x}n.scalefac_band.psfb21[O.PSFB21]=576;for(var B=0;B<O.SBMAX_s+1;B++)n.scalefac_band.s[B]=q.sfBandIndex[M].s[B];for(var B=0;B<O.PSFB12+1;B++){var k=(n.scalefac_band.s[13]-n.scalefac_band.s[12])/O.PSFB12,x=n.scalefac_band.s[12]+B*k;n.scalefac_band.psfb12[B]=x}n.scalefac_band.psfb12[O.PSFB12]=192,1==r.version?n.sideinfo_len=1==n.channels_out?21:36:n.sideinfo_len=1==n.channels_out?13:21,r.error_protection&&(n.sideinfo_len+=2),w(r),n.Class_ID=$;var P;for(P=0;19>P;P++)n.nsPsy.pefirbuf[P]=700*n.mode_gr*n.channels_out;switch(-1==r.ATHtype&&(r.ATHtype=4),r.VBR){case f.vbr_mt:r.VBR=f.vbr_mtrh;case f.vbr_mtrh:null==r.useTemporal&&(r.useTemporal=!1),X.apply_preset(r,500-10*r.VBR_q,0),r.quality<0&&(r.quality=LAME_DEFAULT_QUALITY),r.quality<5&&(r.quality=0),r.quality>5&&(r.quality=5),n.PSY.mask_adjust=r.maskingadjust,n.PSY.mask_adjust_short=r.maskingadjust_short,r.experimentalY?n.sfb21_extra=!1:n.sfb21_extra=r.out_samplerate>44e3,n.iteration_loop=new VBRNewIterationLoop(z);break;case f.vbr_rh:X.apply_preset(r,500-10*r.VBR_q,0),n.PSY.mask_adjust=r.maskingadjust,n.PSY.mask_adjust_short=r.maskingadjust_short,r.experimentalY?n.sfb21_extra=!1:n.sfb21_extra=r.out_samplerate>44e3,r.quality>6&&(r.quality=6),r.quality<0&&(r.quality=LAME_DEFAULT_QUALITY),n.iteration_loop=new VBROldIterationLoop(z);break;default:var I;n.sfb21_extra=!1,r.quality<0&&(r.quality=LAME_DEFAULT_QUALITY),I=r.VBR,I==f.vbr_off&&(r.VBR_mean_bitrate_kbps=r.brate),X.apply_preset(r,r.VBR_mean_bitrate_kbps,0),r.VBR=I,n.PSY.mask_adjust=r.maskingadjust,n.PSY.mask_adjust_short=r.maskingadjust_short,I==f.vbr_off?n.iteration_loop=new E(z):n.iteration_loop=new ABRIterationLoop(z)}if(r.VBR!=f.vbr_off){if(n.VBR_min_bitrate=1,n.VBR_max_bitrate=14,r.out_samplerate<16e3&&(n.VBR_max_bitrate=8),0!=r.VBR_min_bitrate_kbps&&(r.VBR_min_bitrate_kbps=h(r.VBR_min_bitrate_kbps,r.version,r.out_samplerate),n.VBR_min_bitrate=p(r.VBR_min_bitrate_kbps,r.version,r.out_samplerate),n.VBR_min_bitrate<0))return-1;if(0!=r.VBR_max_bitrate_kbps&&(r.VBR_max_bitrate_kbps=h(r.VBR_max_bitrate_kbps,r.version,r.out_samplerate),n.VBR_max_bitrate=p(r.VBR_max_bitrate_kbps,r.version,r.out_samplerate),n.VBR_max_bitrate<0))return-1;r.VBR_min_bitrate_kbps=ee.bitrate_table[r.version][n.VBR_min_bitrate],r.VBR_max_bitrate_kbps=ee.bitrate_table[r.version][n.VBR_max_bitrate],r.VBR_mean_bitrate_kbps=Math.min(ee.bitrate_table[r.version][n.VBR_max_bitrate],r.VBR_mean_bitrate_kbps),r.VBR_mean_bitrate_kbps=Math.max(ee.bitrate_table[r.version][n.VBR_min_bitrate],r.VBR_mean_bitrate_kbps)}return r.tune&&(n.PSY.mask_adjust+=r.tune_value_a,n.PSY.mask_adjust_short+=r.tune_value_a),g(r),r.athaa_type<0?n.ATH.useAdjust=3:n.ATH.useAdjust=r.athaa_type,n.ATH.aaSensitivityP=Math.pow(10,r.athaa_sensitivity/-10),null==r.short_blocks&&(r.short_blocks=c.short_block_allowed),r.short_blocks!=c.short_block_allowed||r.mode!=u.JOINT_STEREO&&r.mode!=u.STEREO||(r.short_blocks=c.short_block_coupled),r.quant_comp<0&&(r.quant_comp=1),r.quant_comp_short<0&&(r.quant_comp_short=0),r.msfix<0&&(r.msfix=0),r.exp_nspsytune=1|r.exp_nspsytune,r.internal_flags.nsPsy.attackthre<0&&(r.internal_flags.nsPsy.attackthre=j.NSATTACKTHRE),r.internal_flags.nsPsy.attackthre_s<0&&(r.internal_flags.nsPsy.attackthre_s=j.NSATTACKTHRE_S),r.scale<0&&(r.scale=1),r.ATHtype<0&&(r.ATHtype=4),r.ATHcurve<0&&(r.ATHcurve=4),r.athaa_loudapprox<0&&(r.athaa_loudapprox=2),r.interChRatio<0&&(r.interChRatio=0),null==r.useTemporal&&(r.useTemporal=!0),n.slot_lag=n.frac_SpF=0,r.VBR==f.vbr_off&&(n.slot_lag=n.frac_SpF=72e3*(r.version+1)*r.brate%r.out_samplerate|0),q.iteration_init(r),J.psymodel_init(r),0},this.lame_encode_flush=function(e,t,r,n){var a,i,s,l,c=e.internal_flags,f=o([2,1152]),u=0,_=c.mf_samples_to_encode-O.POSTDELAY,h=R(e);if(c.mf_samples_to_encode<1)return 0;for(a=0,e.in_samplerate!=e.out_samplerate&&(_+=16*e.out_samplerate/e.in_samplerate),
s=e.framesize-_%e.framesize,576>s&&(s+=e.framesize),e.encoder_padding=s,l=(_+s)/e.framesize;l>0&&u>=0;){var d=h-c.mf_size,p=e.frameNum;d*=e.in_samplerate,d/=e.out_samplerate,d>1152&&(d=1152),1>d&&(d=1),i=n-a,0==n&&(i=0),u=this.lame_encode_buffer(e,f[0],f[1],d,t,r,i),r+=u,a+=u,l-=p!=e.frameNum?1:0}if(c.mf_samples_to_encode=0,0>u)return u;if(i=n-a,0==n&&(i=0),F.flush_bitstream(e),u=F.copy_buffer(c,t,r,i,1),0>u)return u;if(r+=u,a+=u,i=n-a,0==n&&(i=0),e.write_id3tag_automatic){if(Z.id3tag_write_v1(e),u=F.copy_buffer(c,t,r,i,0),0>u)return u;a+=u}return a},this.lame_encode_buffer=function(e,t,r,n,a,i,s){var o=e.internal_flags,l=[null,null];if(o.Class_ID!=$)return-3;if(0==n)return 0;y(o,n),l[0]=o.in_buffer_0,l[1]=o.in_buffer_1;for(var c=0;n>c;c++)l[0][c]=t[c],o.channels_in>1&&(l[1][c]=r[c]);return M(e,l[0],l[1],n,a,i,s)}}function F(){var e,t;this.setModules=function(r,n){e=r,t=n}}function X(){var e,t,r;this.setModules=function(n,a,i){e=n,t=a,r=i}}function q(){}function z(){var e,t;this.setModules=function(r,n){e=r,t=n}}function G(t,r,n){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),t=1,r=44100,n=128);var a=new Y,i=new F,s=new d,o=new v,l=new h,c=new B,f=new P,g=new b,w=new _,y=new z,R=new m,S=new p,A=new X,T=new q;a.setModules(s,o,l,c,f,g,w,y,T),o.setModules(s,T,w,g),y.setModules(o,w),l.setModules(a),f.setModules(o,R,c,S),c.setModules(S,R,a.enc.psy),R.setModules(o),S.setModules(c),g.setModules(a,o,w),i.setModules(A,T),A.setModules(w,y,l);var E=a.lame_init();E.num_channels=t,E.in_samplerate=r,E.brate=n,E.mode=u.STEREO,E.quality=3,E.bWriteVbrTag=!1,E.disable_reservoir=!0,E.write_id3tag_automatic=!1;var M=(a.lame_init_params(E),1152),k=0|1.25*M+7200,x=e(k);this.encodeBuffer=function(r,n){1==t&&(n=r),r.length>M&&(M=r.length,k=0|1.25*M+7200,x=e(k));var i=a.lame_encode_buffer(E,r,n,r.length,x,0,k);return new Int8Array(x.subarray(0,i))},this.flush=function(){var e=a.lame_encode_flush(E,x,0,k);return new Int8Array(x.subarray(0,e))}}function K(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function Z(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}var W={};W.fill=function(e,t,r,n){if(2==arguments.length)for(var a=0;a<e.length;a++)e[a]=arguments[1];else for(var a=t;r>a;a++)e[a]=n};var Q={};Q.arraycopy=function(e,t,r,n,a){for(var i=t+a;i>t;)r[n++]=e[t++]};var J={};J.SQRT2=1.4142135623730951,J.FAST_LOG10=function(e){return Math.log10(e)},J.FAST_LOG10_X=function(e,t){return Math.log10(e)*t},c.short_block_allowed=new c(0),c.short_block_coupled=new c(1),c.short_block_dispensed=new c(2),c.short_block_forced=new c(3);var $={};$.MAX_VALUE=3.4028235e38,f.vbr_off=new f(0),f.vbr_mt=new f(1),f.vbr_rh=new f(2),f.vbr_abr=new f(3),f.vbr_mtrh=new f(4),f.vbr_default=f.vbr_mtrh;u.STEREO=new u(0),u.JOINT_STEREO=new u(1),u.DUAL_CHANNEL=new u(2),u.MONO=new u(3),u.NOT_SET=new u(4),d.STEPS_per_dB=100,d.MAX_dB=120,d.GAIN_NOT_ENOUGH_SAMPLES=-24601,d.GAIN_ANALYSIS_ERROR=0,d.GAIN_ANALYSIS_OK=1,d.INIT_GAIN_ANALYSIS_ERROR=0,d.INIT_GAIN_ANALYSIS_OK=1,d.YULE_ORDER=10,d.MAX_ORDER=d.YULE_ORDER,d.MAX_SAMP_FREQ=48e3,d.RMS_WINDOW_TIME_NUMERATOR=1,d.RMS_WINDOW_TIME_DENOMINATOR=20,d.MAX_SAMPLES_PER_WINDOW=d.MAX_SAMP_FREQ*d.RMS_WINDOW_TIME_NUMERATOR/d.RMS_WINDOW_TIME_DENOMINATOR+1,v.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=1e-6*Math.abs(e):Math.abs(e-t)<=1e-6*Math.abs(t)},v.NEQ=function(e,t){return!v.EQ(e,t)},b.NUMTOCENTRIES=100,b.MAXFRAMESIZE=2880;var ee={};ee.t1HB=[1,1,1,0],ee.t2HB=[1,2,1,3,1,1,3,2,0],ee.t3HB=[3,2,1,1,1,1,3,2,0],ee.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],ee.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],ee.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],ee.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],ee.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],ee.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],ee.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],ee.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],ee.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],ee.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],ee.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],ee.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],ee.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],ee.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],ee.t1l=[1,4,3,5],ee.t2l=[1,4,7,4,5,7,6,7,8],ee.t3l=[2,3,7,4,4,7,6,7,8],ee.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],ee.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],ee.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],ee.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],ee.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],ee.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],ee.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],ee.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],ee.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],ee.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],ee.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],ee.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],ee.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],ee.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],ee.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],ee.ht=[new g(0,0,null,null),new g(2,0,ee.t1HB,ee.t1l),new g(3,0,ee.t2HB,ee.t2l),new g(3,0,ee.t3HB,ee.t3l),new g(0,0,null,null),new g(4,0,ee.t5HB,ee.t5l),new g(4,0,ee.t6HB,ee.t6l),new g(6,0,ee.t7HB,ee.t7l),new g(6,0,ee.t8HB,ee.t8l),new g(6,0,ee.t9HB,ee.t9l),new g(8,0,ee.t10HB,ee.t10l),new g(8,0,ee.t11HB,ee.t11l),new g(8,0,ee.t12HB,ee.t12l),new g(16,0,ee.t13HB,ee.t13l),new g(0,0,null,ee.t16_5l),new g(16,0,ee.t15HB,ee.t15l),new g(1,1,ee.t16HB,ee.t16l),new g(2,3,ee.t16HB,ee.t16l),new g(3,7,ee.t16HB,ee.t16l),new g(4,15,ee.t16HB,ee.t16l),new g(6,63,ee.t16HB,ee.t16l),new g(8,255,ee.t16HB,ee.t16l),new g(10,1023,ee.t16HB,ee.t16l),new g(13,8191,ee.t16HB,ee.t16l),new g(4,15,ee.t24HB,ee.t24l),new g(5,31,ee.t24HB,ee.t24l),new g(6,63,ee.t24HB,ee.t24l),new g(7,127,ee.t24HB,ee.t24l),new g(8,255,ee.t24HB,ee.t24l),new g(9,511,ee.t24HB,ee.t24l),new g(11,2047,ee.t24HB,ee.t24l),new g(13,8191,ee.t24HB,ee.t24l),new g(0,0,ee.t32HB,ee.t32l),new g(0,0,ee.t33HB,ee.t33l)],ee.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],ee.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],ee.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],ee.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],ee.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],ee.scfsi_band=[0,6,11,16,21],B.Q_MAX=257,B.Q_MAX2=116,B.LARGE_BITS=1e5,B.IXMAX_VAL=8206;var te={};te.SFBMAX=3*O.SBMAX_s,O.ENCDELAY=576,O.POSTDELAY=1152,O.MDCTDELAY=48,O.FFTOFFSET=224+O.MDCTDELAY,O.DECDELAY=528,O.SBLIMIT=32,O.CBANDS=64,O.SBPSY_l=21,O.SBPSY_s=12,O.SBMAX_l=22,O.SBMAX_s=13,O.PSFB21=6,O.PSFB12=6,O.BLKSIZE=1024,O.HBLKSIZE=O.BLKSIZE/2+1,O.BLKSIZE_s=256,O.HBLKSIZE_s=O.BLKSIZE_s/2+1,O.NORM_TYPE=0,O.START_TYPE=1,O.SHORT_TYPE=2,O.STOP_TYPE=3,O.MPG_MD_LR_LR=0,O.MPG_MD_LR_I=1,O.MPG_MD_MS_LR=2,O.MPG_MD_MS_I=3,O.fircoef=[-0.1039435,-0.1892065,5*-.0432472,-0.155915,3.898045e-17,.0467745*5,.50455,.756825,.187098*5],H.MFSIZE=3456+O.ENCDELAY-O.MDCTDELAY,H.MAX_HEADER_BUF=256,H.MAX_BITS_PER_CHANNEL=4095,H.MAX_BITS_PER_GRANULE=7680,H.BPC=320,K.RIFF=Z("RIFF"),K.WAVE=Z("WAVE"),K.fmt_=Z("fmt "),K.data=Z("data"),K.readHeader=function(e){var t=new K,r=e.getUint32(0,!1);if(K.RIFF==r){e.getUint32(4,!0);if(K.WAVE==e.getUint32(8,!1)&&K.fmt_==e.getUint32(12,!1)){var n=e.getUint32(16,!0),a=20;switch(n){case 16:case 18:t.channels=e.getUint16(a+2,!0),t.sampleRate=e.getUint32(a+4,!0);break;default:throw"extended fmt chunk not implemented"}a+=n;for(var i=K.data,s=0;i!=r&&(r=e.getUint32(a,!1),s=e.getUint32(a+4,!0),i!=r);)a+=s+8;return t.dataLen=s,t.dataOffset=a+8,t}}},te.SFBMAX=3*O.SBMAX_s,this.Mp3Encoder=G,this.WavHeader=K}e.exports=r}).call(t,r(2).Buffer)},function(e,t,r){/**
	 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a JavaScript-based media-recording library for modern web-browsers (supporting WebRTC getUserMedia API). It is optimized for different devices and browsers to bring all client-side (pluginfree) recording solutions in single place.
	 * @summary JavaScript audio/video recording library runs top over WebRTC getUserMedia API.
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @typedef RecordRTC
	 * @class
	 * @example
	 * var recordRTC = RecordRTC(mediaStream, {
	 *     type: 'video' // audio or video or gif or canvas
	 * });
	 *
	 * // or, you can even use keyword "new"
	 * var recordRTC = new RecordRTC(mediaStream[, config]);
	 * @see For further information:
	 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
	 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
	 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
	 */
function n(e,t){function r(){return t.disableLogs||console.debug("started recording "+t.type+" stream."),p?(p.clearRecordedData(),p.resume(),m.recordingDuration&&d(),m):(s(function(){m.recordingDuration&&d()}),m)}function s(r){t.disableLogs||console.debug("initializing "+t.type+" stream recorder."),r&&(t.initCallback=function(){r(),r=t.initCallback=null});var n=new i(e,t);p=new n(e,t),p.record()}function c(e){function r(){for(var r in p)m&&(m[r]=p[r]),n&&(n[r]=p[r]);var a=p.blob;if(e){var i=w.createObjectURL(a);e(i)}a&&!t.disableLogs&&console.debug(a.type,"->",o(a.size)),t.autoWriteToDisk&&h(function(e){var r={};r[t.type+"Blob"]=e,M.Store(r)})}if(!p)return console.warn(v);var n=this;t.disableLogs||console.warn("Stopped recording "+t.type+" stream."),"gif"!==t.type?p.stop(r):(p.stop(),r())}function f(){return p?(p.pause(),void(t.disableLogs||console.debug("Paused recording."))):console.warn(v)}function u(){return p?(p.resume(),void(t.disableLogs||console.debug("Resumed recording."))):console.warn(v)}function _(e){postMessage((new FileReaderSync).readAsDataURL(e))}function h(e,r){function n(e){var t=w.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"})),r=new Worker(t);return w.revokeObjectURL(t),r}if(!e)throw"Pass a callback function over getDataURL.";var a=r?r.blob:p.blob;if(!a)return t.disableLogs||console.warn("Blob encoder did not yet finished its job."),void setTimeout(function(){h(e,r)},1e3);if("undefined"==typeof Worker||navigator.mozGetUserMedia){var i=new FileReader;i.readAsDataURL(a),i.onload=function(t){e(t.target.result)}}else{var s=n(_);s.onmessage=function(t){e(t.data)},s.postMessage(a)}}function d(){setTimeout(function(){c(m.onRecordingStopped)},m.recordingDuration)}if(!e)throw"MediaStream is mandatory.";t=new a(e,t);var p,m=this,v='It seems that "startRecording" is not invoked for '+t.type+" recorder.",b={startRecording:r,stopRecording:c,pauseRecording:f,resumeRecording:u,initRecorder:s,setRecordingDuration:function(e,t){if("undefined"==typeof e)throw"milliseconds is required.";if("number"!=typeof e)throw"milliseconds must be a number.";return m.recordingDuration=e,m.onRecordingStopped=t||function(){},{onRecordingStopped:function(e){m.onRecordingStopped=e}}},clearRecordedData:function(){return p?(p.clearRecordedData(),void(t.disableLogs||console.debug("Cleared old recorded data."))):console.warn(v)},getBlob:function(){return p?p.blob:console.warn(v)},getDataURL:h,toURL:function(){return p?w.createObjectURL(p.blob):console.warn(v)},save:function(e){return p?void l(p.blob,e):console.warn(v)},getFromDisk:function(e){return p?void n.getFromDisk(t.type,e):console.warn(v)},setAdvertisementArray:function(e){t.advertisement=[];for(var r=e.length,n=0;r>n;n++)t.advertisement.push({duration:n,image:e[n]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,view:null};if(!this)return m=b,b;for(var g in b)this[g]=b[g];return m=this,b}/**
	 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
	 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @typedef RecordRTCConfiguration
	 * @class
	 * @example
	 * var options = RecordRTCConfiguration(mediaStream, options);
	 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
	 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
	 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
	 */
function a(e,t){return t.recorderType&&!t.type&&(t.recorderType===h||t.recorderType===_?t.type="video":t.recorderType===d?t.type="gif":t.recorderType===u?t.type="audio":t.recorderType===f&&(e.getAudioTracks().length&&e.getVideoTracks().length?t.type="video":e.getAudioTracks().length&&!e.getVideoTracks().length?t.type="audio":!e.getAudioTracks().length&&e.getVideoTracks().length&&(t.type="audio"))),"undefined"!=typeof f&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),!t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}/**
	 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
	 * @summary It returns best recorder-type available for your browser.
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @typedef GetRecorderType
	 * @class
	 * @example
	 * var RecorderType = GetRecorderType(options);
	 * var recorder = new RecorderType(options);
	 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
	 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
	 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
	 */
function i(e,t){var r;return(S||y||R)&&(r=u),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!S&&(r=f),"video"===t.type&&(S||R)&&(r=h),"gif"===t.type&&(r=d),"canvas"===t.type&&(r=_),c()&&S&&r!==_&&r!==d&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&e.getVideoTracks().length&&(r=f),t.recorderType&&(r=t.recorderType),!t.disableLogs&&S&&r===f&&console.debug("Using MediaRecorder API in chrome!"),r}/**
	 * MRecordRTC runs top over {@link RecordRTC} to bring multiple recordings in single place, by providing simple API.
	 * @summary MRecordRTC stands for "Multiple-RecordRTC".
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @typedef MRecordRTC
	 * @class
	 * @example
	 * var recorder = new MRecordRTC();
	 * recorder.addStream(MediaStream);
	 * recorder.mediaType = {
	 *     audio: true,
	 *     video: true,
	 *     gif: true
	 * };
	 * recorder.startRecording();
	 * @see For further information:
	 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
	 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
	 */
function s(e){this.addStream=function(t){t&&(e=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t,r=this.mediaType;if("function"!=typeof r.audio&&c()&&e&&e.getAudioTracks&&e.getAudioTracks().length&&e.getVideoTracks().length&&(this.mediaType.audio=!1),r.audio&&("function"==typeof r.audio&&(t=r.audio),this.audioRecorder=new n(e,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:t}),r.video||this.audioRecorder.startRecording()),r.video&&("function"==typeof r.video&&(t=r.video),this.videoRecorder=new n(e,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:t}),r.audio||this.videoRecorder.startRecording()),r.audio&&r.video){var a=this;a.videoRecorder.initRecorder(function(){a.audioRecorder.initRecorder(function(){a.videoRecorder.startRecording(),a.audioRecorder.startRecording()})})}r.gif&&("function"==typeof r.gif&&(t=r.gif),this.gifRecorder=new n(e,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:t}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(t){e(t,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(t){e(t,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(t){e(t,"gif")})},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.getDataURL=function(e){function t(e,t){if("undefined"!=typeof Worker){var n=r(function(e){postMessage((new FileReaderSync).readAsDataURL(e))});n.onmessage=function(e){t(e.data)},n.postMessage(e)}else{var a=new FileReader;a.readAsDataURL(e),a.onload=function(e){t(e.target.result)}}}function r(e){var t,r=w.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"})),n=new Worker(r);if("undefined"!=typeof w)t=w;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";t=webkitURL}return t.revokeObjectURL(r),n}this.getBlob(function(r){t(r.audio,function(n){t(r.video,function(t){e({audio:n,video:t})})})})},this.writeToDisk=function(){n.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},e.audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof e.audio?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof e.gif?e.gif:"")}}function o(e){var t=1e3,r=["Bytes","KB","MB","GB","TB"];if(0===e)return"0 Bytes";var n=parseInt(Math.floor(Math.log(e)/Math.log(t)),10);return(e/Math.pow(t,n)).toPrecision(3)+" "+r[n]}function l(e,t){if(!e)throw"Blob object is required.";e.type||(e.type="video/webm");var r=e.type.split("/")[1];if(t&&-1!==t.indexOf(".")){var n=t.split(".");t=n[0],r=n[1]}var a=(t||Math.round(9999999999*Math.random())+888888888)+"."+r;if("undefined"!=typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,a);if("undefined"!=typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,a);var i=document.createElement("a");i.href=w.createObjectURL(e),i.target="_blank",i.download=a,navigator.mozGetUserMedia&&(i.onclick=function(){(document.body||document.documentElement).removeChild(i)},(document.body||document.documentElement).appendChild(i));var s=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(s),navigator.mozGetUserMedia||w.revokeObjectURL(i.href)}function c(){var e=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t=!!window.chrome&&!e,r="undefined"!=typeof window.InstallTrigger;if(r)return!0;if(!t)return!1;var n,a,i=(navigator.appVersion,navigator.userAgent),s=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10);return t&&(n=i.indexOf("Chrome"),s=i.substring(n+7)),-1!==(a=s.indexOf(";"))&&(s=s.substring(0,a)),-1!==(a=s.indexOf(" "))&&(s=s.substring(0,a)),o=parseInt(""+s,10),isNaN(o)&&(s=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10)),o>=49}/**
	 * MediaStreamRecorder is an abstraction layer for "MediaRecorder API". It is used by {@link RecordRTC} to record MediaStream(s) in Firefox.
	 * @summary Runs top over MediaRecorder API.
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @typedef MediaStreamRecorder
	 * @class
	 * @example
	 * var options = {
	 *     mimeType: 'video/mp4', // audio/ogg or video/webm
	 *     audioBitsPerSecond : 256 * 8 * 1024,
	 *     videoBitsPerSecond : 256 * 8 * 1024,
	 *     bitsPerSecond: 256 * 8 * 1024  // if this is provided, skip above two
	 * }
	 * var recorder = new MediaStreamRecorder(MediaStream, options);
	 * recorder.record();
	 * recorder.stop(function(blob) {
	 *     video.src = URL.createObjectURL(blob);
	 *
	 *     // or
	 *     var blob = recorder.blob;
	 * });
	 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
	 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
	 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", onAudioProcessStarted: function}
	 */
function f(e,t){function r(e,t){var r=new Blob(e,{type:"video/webm"}),n=new FileReader;n.onload=function(){t(n.result)},n.readAsDataURL(r)}function n(e){for(var t=atob(e.split(",")[1]),r=[],n=0;n<t.length;n++)r.push(t.charCodeAt(n));var a=window.File||window.Blob;return new a([new Uint8Array(r)],"recorded-video.webm",{type:"video/webm"})}function a(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1}var i=this;if(t=t||{mimeType:"video/webm"},navigator.mozGetUserMedia&&t.type&&"audio"===t.type){if(e.getVideoTracks&&e.getVideoTracks().length){var s=new g,o=s.createMediaStreamSource(e),l=s.createMediaStreamDestination();o.connect(l),e=l.stream}t.mimeType&&-1!==t.mimeType.indexOf("audio")||(t.mimeType="audio/ogg")}var f=[];this.record=function(){var r=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",r),u&&(u=null),S&&!c()&&(r="video/vp8"),u=new MediaRecorder(e,r),"canRecordMimeType"in u&&u.canRecordMimeType(t.mimeType)===!1&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",t.mimeType)),u.ignoreMutedMedia=t.ignoreMutedMedia||!1,u.ondataavailable=function(e){i.dontFireOnDataAvailableEvent||e.data&&e.data.size&&f.push(e.data)},u.onerror=function(e){t.disableLogs||("InvalidState"===e.name?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed."):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute."):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute."):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute."):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),"inactive"!==u.state&&"stopped"!==u.state&&u.stop()},u.start(1),t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback()},this.stop=function(e){u&&(this.recordingCallback=e||function(){},"recording"===u.state&&(u.requestData(),u.stop()),f.length&&this.onRecordingFinished())},this.onRecordingFinished=function(){var e=this;r(f,function(r){n(r);e.blob=new Blob(f,{type:t.mimeType||"video/webm"}),e.recordingCallback(),f=[]})},this.pause=function(){u&&"recording"===u.state&&u.pause()},this.resume=function(){return this.dontFireOnDataAvailableEvent?(this.dontFireOnDataAvailableEvent=!1,void this.record()):void(u&&"paused"===u.state&&u.resume())},this.clearRecordedData=function(){u&&(this.pause(),this.dontFireOnDataAvailableEvent=!0,this.stop())};var u,i=this;!function _(){return u?a()===!1?void i.stop():void setTimeout(_,1e3):void 0}()}/**
	 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
	 * @summary JavaScript standalone object for stereo audio recording.
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @typedef StereoAudioRecorder
	 * @class
	 * @example
	 * var recorder = new StereoAudioRecorder(MediaStream, {
	 *     sampleRate: 44100,
	 *     bufferSize: 4096
	 * });
	 * recorder.record();
	 * recorder.stop(function(blob) {
	 *     video.src = URL.createObjectURL(blob);
	 * });
	 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
	 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
	 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
	 */
function u(e,t){function r(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1}function n(e,t){function r(e,t){function r(e,t){for(var r=new Float64Array(t),n=0,a=e.length,i=0;a>i;i++){var s=e[i];r.set(s,n),n+=s.length}return r}function n(e,t){for(var r=e.length+t.length,n=new Float64Array(r),a=0,i=0;r>i;)n[i++]=e[a],n[i++]=t[a],a++;return n}function a(e,t,r){for(var n=r.length,a=0;n>a;a++)e.setUint8(t+a,r.charCodeAt(a))}var i=e.numberOfAudioChannels,s=e.leftBuffers.slice(0),o=e.rightBuffers.slice(0),l=e.sampleRate,c=e.internalInterleavedLength;2===i&&(s=r(s,c),o=r(o,c)),1===i&&(s=r(s,c));var f;2===i&&(f=n(s,o)),1===i&&(f=s);var u=f.length,_=44+2*u,h=new ArrayBuffer(_),d=new DataView(h);a(d,0,"RIFF"),d.setUint32(4,44+2*u,!0),a(d,8,"WAVE"),a(d,12,"fmt "),d.setUint32(16,16,!0),d.setUint16(20,1,!0),d.setUint16(22,i,!0),d.setUint32(24,l,!0),d.setUint32(28,2*l,!0),d.setUint16(32,2*i,!0),d.setUint16(34,16,!0),a(d,36,"data"),d.setUint32(40,2*u,!0);for(var p=u,m=44,v=1,b=0;p>b;b++)d.setInt16(m,f[b]*(32767*v),!0),m+=2;return t?t({buffer:h,view:d}):void postMessage({buffer:h,view:d})}if(!S)return void r(e,function(e){t(e.buffer,e.view)});var n=a(r);n.onmessage=function(e){t(e.data.buffer,e.data.view),w.revokeObjectURL(n.workerURL)},n.postMessage(e)}function a(e){var t=w.createObjectURL(new Blob([e.toString(),";this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"})),r=new Worker(t);return r.workerURL=t,r}function i(e){if(!b){if(r()===!1&&(t.disableLogs||console.error("MediaStream seems stopped."),s.disconnect(),f=!1),!f)return void d.disconnect();g||(g=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var n=e.inputBuffer.getChannelData(0);if(l.push(new Float32Array(n)),2===_){var a=e.inputBuffer.getChannelData(1);c.push(new Float32Array(a))}u+=m}}if(!e.getAudioTracks().length)throw"Your stream has no audio tracks.";t=t||{};var s,o=this,l=[],c=[],f=!1,u=0,_=2;t.leftChannel===!0&&(_=1),1===t.numberOfAudioChannels&&(_=1),t.disableLogs||console.debug("StereoAudioRecorder is set to record number of channels: ",_),this.record=function(){if(r()===!1)throw"Please make sure MediaStream is active.";l.length=c.length=0,u=0,d&&d.connect(s),g=b=!1,f=!0},this.stop=function(e){f=!1,n({sampleRate:v,numberOfAudioChannels:_,internalInterleavedLength:u,leftBuffers:l,rightBuffers:1===_?[]:c},function(t,r){o.blob=new Blob([r],{type:"audio/wav"}),o.buffer=new ArrayBuffer(r),o.view=r,o.sampleRate=v,o.bufferSize=m,o.length=u,e&&e(),g=!1})},T.AudioContextConstructor||(T.AudioContextConstructor=new T.AudioContext);var h=T.AudioContextConstructor,d=h.createMediaStreamSource(e),p=[0,256,512,1024,2048,4096,8192,16384],m="undefined"==typeof t.bufferSize?4096:t.bufferSize;if(-1===p.indexOf(m)&&(t.disableLogs||console.warn("Legal values for buffer-size are "+JSON.stringify(p,null,"	"))),h.createJavaScriptNode)s=h.createJavaScriptNode(m,_,_);else{if(!h.createScriptProcessor)throw"WebAudio API has no support on this browser.";s=h.createScriptProcessor(m,_,_)}d.connect(s),t.bufferSize||(m=s.bufferSize);var v="undefined"!=typeof t.sampleRate?t.sampleRate:h.sampleRate||44100;(22050>v||v>96e3)&&(t.disableLogs||console.warn("sample-rate must be under range 22050 and 96000.")),t.disableLogs||(console.log("sample-rate",v),console.log("buffer-size",m));var b=!1;this.pause=function(){b=!0},this.resume=function(){if(r()===!1)throw"Please make sure MediaStream is active.";return f?void(b=!1):(t.disableLogs||console.info("Seems recording has been restarted."),void this.record())},this.clearRecordedData=function(){this.pause(),l.length=c.length=0,u=0};var g=!1;s.onaudioprocess=i,s.connect(h.destination)}/**
	 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
	 * @summary HTML2Canvas recording into video WebM.
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @typedef CanvasRecorder
	 * @class
	 * @example
	 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true });
	 * recorder.record();
	 * recorder.stop(function(blob) {
	 *     video.src = URL.createObjectURL(blob);
	 * });
	 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
	 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
	 * @param {object} config - {disableLogs:true, initCallback: function}
	 */
function _(e,t){function r(){var t=document.createElement("canvas"),r=t.getContext("2d");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),t}function n(){if(c)return u=(new Date).getTime(),setTimeout(n,500);if("canvas"===e.nodeName.toLowerCase()){var a=(new Date).getTime()-u;return u=(new Date).getTime(),_.frames.push({image:r(),duration:a}),void(l&&setTimeout(n,t.frameInterval))}html2canvas(e,{grabMouse:"undefined"==typeof t.showMousePointer||t.showMousePointer,onrendered:function(e){var r=(new Date).getTime()-u;return r?(u=(new Date).getTime(),_.frames.push({image:e.toDataURL("image/webp",1),duration:r}),void(l&&setTimeout(n,t.frameInterval))):setTimeout(n,t.frameInterval)}})}if("undefined"==typeof html2canvas&&"canvas"!==e.nodeName.toLowerCase())throw"Please link: //cdn.webrtc-experiment.com/screenshot.js";t=t||{},t.frameInterval||(t.frameInterval=10);var a=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){e in document.createElement("canvas")&&(a=!0)}),(window.webkitRTCPeerConnection||window.webkitGetUserMedia)&&(a=!1);var i,s,o;a?(t.disableLogs||console.debug("Your browser supports both MediRecorder API and canvas.captureStream!"),i=document.createElement("canvas"),i.width=e.clientWidth||window.innerWidth,i.height=e.clientHeight||window.innerHeight,i.style="top: -9999999; left: -99999999; visibility:hidden; position:absoluted; display: none;",(document.body||document.documentElement).appendChild(i),s=i.getContext("2d")):navigator.mozGetUserMedia&&(t.disableLogs||alert("Canvas recording is NOT supported in Firefox."));var l;this.record=function(){if(l=!0,a){var e;"captureStream"in i?e=i.captureStream(25):"mozCaptureStream"in i?e=i.captureStream(25):"webkitCaptureStream"in i&&(e=i.captureStream(25));try{var r=new A;r.addTrack(e.getVideoTracks()[0]),e=r}catch(s){}if(!e)throw"captureStream API are NOT available.";o=new f(e,{mimeType:"video/webm"}),o.record()}else _.frames=[],u=(new Date).getTime(),n();t.initCallback&&t.initCallback()},this.getWebPImages=function(r){if("canvas"!==e.nodeName.toLowerCase())return void r();var n=_.frames.length;_.frames.forEach(function(e,r){var a=n-r;document.title=a+"/"+n+" frames remaining",t.onEncodingCallback&&t.onEncodingCallback(a,n);var i=e.image.toDataURL("image/webp",1);_.frames[r].image=i}),document.title="Generating WebM",r()},this.stop=function(e){l=!1;var t=this;if(a&&o){return void o.stop(function(){for(var r in o)self[r]=o[r];e&&e(t.blob)})}this.getWebPImages(function(){_.compile(function(r){document.title="Recording finished!",t.blob=r,t.blob.forEach&&(t.blob=new Blob([],{type:"video/webm"})),e&&e(t.blob),_.frames=[]})})};var c=!1;this.pause=function(){c=!0},this.resume=function(){c=!1},this.clearRecordedData=function(){this.pause(),_.frames=[]};var u=(new Date).getTime(),_=new E.Video(100)}/**
	 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
	 * @summary Video recording feature in Chrome.
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @typedef WhammyRecorder
	 * @class
	 * @example
	 * var recorder = new WhammyRecorder(mediaStream);
	 * recorder.record();
	 * recorder.stop(function(blob) {
	 *     video.src = URL.createObjectURL(blob);
	 * });
	 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
	 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
	 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
	 */
function h(e,t){function r(e){e="undefined"!=typeof e?e:10;var t=(new Date).getTime()-l;return t?s?(l=(new Date).getTime(),setTimeout(r,100)):(l=(new Date).getTime(),o.paused&&o.play(),u.drawImage(o,0,0,f.width,f.height),c.frames.push({duration:t,image:f.toDataURL("image/webp")}),void(i||setTimeout(r,e,e))):setTimeout(r,e,e)}function n(e){var t=-1,r=e.length,n=function(){return t++,t===r?void e.callback():void e.functionToLoop(n,t)};n()}function a(e,t,r,a,i){var s=document.createElement("canvas");s.width=f.width,s.height=f.height;var o=s.getContext("2d"),l=[],c=-1===t,u=t&&t>0&&t<=e.length?t:e.length,_={r:0,g:0,b:0},h=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),d=r&&r>=0&&1>=r?r:0,p=a&&a>=0&&1>=a?a:0,m=!1;n({length:u,functionToLoop:function(t,r){var n,a,i,s=function(){!m&&i*p>=i-n||(c&&(m=!0),l.push(e[r])),t()};if(m)s();else{var u=new Image;u.onload=function(){o.drawImage(u,0,0,f.width,f.height);var e=o.getImageData(0,0,f.width,f.height);n=0,a=e.data.length,i=e.data.length/4;for(var t=0;a>t;t+=4){var r={r:e.data[t],g:e.data[t+1],b:e.data[t+2]},l=Math.sqrt(Math.pow(r.r-_.r,2)+Math.pow(r.g-_.g,2)+Math.pow(r.b-_.b,2));h*d>=l&&n++}s()},u.src=e[r].image}},callback:function(){l=l.concat(e.slice(u)),l.length<=0&&l.push(e[e.length-1]),i(l)}})}t=t||{},t.frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),f.width=t.canvas.width,f.height=t.canvas.height,u=f.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(o=t.video.cloneNode(),t.initCallback&&t.initCallback()):(o=document.createElement("video"),"undefined"!=typeof o.srcObject?o.srcObject=e:o.src=w.createObjectURL(e),o.onloadedmetadata=function(){t.initCallback&&t.initCallback()},o.width=t.video.width,o.height=t.video.height),o.muted=!0,o.play(),l=(new Date).getTime(),c=new E.Video,t.disableLogs||(console.log("canvas resolutions",f.width,"*",f.height),console.log("video width/height",o.width||f.width,"*",o.height||f.height)),r(t.frameInterval)};var i=!1;this.stop=function(e){i=!0;var r=this;setTimeout(function(){a(c.frames,-1,null,null,function(n){c.frames=n,t.advertisement&&t.advertisement.length&&(c.frames=t.advertisement.concat(c.frames)),c.compile(function(t){r.blob=t,r.blob.forEach&&(r.blob=new Blob([],{type:"video/webm"})),e&&e(r.blob)})})},10)};var s=!1;this.pause=function(){s=!0},this.resume=function(){s=!1},this.clearRecordedData=function(){this.pause(),c.frames=[]};var o,l,c,f=document.createElement("canvas"),u=f.getContext("2d")}/**
	 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @typedef GifRecorder
	 * @class
	 * @example
	 * var recorder = new GifRecorder(mediaStream || canvas || context, { width: 1280, height: 720, frameRate: 200, quality: 10 });
	 * recorder.record();
	 * recorder.stop(function(blob) {
	 *     img.src = URL.createObjectURL(blob);
	 * });
	 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
	 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
	 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
	 */
function d(e,t){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";t=t||{};var r=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement;this.record=function(){function e(o){return n?setTimeout(function(){e(o)},100):(u=v(e),void 0===typeof c&&(c=o),void(90>o-c||(!r&&s.paused&&s.play(),i.drawImage(s,0,0,a.width,a.height),t.onGifPreview&&t.onGifPreview(a.toDataURL("image/png")),f.addFrame(i),c=o)))}r||(t.width||(t.width=s.offsetWidth||320),this.height||(t.height=s.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),a.width=t.canvas.width,a.height=t.canvas.height,s.width=t.video.width,s.height=t.video.height),f=new GIFEncoder,f.setRepeat(0),f.setDelay(t.frameRate||200),f.setQuality(t.quality||10),f.start(),o=Date.now();u=v(e),t.initCallback&&t.initCallback()},this.stop=function(){u&&b(u),l=Date.now(),this.blob=new Blob([new Uint8Array(f.stream().bin)],{type:"image/gif"}),f.stream().bin=[]};var n=!1;this.pause=function(){n=!0},this.resume=function(){n=!1},this.clearRecordedData=function(){f&&(this.pause(),f.stream().bin=[])};var a=document.createElement("canvas"),i=a.getContext("2d");if(r&&(e instanceof CanvasRenderingContext2D?i=e:e instanceof HTMLCanvasElement&&(i=e.getContext("2d"))),!r){var s=document.createElement("video");s.muted=!0,s.autoplay=!0,"undefined"!=typeof s.srcObject?s.srcObject=e:s.src=w.createObjectURL(e),s.play()}var o,l,c,f,u=null}var p,m;n.getFromDisk=function(e,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+("all"===e?"blobs":e+" blob ")+" from disk!"),M.Fetch(function(r,n){"all"!==e&&n===e+"Blob"&&t&&t(r),"all"===e&&t&&t(r,n.replace("Blob",""))})},n.writeToDisk=function(e){console.log("Writing recorded blob(s) to disk!"),e=e||{},e.audio&&e.video&&e.gif?e.audio.getDataURL(function(t){e.video.getDataURL(function(r){e.gif.getDataURL(function(e){M.Store({audioBlob:t,videoBlob:r,gifBlob:e})})})}):e.audio&&e.video?e.audio.getDataURL(function(t){e.video.getDataURL(function(e){M.Store({audioBlob:t,videoBlob:e})})}):e.audio&&e.gif?e.audio.getDataURL(function(t){e.gif.getDataURL(function(e){M.Store({audioBlob:t,gifBlob:e})})}):e.video&&e.gif?e.video.getDataURL(function(t){e.gif.getDataURL(function(e){M.Store({videoBlob:t,gifBlob:e})})}):e.audio?e.audio.getDataURL(function(e){M.Store({audioBlob:e})}):e.video?e.video.getDataURL(function(e){M.Store({videoBlob:e})}):e.gif&&e.gif.getDataURL(function(e){M.Store({gifBlob:e})})},e.exports=n,p=[],m=function(){return n}.apply(t,p),!(void 0!==m&&(e.exports=m)),s.getFromDisk=n.getFromDisk,s.writeToDisk=n.writeToDisk;var v=window.requestAnimationFrame;"undefined"==typeof v&&("undefined"!=typeof webkitRequestAnimationFrame&&(v=webkitRequestAnimationFrame),"undefined"!=typeof mozRequestAnimationFrame&&(v=mozRequestAnimationFrame));var b=window.cancelAnimationFrame;"undefined"==typeof b&&("undefined"!=typeof webkitCancelAnimationFrame&&(b=webkitCancelAnimationFrame),"undefined"!=typeof mozCancelAnimationFrame&&(b=mozCancelAnimationFrame));var g=window.AudioContext;"undefined"==typeof g&&("undefined"!=typeof webkitAudioContext&&(g=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(g=mozAudioContext));var w=window.URL;if("undefined"==typeof w&&"undefined"!=typeof webkitURL&&(w=webkitURL),"undefined"==typeof navigator)throw'Please make sure to define a global variable named as "navigator"';"undefined"!=typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!=typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia);var y=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),R=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),S=!R&&!y&&!!navigator.webkitGetUserMedia,A=window.MediaStream;"undefined"==typeof A&&"undefined"!=typeof webkitMediaStream&&(A=webkitMediaStream),"undefined"==typeof A||"stop"in A.prototype||(A.prototype.stop=function(){!this.getAudioTracks&&this.getTracks&&(this.getAudioTracks=function(){var e=[];return this.getTracks.forEach(function(t){-1!==t.kind.toString().indexOf("audio")&&e.push(t)}),e}),!this.getVideoTracks&&this.getTracks&&(this.getVideoTracks=function(){var e=[];return this.getTracks.forEach(function(t){-1!==t.kind.toString().indexOf("video")&&e.push(t)}),e}),this.getAudioTracks().forEach(function(e){e.stop()}),this.getVideoTracks().forEach(function(e){e.stop()})}),"undefined"!=typeof location&&0===location.href.indexOf("file:")&&console.error("Please load this HTML file on HTTP or HTTPS.");/**
	 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @example
	 * Storage.AudioContext === webkitAudioContext
	 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
	 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
	 */
var T={};"undefined"!=typeof g?T.AudioContext=g:"undefined"!=typeof webkitAudioContext&&(T.AudioContext=webkitAudioContext);/**
	 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
	 * @summary A real time javascript webm encoder based on a canvas hack.
	 * @license {@link https://github.com/muaz-khan/RecordRTC#license|MIT}
	 * @author {@link http://www.MuazKhan.com|Muaz Khan}
	 * @typedef Whammy
	 * @class
	 * @example
	 * var recorder = new Whammy().Video(15);
	 * recorder.add(context || canvas || dataURL);
	 * var output = recorder.compile();
	 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
	 */
var E=function(){function e(e){this.frames=[],this.duration=e||1,this.quality=.8}function t(e){var t=w.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"})),r=new Worker(t);return w.revokeObjectURL(t),r}function r(e){function t(e){var t=n(e);if(!t)return[];for(var a=3e4,i=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:_(t.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:t.width,id:176},{data:t.height,id:186}]}]}]}]}],s=0,l=0;s<e.length;){var c=[],f=0;do c.push(e[s]),f+=e[s].duration,s++;while(s<e.length&&a>f);var u=0,h={id:524531317,data:r(l,u,c)};i[1].data.push(h),l+=f}return o(i)}function r(e,t,r){return[{data:e,id:231}].concat(r.map(function(e){var r=l({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:r,id:163}}))}function n(e){if(!e[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var t=e[0].width,r=e[0].height,n=e[0].duration,a=1;a<e.length;a++)n+=e[a].duration;return{duration:n,width:t,height:r}}function a(e){for(var t=[];e>0;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function i(e){return new Uint8Array(e.split("").map(function(e){return e.charCodeAt(0)}))}function s(e){var t=[],r=e.length%8?new Array(9-e.length%8).join("0"):"";e=r+e;for(var n=0;n<e.length;n+=8)t.push(parseInt(e.substr(n,8),2));return new Uint8Array(t)}function o(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].data;"object"==typeof n&&(n=o(n)),"number"==typeof n&&(n=s(n.toString(2))),"string"==typeof n&&(n=i(n));var l=n.size||n.byteLength||n.length,c=Math.ceil(Math.ceil(Math.log(l)/Math.log(2))/8),f=l.toString(2),u=new Array(7*c+7+1-f.length).join("0")+f,_=new Array(c).join("0")+"1"+u;t.push(a(e[r].id)),t.push(s(_)),t.push(n)}return new Blob(t,{type:"video/webm"})}function l(e){var t=0;if(e.keyframe&&(t|=128),e.invisible&&(t|=8),e.lacing&&(t|=e.lacing<<1),e.discardable&&(t|=1),e.trackNum>127)throw"TrackNumber > 127 not supported";var r=[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map(function(e){return String.fromCharCode(e)}).join("")+e.frame;return r}function c(e){for(var t=e.RIFF[0].WEBP[0],r=t.indexOf("*"),n=0,a=[];4>n;n++)a[n]=t.charCodeAt(r+3+n);var i,s,o;return o=a[1]<<8|a[0],i=16383&o,o=a[3]<<8|a[2],s=16383&o,{width:i,height:s,data:t,riff:e}}function f(e,t){return parseInt(e.substr(t+4,4).split("").map(function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t}).join(""),2)}function u(e){for(var t=0,r={};t<e.length;){var n=e.substr(t,4),a=f(e,t),i=e.substr(t+4+4,a);t+=8+a,r[n]=r[n]||[],"RIFF"===n||"LIST"===n?r[n].push(u(i)):r[n].push(i)}return r}function _(e){return[].slice.call(new Uint8Array(new Float64Array([e]).buffer),0).map(function(e){return String.fromCharCode(e)}).reverse().join("")}var h=new t(e.map(function(e){var t=c(u(atob(e.image.slice(23))));return t.duration=e.duration,t}));postMessage(h)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var n=t(r);n.onmessage=function(t){return t.data.error?void console.error(t.data.error):void e(t.data)},n.postMessage(this.frames)},{Video:e}}(),M={init:function(){function e(e){e.createObjectStore(r.dataStoreName)}function t(){function e(e){t.objectStore(r.dataStoreName).get(e).onsuccess=function(t){r.callback&&r.callback(t.target.result,e)}}var t=n.transaction([r.dataStoreName],"readwrite");r.videoBlob&&t.objectStore(r.dataStoreName).put(r.videoBlob,"videoBlob"),r.gifBlob&&t.objectStore(r.dataStoreName).put(r.gifBlob,"gifBlob"),r.audioBlob&&t.objectStore(r.dataStoreName).put(r.audioBlob,"audioBlob"),e("audioBlob"),e("videoBlob"),e("gifBlob")}var r=this;if("undefined"==typeof indexedDB||"undefined"==typeof indexedDB.open)return void console.error("IndexedDB API are not available in this browser.");"undefined"!=typeof webkitIndexedDB&&(indexedDB=webkitIndexedDB),"undefined"!=typeof mozIndexedDB&&(indexedDB=mozIndexedDB),"undefined"!=typeof OIndexedDB&&(indexedDB=OIndexedDB),"undefined"!=typeof msIndexedDB&&(indexedDB=msIndexedDB);var n,a=1,i=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),s=indexedDB.open(i,a);s.onerror=r.onError,s.onsuccess=function(){if(n=s.result,n.onerror=r.onError,n.setVersion)if(n.version!==a){var i=n.setVersion(a);i.onsuccess=function(){e(n),t()}}else t();else t()},s.onupgradeneeded=function(t){e(t.target.result)}},Fetch:function(e){return this.callback=e,this.init(),this},Store:function(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function(e){console.error(JSON.stringify(e,null,"	"))},dataStoreName:"recordRTC",dbName:null}},function(e,t,r){"use strict";function n(e){return new Promise(function(t,r){a(e,t,r)})}var a=null,i=null,s=null,o=null,l=null,c=null,f={log:function(){},extractVersion:function(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}};if("object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return"mozSrcObject"in this?this.mozSrcObject:this._srcObject},set:function(e){"mozSrcObject"in this?this.mozSrcObject=e:(this._srcObject=e,this.src=URL.createObjectURL(e))}}),a=window.navigator&&window.navigator.getUserMedia),i=function(e,t){e.srcObject=t},s=function(e,t){e.srcObject=t.srcObject},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia){if(f.log("This appears to be Firefox"),o="firefox",l=f.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),c=31,window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(38>l&&e&&e.iceServers){for(var r=[],n=0;n<e.iceServers.length;n++){var a=e.iceServers[n];if(a.hasOwnProperty("urls"))for(var i=0;i<a.urls.length;i++){var s={url:a.urls[i]};0===a.urls[i].indexOf("turn")&&(s.username=a.username,s.credential=a.credential),r.push(s)}else r.push(e.iceServers[n])}e.iceServers=r}return new mozRTCPeerConnection(e,t)},mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return arguments.length?mozRTCPeerConnection.generateCertificate.apply(null,arguments):mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),a=function(e,t,r){var n=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n=e[r]="object"==typeof e[r]?e[r]:{ideal:e[r]};if((void 0!==n.min||void 0!==n.max||void 0!==n.exact)&&t.push(r),void 0!==n.exact&&("number"==typeof n.exact?n.min=n.max=n.exact:e[r]=n.exact,delete n.exact),void 0!==n.ideal){e.advanced=e.advanced||[];var a={};"number"==typeof n.ideal?a[r]={min:n.ideal,max:n.ideal}:a[r]=n.ideal,e.advanced.push(a),delete n.ideal,Object.keys(n).length||delete e[r]}}}),t.length&&(e.require=t),e};return 38>l&&(f.log("spec: "+JSON.stringify(e)),e.audio&&(e.audio=n(e.audio)),e.video&&(e.video=n(e.video)),f.log("ff37: "+JSON.stringify(e))),navigator.mozGetUserMedia(e,t,r)},navigator.getUserMedia=a,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:n,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})},41>l){var u=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return u().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){f.log("This appears to be Chrome"),o="chrome",l=f.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),c=38,window.RTCPeerConnection=function(e,t){e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var r=new webkitRTCPeerConnection(e,t),n=r.getStats.bind(r);return r.getStats=function(e,t,r){var a=this,i=arguments;if(arguments.length>0&&"function"==typeof e)return n(e,t);var s=function(e){var t={},r=e.result();return r.forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){r[t]=e.stat(t)}),t[r.id]=r}),t};if(arguments.length>=2){var o=function(e){i[1](s(e))};return n.apply(this,[o,arguments[0]])}return new Promise(function(t,r){1===i.length&&null===e?n.apply(a,[function(e){t.apply(null,[s(e)])},r]):n.apply(a,[t,r])})},r},webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return arguments.length?webkitRTCPeerConnection.generateCertificate.apply(null,arguments):webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var r=1===arguments.length?arguments[0]:void 0;return new Promise(function(n,a){t.apply(e,[n,a,r])})}return t.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,r=this;return new Promise(function(n,a){t.apply(r,[e[0],function(){n(),e.length>=2&&e[1].apply(null,[])},function(t){a(t),e.length>=3&&e[2].apply(null,[t])}])})}});var _=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"==typeof e[r]?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var a=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var i={};"number"==typeof n.ideal?(i[a("min",r)]=n.ideal,t.optional.push(i),i={},i[a("max",r)]=n.ideal,t.optional.push(i)):(i[a("",r)]=n.ideal,t.optional.push(i))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[a("",r)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[a(e,r)]=n[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t};if(a=function(e,t,r){return e.audio&&(e.audio=_(e.audio)),e.video&&(e.video=_(e.video)),f.log("chrome: "+JSON.stringify(e)),navigator.webkitGetUserMedia(e,t,r)},navigator.getUserMedia=a,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:n,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(r){e(r.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var h=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return f.log("spec:   "+JSON.stringify(e)),e.audio=_(e.audio),e.video=_(e.video),f.log("chrome: "+JSON.stringify(e)),h(e)}}else navigator.mediaDevices.getUserMedia=function(e){return n(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){f.log("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){f.log("Dummy mediaDevices.removeEventListener called.")}),i=function(e,t){l>=43?e.srcObject=t:"undefined"!=typeof e.src?e.src=URL.createObjectURL(t):f.log("Error attaching stream to element.")},s=function(e,t){l>=43?e.srcObject=t.srcObject:e.src=t.src}}else if(navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)){if(f.log("This appears to be Edge"),o="edge",l=f.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),c=10547,window.RTCIceGatherer){var d=function(){return Math.random().toString(36).substr(2,10)},p=d(),m={};m.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},m.splitSections=function(e){var t=e.split("\r\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},m.matchPrefix=function(e,t){return m.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},m.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var r={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1]}return r},m.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},m.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.numChannels=3===t.length?parseInt(t[2],10):1,r},m.writeRtpMap=function(e){var t=e.payloadType;return void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==e.numChannels?"/"+e.numChannels:"")+"\r\n"},m.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),a=0;a<n.length;a++)t=n[a].trim().split("="),r[t[0].trim()]=t[1];return r},m.writeFtmp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&e.parameters.length){var n=[];Object.keys(e.parameters).forEach(function(t){n.push(t+"="+e.parameters[t])}),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},m.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},m.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+" "+e.parameter+"\r\n"}),t},m.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:e.substr(7,t-7)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},m.getDtlsParameters=function(e,t){var r=m.splitLines(e);r=r.concat(m.splitLines(t));var n=r.filter(function(e){return 0===e.indexOf("a=fingerprint:")})[0].substr(14),a={role:"auto",fingerprints:[{algorithm:n.split(" ")[0],value:n.split(" ")[1]}]};return a},m.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),r},m.getIceParameters=function(e,t){var r=m.splitLines(e);r=r.concat(m.splitLines(t));var n={usernameFragment:r.filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:r.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)};return n},m.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},m.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=m.splitLines(e),n=r[0].split(" "),a=3;a<n.length;a++){var i=n[a],s=m.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(s){var o=m.parseRtpMap(s),l=m.matchPrefix(e,"a=fmtp:"+i+" ");o.parameters=l.length?m.parseFmtp(l[0]):{},o.rtcpFeedback=m.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(m.parseRtcpFb),t.codecs.push(o)}}return t},m.writeRtpDescription=function(e,t){var r="";return r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){r+=m.writeRtpMap(e),r+=m.writeFtmp(e),r+=m.writeRtcpFb(e)}),r+="a=rtcp-mux\r\n"},m.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},m.writeMediaSection=function(e,t,r,n){var a=m.writeRtpDescription(e.kind,t);if(a+=m.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=m.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),a+="a=mid:"+e.mid+"\r\n",a+=e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var i="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";a+="a="+i,a+="a=ssrc:"+e.sendSsrc+" "+i}return a+="a=ssrc:"+e.sendSsrc+" cname:"+p+"\r\n"},m.getDirection=function(e,t){for(var r=m.splitLines(e),n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2)}return t?m.getDirection(t):"sendrecv"},window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e}),window.RTCPeerConnection=function(e){var t=this;if(this.onicecandidate=null,this.onaddstream=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return t.localStreams},this.getRemoteStreams=function(){return t.remoteStreams},this.localDescription=new y({type:"",sdp:""}),this.remoteDescription=new y({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},e&&e.iceTransportPolicy)switch(e.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=e.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}e&&e.iceServers&&e.iceServers.forEach(function(e){if(e.urls){var r;r="string"==typeof e.urls?e.urls:e.urls[0],-1!==r.indexOf("transport=udp")&&t.iceServers.push({username:e.username,credential:e.credential,urls:r})}}),this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var e=this;this._localIceCandidatesBuffer.forEach(function(t){null!==e.onicecandidate&&e.onicecandidate(t)}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.addStream=function(e){this.localStreams.push(e.clone()),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);t>-1&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype._getCommonCapabilities=function(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]};return e.codecs.forEach(function(e){for(var n=0;n<t.codecs.length;n++){var a=t.codecs[n];if(e.name.toLowerCase()===a.name.toLowerCase()&&e.clockRate===a.clockRate&&e.numChannels===a.numChannels){r.codecs.push(a);break}}}),e.headerExtensions.forEach(function(e){for(var n=0;n<t.headerExtensions.length;n++){var a=t.headerExtensions[n];if(e.uri===a.uri){r.headerExtensions.push(a);break}}}),r},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(e,t){var r=this,n=new RTCIceGatherer(r.iceOptions),a=new RTCIceTransport(n);n.onlocalcandidate=function(i){var s={};s.candidate={sdpMid:e,sdpMLineIndex:t};var o=i.candidate;o&&0!==Object.keys(o).length?(o.component="RTCP"===a.component?2:1,s.candidate.candidate=m.writeCandidate(o)):(void 0===n.state&&(n.state="completed"),s.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates");var l=r.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});null!==r.onicecandidate&&(r.localDescription&&""===r.localDescription.type?(r._localIceCandidatesBuffer.push(s),l&&r._localIceCandidatesBuffer.push({})):(r.onicecandidate(s),l&&r.onicecandidate({})))},a.onicestatechange=function(){r._updateConnectionState()};var i=new RTCDtlsTransport(a);return i.ondtlsstatechange=function(){r._updateConnectionState()},i.onerror=function(){i.state="failed",r._updateConnectionState()},{iceGatherer:n,iceTransport:a,dtlsTransport:i}},window.RTCPeerConnection.prototype._transceive=function(e,t,r){var n=this._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(n.encodings=[{ssrc:e.sendSsrc}],n.rtcp={cname:p,ssrc:e.recvSsrc},e.rtpSender.send(n)),r&&e.rtpReceiver&&(n.encodings=[{ssrc:e.recvSsrc}],n.rtcp={cname:e.cname,ssrc:e.sendSsrc},e.rtpReceiver.receive(n))},window.RTCPeerConnection.prototype.setLocalDescription=function(e){var t=this;if("offer"===e.type)this._pendingOffer&&(this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===e.type){var r=m.splitSections(t.remoteDescription.sdp),n=r.shift();r.forEach(function(e,r){var a=t.transceivers[r],i=a.iceGatherer,s=a.iceTransport,o=a.dtlsTransport,l=a.localCapabilities,c=a.remoteCapabilities,f="0"===e.split("\n",1)[0].split(" ",2)[1];if(!f){var u=m.getIceParameters(e,n);s.start(i,u,"controlled");var _=m.getDtlsParameters(e,n);o.start(_);var h=t._getCommonCapabilities(l,c);t._transceive(a,h.codecs.length>0,!1)}})}switch(this.localDescription=e,e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var a=arguments.length>1&&"function"==typeof arguments[1];if(a){var i=arguments[1];window.setTimeout(function(){i(),t._emitBufferedCandidates()},0)}var s=Promise.resolve();return s.then(function(){a||window.setTimeout(t._emitBufferedCandidates.bind(t),0)}),s},window.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t=this,r=new MediaStream,n=m.splitSections(e.sdp),a=n.shift();switch(n.forEach(function(n,i){var s,o,l,c,f,u,_,h,d,p,v,b=m.splitLines(n),g=b[0].substr(2).split(" "),w=g[0],y="0"===g[1],R=m.getDirection(n,a),S=m.parseRtpParameters(n);y||(p=m.getIceParameters(n,a),v=m.getDtlsParameters(n,a));var A,T=m.matchPrefix(n,"a=mid:")[0].substr(6),E=m.matchPrefix(n,"a=ssrc:").map(function(e){return m.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];if(E&&(h=parseInt(E.ssrc,10),A=E.value),"offer"===e.type){var M=t._createIceAndDtlsTransports(T,i);if(d=RTCRtpReceiver.getCapabilities(w),_=1001*(2*i+2),u=new RTCRtpReceiver(M.dtlsTransport,w),r.addTrack(u.track),t.localStreams.length>0&&t.localStreams[0].getTracks().length>=i){var B=t.localStreams[0].getTracks()[i];f=new RTCRtpSender(B,M.dtlsTransport)}t.transceivers[i]={iceGatherer:M.iceGatherer,iceTransport:M.iceTransport,dtlsTransport:M.dtlsTransport,localCapabilities:d,remoteCapabilities:S,rtpSender:f,rtpReceiver:u,kind:w,mid:T,cname:A,sendSsrc:_,recvSsrc:h},t._transceive(t.transceivers[i],!1,"sendrecv"===R||"sendonly"===R)}else"answer"!==e.type||y||(s=t.transceivers[i],o=s.iceGatherer,l=s.iceTransport,c=s.dtlsTransport,f=s.rtpSender,u=s.rtpReceiver,_=s.sendSsrc,d=s.localCapabilities,t.transceivers[i].recvSsrc=h,t.transceivers[i].remoteCapabilities=S,t.transceivers[i].cname=A,l.start(o,p,"controlling"),c.start(v),t._transceive(s,"sendrecv"===R||"recvonly"===R,"sendrecv"===R||"sendonly"===R),!u||"sendrecv"!==R&&"sendonly"!==R?delete s.rtpReceiver:r.addTrack(u.track))}),this.remoteDescription=e,e.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}return window.setTimeout(function(){null!==t.onaddstream&&r.getTracks().length&&(t.remoteStreams.push(r),window.setTimeout(function(){t.onaddstream({stream:r})},0))},0),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e,null!==this.onsignalingstatechange&&this.onsignalingstatechange()},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){null!==this.onnegotiationneeded&&this.onnegotiationneeded()},window.RTCPeerConnection.prototype._updateConnectionState=function(){var e,t=this,r={"new":0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};this.transceivers.forEach(function(e){r[e.iceTransport.state]++,r[e.dtlsTransport.state]++}),r.connected+=r.completed,e="new",r.failed>0?e="failed":r.connecting>0||r.checking>0?e="connecting":r.disconnected>0?e="disconnected":r["new"]>0?e="new":(r.connecting>0||r.completed>0)&&(e="connected"),e!==t.iceConnectionState&&(t.iceConnectionState=e,null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange())},window.RTCPeerConnection.prototype.createOffer=function(){var e=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");var t;1===arguments.length&&"function"!=typeof arguments[0]?t=arguments[0]:3===arguments.length&&(t=arguments[2]);var r=[],n=0,a=0;if(this.localStreams.length&&(n=this.localStreams[0].getAudioTracks().length,a=this.localStreams[0].getVideoTracks().length),t){if(t.mandatory||t.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==t.offerToReceiveAudio&&(n=t.offerToReceiveAudio),void 0!==t.offerToReceiveVideo&&(a=t.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(e){r.push({kind:e.kind,track:e,wantReceive:"audio"===e.kind?n>0:a>0}),"audio"===e.kind?n--:"video"===e.kind&&a--});n>0||a>0;)n>0&&(r.push({kind:"audio",wantReceive:!0}),n--),a>0&&(r.push({kind:"video",wantReceive:!0}),a--);var i=m.writeSessionBoilerplate(),s=[];r.forEach(function(t,r){var n,a,o=t.track,l=t.kind,c=d(),f=e._createIceAndDtlsTransports(c,r),u=RTCRtpSender.getCapabilities(l),_=1001*(2*r+1);o&&(n=new RTCRtpSender(o,f.dtlsTransport)),t.wantReceive&&(a=new RTCRtpReceiver(f.dtlsTransport,l)),s[r]={iceGatherer:f.iceGatherer,iceTransport:f.iceTransport,dtlsTransport:f.dtlsTransport,localCapabilities:u,remoteCapabilities:null,rtpSender:n,rtpReceiver:a,kind:l,mid:c,sendSsrc:_,recvSsrc:null};var h=s[r];i+=m.writeMediaSection(h,h.localCapabilities,"offer",e.localStreams[0])}),this._pendingOffer=s;var o=new y({type:"offer",sdp:i});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,o),Promise.resolve(o)},window.RTCPeerConnection.prototype.createAnswer=function(){var e,t=this;1===arguments.length&&"function"!=typeof arguments[0]?e=arguments[0]:3===arguments.length&&(e=arguments[2]);var r=m.writeSessionBoilerplate();this.transceivers.forEach(function(e){var n=t._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);r+=m.writeMediaSection(e,n,"answer",t.localStreams[0])});var n=new y({type:"answer",sdp:r});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,n),Promise.resolve(n)},window.RTCPeerConnection.prototype.addIceCandidate=function(e){var t=e.sdpMLineIndex;if(e.sdpMid)for(var r=0;r<this.transceivers.length;r++)if(this.transceivers[r].mid===e.sdpMid){t=r;break}var n=this.transceivers[t];if(n){var a=Object.keys(e.candidate).length>0?m.parseCandidate(e.candidate):{};if("tcp"===a.protocol&&0===a.port)return;if("1"!==a.component)return;"endOfCandidates"===a.type&&(a={}),n.iceTransport.addRemoteCandidate(a)}return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(r){t[r]&&e.push(t[r].getStats())})});var t=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(r){var n={};Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){n[t]=e[t]})}),t&&window.setTimeout(t,0,n),r(n)})})}}}else f.log("Browser does not appear to be WebRTC-capable");else f.log("This does not appear to be a browser"),o="not a browser";var v={};try{Object.defineProperty(v,"version",{set:function(e){l=e}})}catch(b){}var g,w,y;"undefined"!=typeof window&&(g=window.RTCPeerConnection,w=window.RTCIceCandidate,y=window.RTCSessionDescription),e.exports={RTCPeerConnection:g,RTCIceCandidate:w,RTCSessionDescription:y,getUserMedia:a,attachMediaStream:i,reattachMediaStream:s,webrtcDetectedBrowser:o,webrtcDetectedVersion:l,webrtcMinimumVersion:c,webrtcTesting:v,webrtcUtils:f}},function(e,t,r){"use strict";var n=r(1);e.exports=function(){function e(){n.on("error",function(e){console.assert(!1,e)})}return{setup:e}}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(3),s=r(1).Promise,o=r(12),l={channels:1,sampleRate:44100,kbps:128,maxSamples:1152},c={mono:1,stereo:2},f=function(){function e(){n(this,e),this.lame=new i}return a(e,[{key:"toBase64",value:function(e){var t=new FileReader;return t.readAsDataURL(e),new s(function(e,r){t.onload=function(){e(t.result)}})}},{key:"toMp3",value:function(e){var t=this,r=new FileReader;return r.readAsArrayBuffer(e),new s(function(e,n){t.mp3Resolver=e,r.onload=t.onBlobReady.bind(r,t)})}},{key:"onBlobReady",value:function(e){var t=this.result,r=new Int16Array(t),n=e.lame.WavHeader.readHeader(new DataView(t));if(n.channels===c.stereo){for(var a=[],i=[],s=0;s<r.length;)a.push(r[s]),i.push(r[s+1]),s+=c.stereo;r=[a,i]}else r=[r];e.encodeSamplesToMp3(r,{channels:n.channels,sampleRate:n.sampleRate})}},{key:"encodeSamplesToMp3",value:function(e,t){t=o(l,t);for(var r,n,a,i,s,c,f=e[0],u=e[1],_=t.maxSamples,h=f.length,d=new this.lame.Mp3Encoder(t.channels,t.sampleRate,t.kbps),p=[],m=0;h>=_;)m+=_,n=f.slice(m,m+_),a=u?u.slice(m,m+_):null,r=d.encodeBuffer(n,a),r.length>0&&p.push(new Int8Array(r)),h-=_;i=d.flush(),i.length>0&&p.push(new Int8Array(i)),s=new Blob(p,{type:"audio/mp3"}),c=URL.createObjectURL(s),this.mp3Resolver({buffer:p,blob:s,url:c})}}]),e}();e.exports=f},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(9),s=["loadedmetadata","timeupdate","play","pause","ended"],o=function(){
function e(t,r){n(this,e);var a=document.createElement("audio");a.src=t,this.microm=r,this.isLoaded=!1,this.isPlaying=!1,this.isStoped=!0,this.duration=0,this.currentTime=0,this.audio=a,this.addEvents()}return a(e,[{key:"play",value:function(){this.audio.play()}},{key:"pause",value:function(){this.pauseAudio()}},{key:"stop",value:function(){this.pauseAudio(0)}},{key:"pauseAudio",value:function(e){this.audio.pause(),"undefined"!=typeof e&&(this.audio.currentTime=e,this.currentTime=e)}},{key:"addEvents",value:function(){var e=this,t=this.audio;this.pauseAudio(0),s.forEach(function(r){var n="on"+i.capitalize(r);t.addEventListener(r,e[n].bind(e))})}},{key:"fireEvent",value:function(e,t){var r=this.microm.eventListeners[e];r&&r(t)}},{key:"onLoadedmetadata",value:function(){this.isLoaded=!0,this.duration=this.audio.duration,this.fireEvent("loadedmetadata",this.duration)}},{key:"onTimeupdate",value:function(){this.currentTime=this.audio.currentTime,this.fireEvent("timeupdate",this.currentTime)}},{key:"onPlay",value:function(){this.isPlaying=!0,this.isStoped=!1,this.fireEvent("play")}},{key:"onPause",value:function(){this.isPlaying=!1,this.fireEvent("pause",this.currentTime)}},{key:"onEnded",value:function(){this.isPlaying=!1,this.isStoped=!0,this.fireEvent("ended")}}]),e}();e.exports=o},function(e,t,r){"use strict";function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}e.exports={capitalize:n}},function(e,t,r){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===s||t===u?62:t===o||t===_?63:l>t?-1:l+10>t?t-l+26+26:f+26>t?t-f:c+26>t?t-c+26:void 0}function r(e){function r(e){c[u++]=e}var n,a,s,o,l,c;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var f=e.length;l="="===e.charAt(f-2)?2:"="===e.charAt(f-1)?1:0,c=new i(3*e.length/4-l),s=l>0?e.length-4:e.length;var u=0;for(n=0,a=0;s>n;n+=4,a+=3)o=t(e.charAt(n))<<18|t(e.charAt(n+1))<<12|t(e.charAt(n+2))<<6|t(e.charAt(n+3)),r((16711680&o)>>16),r((65280&o)>>8),r(255&o);return 2===l?(o=t(e.charAt(n))<<2|t(e.charAt(n+1))>>4,r(255&o)):1===l&&(o=t(e.charAt(n))<<10|t(e.charAt(n+1))<<4|t(e.charAt(n+2))>>2,r(o>>8&255),r(255&o)),c}function a(e){function t(e){return n.charAt(e)}function r(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var a,i,s,o=e.length%3,l="";for(a=0,s=e.length-o;s>a;a+=3)i=(e[a]<<16)+(e[a+1]<<8)+e[a+2],l+=r(i);switch(o){case 1:i=e[e.length-1],l+=t(i>>2),l+=t(i<<4&63),l+="==";break;case 2:i=(e[e.length-2]<<8)+e[e.length-1],l+=t(i>>10),l+=t(i>>4&63),l+=t(i<<2&63),l+="="}return l}var i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),o="/".charCodeAt(0),l="0".charCodeAt(0),c="a".charCodeAt(0),f="A".charCodeAt(0),u="-".charCodeAt(0),_="_".charCodeAt(0);e.toByteArray=r,e.fromByteArray=a}(t)},function(e,t,r){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,a=Object.prototype.toString,i=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===a.call(e)},s=function(e){if(!e||"[object Object]"!==a.call(e))return!1;var t=n.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&n.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!r)return!1;var i;for(i in e);return"undefined"==typeof i||n.call(e,i)};e.exports=function o(){var e,t,r,n,a,l,c=arguments[0],f=1,u=arguments.length,_=!1;for("boolean"==typeof c?(_=c,c=arguments[1]||{},f=2):("object"!=typeof c&&"function"!=typeof c||null==c)&&(c={});u>f;++f)if(e=arguments[f],null!=e)for(t in e)r=c[t],n=e[t],c!==n&&(_&&n&&(s(n)||(a=i(n)))?(a?(a=!1,l=r&&i(r)?r:[]):l=r&&s(r)?r:{},c[t]=o(_,l,n)):"undefined"!=typeof n&&(c[t]=n));return c}},function(e,t,r){t.read=function(e,t,r,n,a){var i,s,o=8*a-n-1,l=(1<<o)-1,c=l>>1,f=-7,u=r?a-1:0,_=r?-1:1,h=e[t+u];for(u+=_,i=h&(1<<-f)-1,h>>=-f,f+=o;f>0;i=256*i+e[t+u],u+=_,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=n;f>0;s=256*s+e[t+u],u+=_,f-=8);if(0===i)i=1-c;else{if(i===l)return s?NaN:(h?-1:1)*(1/0);s+=Math.pow(2,n),i-=c}return(h?-1:1)*s*Math.pow(2,i-n)},t.write=function(e,t,r,n,a,i){var s,o,l,c=8*i-a-1,f=(1<<c)-1,u=f>>1,_=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,d=n?1:-1,p=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),t+=s+u>=1?_/l:_*Math.pow(2,1-u),t*l>=2&&(s++,l/=2),s+u>=f?(o=0,s=f):s+u>=1?(o=(t*l-1)*Math.pow(2,a),s+=u):(o=t*Math.pow(2,u-1)*Math.pow(2,a),s=0));a>=8;e[r+h]=255&o,h+=d,o/=256,a-=8);for(s=s<<a|o,c+=a;c>0;e[r+h]=255&s,h+=d,s/=256,c-=8);e[r+h-d]|=128*p}},function(e,t,r){function n(){if(!o){o=!0;for(var e,t=s.length;t;){e=s,s=[];for(var r=-1;++r<t;)e[r]();t=s.length}o=!1}}function a(){}var i=e.exports={},s=[],o=!1;i.nextTick=function(e){s.push(e),o||setTimeout(n,0)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=a,i.addListener=a,i.once=a,i.off=a,i.removeListener=a,i.removeAllListeners=a,i.emit=a,i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){}])});